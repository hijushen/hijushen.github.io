<meta http-equiv="Content-Type" content="text/html; charset=utf-8"><title>32位和64位dll在windows64位系统中存放的位置</title><?xml version="1.0" encoding="UTF-8"?>


<div style="word-wrap: break-word; -webkit-nbsp-mode: space; -webkit-line-break: after-white-space;"><div style="text-align: left;"><font color="#464646" face="simsun"><span style="font-size: 14px; line-height: 21px;">复制到&nbsp;</span></font><span style="background-color: rgb(255, 255, 255); color: rgb(255, 0, 0); font-family: simsun; font-size: 14px; line-height: 21px;">\Windows\SysWOW64 目录已解决复制dll 到sysdate32后仍然提示找不到dll问题（32位系统兼容性）</span></div><span style="color: rgb(70, 70, 70); font-family: simsun; font-size: 14px; line-height: 21px; text-align: left; background-color: rgb(255, 255, 255);">前两天社内考试，有一道题问的是32位和64位dll在windows64位系统中存放的位置。今天看了些资料，抽取了一部分贴在这里。</span><div style="color: rgb(70, 70, 70); font-family: simsun; font-size: 14px; line-height: 21px; text-align: left; background-color: rgb(255, 255, 255);"><br/></div><div style="color: rgb(70, 70, 70); font-family: simsun; font-size: 14px; line-height: 21px; text-align: left; background-color: rgb(255, 255, 255);"><div>DLL 存放到何处?&nbsp;</div><div>如果你查看一下在32位操作系统内的\Windows文件夹，你会发现两个子目录:一个名为SYSTEM，还有一个名为SYSTEM32。SYSTEM目录是Windows 3.x遗留下来的，用来保持Windows的对一些旧的应用程序的向下兼容性。一般说来，<font color="#FF0000" style="word-wrap: normal; word-break: normal;">16位的DLL文件(以及其它的支持文件)被存放在\Windows\System文件夹里，32位DLL文件和不同支持文件被存放在\Windows\System32文件夹里。</font>&nbsp;</div><div>32位版本的Windows保持16位和32位DLL文件的方式是非常简单的，但是64位版本的Windows保持64位和32位DLL文件的方式就不这么简单了。&nbsp;</div><div><font color="#FF0000" style="word-wrap: normal; word-break: normal;">对于一个64位系统，微软创建了一个新的名为SysWOW64的文件夹来存放32位的DLL文件。在64位版本的Windows内，微软使用\Windows\System32文件夹做为64位DLL的仓库，而不是32位DLL文件的。</font></div><div>32位代码不能默认在64位版本的Windows内运行。为了运行32位的应用程序，Windows使用WOW64 emulator，来让这些应用程序还认为它们在32位版本的Windows内运行。&nbsp;<font color="#FF0000" style="word-wrap: normal; word-break: normal;">当你安装一个32位的应用程序，安装向导通过WOW64 emulato运行。</font>这意味着当你安装一个应用程序，<font color="#FF0000" style="word-wrap: normal; word-break: normal;">安装向导并不知道这个程序被安装到64位版本的Windows内，并且和它运行在32位操作系统一样把DLL文件写到\Windows\System32文件夹里面。</font>当然，WOW64知道安装向导通过emulator来运行的32位应用程序。同时也知道64和32位代码不能混合在一起。所以，WOW64 emulator 给\Windows\SysWOW64创建一个别名。这意味着32位应用程序要写入到\Windows\System32文件夹或者从\Windows\System32文件夹读取，<font color="#FF0000" style="word-wrap: normal; word-break: normal;">WOW64 emulator都能使其改道到\Windows\SysWOW64文件夹。</font></div><div><font color="#FF0000" style="word-wrap: normal; word-break: normal;">当然，可以使用函数禁止重定向：Wow64DisableWow64FsRedirection&nbsp;</font></div><div><span style="word-wrap: normal; word-break: normal; color: rgb(255, 0, 0);">或恢复重定向:Wow64RevertWow64FsRedirection</span>前两天社内考试，有一道题问的是32位和64位dll在windows64位系统中存放的位置。今天看了些资料，抽取了一部分贴在这里。</div><div><br/></div><div>DLL 存放到何处?&nbsp;</div><div>如果你查看一下在32位操作系统内的\Windows文件夹，你会发现两个子目录:一个名为SYSTEM，还有一个名为SYSTEM32。SYSTEM目录是Windows 3.x遗留下来的，用来保持Windows的对一些旧的应用程序的向下兼容性。一般说来，<font color="#FF0000" style="word-wrap: normal; word-break: normal;">16位的DLL文件(以及其它的支持文件)被存放在\Windows\System文件夹里，32位DLL文件和不同支持文件被存放在\Windows\System32文件夹里。</font>&nbsp;</div><div>32位版本的Windows保持16位和32位DLL文件的方式是非常简单的，但是64位版本的Windows保持64位和32位DLL文件的方式就不这么简单了。&nbsp;</div><div><font color="#FF0000" style="word-wrap: normal; word-break: normal;">对于一个64位系统，微软创建了一个新的名为SysWOW64的文件夹来存放32位的DLL文件。在64位版本的Windows内，微软使用\Windows\System32文件夹做为64位DLL的仓库，而不是32位DLL文件的。</font></div><div>32位代码不能默认在64位版本的Windows内运行。为了运行32位的应用程序，Windows使用WOW64 emulator，来让这些应用程序还认为它们在32位版本的Windows内运行。&nbsp;<font color="#FF0000" style="word-wrap: normal; word-break: normal;">当你安装一个32位的应用程序，安装向导通过WOW64 emulato运行。</font>这意味着当你安装一个应用程序，<font color="#FF0000" style="word-wrap: normal; word-break: normal;">安装向导并不知道这个程序被安装到64位版本的Windows内，并且和它运行在32位操作系统一样把DLL文件写到\Windows\System32文件夹里面。</font>当然，WOW64知道安装向导通过emulator来运行的32位应用程序。同时也知道64和32位代码不能混合在一起。所以，WOW64 emulator 给\Windows\SysWOW64创建一个别名。这意味着32位应用程序要写入到\Windows\System32文件夹或者从\Windows\System32文件夹读取，<font color="#FF0000" style="word-wrap: normal; word-break: normal;">WOW64 emulator都能使其改道到\Windows\SysWOW64文件夹。</font></div><div><font color="#FF0000" style="word-wrap: normal; word-break: normal;">当然，可以使用函数禁止重定向：Wow64DisableWow64FsRedirection&nbsp;</font></div><div><span style="word-wrap: normal; word-break: normal; color: rgb(255, 0, 0);">或恢复重定向:Wow64RevertWow64FsRedirection</span></div></div></div>