<meta http-equiv="Content-Type" content="text/html; charset=utf-8"><title>马士兵大哥数据库教程3阶段</title><?xml version="1.0" encoding="UTF-8"?>


<div style="word-wrap: break-word; -webkit-nbsp-mode: space; -webkit-line-break: after-white-space;">
游标（CURSOR）：
<div>&nbsp; &nbsp;(1) &nbsp;DECLARE CURSOUR C IS&nbsp;</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;SELECT * FROM EMP;</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;V_EMP C%ROWTYPE;</div><div>&nbsp; &nbsp; &nbsp;BEGIN</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; OPEN C;</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; FETCH C INTO V_EMP; --</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; DBMS_OUTPUT.PUTLINE(V_EMP.ENAME);</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; CLOSE C;</div><div>&nbsp; &nbsp; &nbsp;END;</div><div>&nbsp; &nbsp;(2) &nbsp;DECLARE&nbsp;</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; CURSOR C IS&nbsp;</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;SELECT &nbsp;* FROM EMP;</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; V_EMP C%ROWTYPE;</div><div>&nbsp; &nbsp; &nbsp;BEGIN&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;OPEN C;</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;LOOP</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; FETCH &nbsp;C INTO V_EMP;</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; DBMS_OUTPUT.PUTLINE(V_EMP.EMPNAME);</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; EXIT WHEN (C%NOTFOUND);</div><div>&nbsp; &nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; END LOOP;</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; CLOSE C;</div><div>&nbsp; &nbsp; &nbsp;END;&nbsp;</div><div><br/></div><div>Procedure/存储过程。EXEC PROCEDURE ;(2)BGEIN P;END; 将declare替换成create or replace Procedure d</div><div>CREATE OR REPLACE FUNCTION SAL_TAX --创建函数，用在函数用来改用的地方</div><div>&lt;V_SAL NUMBER&gt;</div><div>RETURN NUMBER</div><div>IS</div><div>BEGIN&nbsp;</div><div>&nbsp; &nbsp; &nbsp;IF (V_SAL &lt; 2000) THEN RETURN 0.10;</div><div>&nbsp; &nbsp; &nbsp;ELSIF (V_SAL &lt; 2750) THEN RETURN 0.15;</div><div>&nbsp; &nbsp; &nbsp;ELSE RETURN 0.20;</div><div>&nbsp; &nbsp; &nbsp;END IF;</div><div>&nbsp; &nbsp; &nbsp;END;</div><div><span style="font-size: 19px;"><font color="#4F009A">触发器：</font></span></div><div>&nbsp; &nbsp; &nbsp;CREATE TABEL EMP2_LOG</div><div>&nbsp; &nbsp; &nbsp;(</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; UNAME VARCHAR2(20),</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ACTION VARCHAR2(10),</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ATIME DATE</div><div>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;);</div><div><font color="#4F009A" style="font-size: 16px;"><br/></font></div><div>&nbsp; &nbsp; &nbsp;<font color="#4F009A" style="font-size: 16px;">CREATE OR REPLACE TRIGGER TRIG</font></div><div style="font-size: 16px;"><font color="#4F009A">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; AFTER INSERT OR DELETE OR UPDATE ON EMP2 FOR</font> <font color="#FF0000">EACH ROW --每更新一行就操作</font></div><div>&nbsp; &nbsp; &nbsp;BEGIN&nbsp;</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; IF INSERTING THEN&nbsp;</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;INSERT INTO EMP2_LOG VALUES (USER,&#39;INSERT&#39;,SYSDATE);</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ELSIF UPDATING THEN&nbsp;</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;INSERT INTO EMP2_LOG VALUES (USER,&#39;UPDATE&#39;,SYSDATE);</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ELSIF DELETING THEN</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;INSERT INTO EMP2_LOG VALUES (USER,&#39;DELETE&#39;,SYSDATE);&nbsp;</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; END IF;</div><div>&nbsp; &nbsp; &nbsp;END;</div><div><br/></div><div>触发器实际 应用，修改一个关联的值时对相应影响的栏位也进行修改：</div><div>&nbsp; &nbsp; &nbsp;CREATE OR REPLACE TRIGGER TRIG</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; AFTER UPDATE ON DEPT</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; FOR EACH ROW</div><div>&nbsp; &nbsp; &nbsp;BEGIN</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; UPDATE EMP SET DEPNO = :NEW.DEPTNO WHERE DEPNO = :OLD.DEPNO;</div><div>&nbsp; &nbsp; &nbsp;END;/</div><div>&nbsp;将参考 了该值得所有记录都改变了。</div><div><br/></div><div>--树状结构存储</div><div>CREATE TABLE ARTICLE</div><div>(</div><div>&nbsp; &nbsp; &nbsp;ID NUMBER PRIMARY KEY,</div><div>&nbsp; &nbsp; &nbsp;CONT VARCHAR2(4000),</div><div>&nbsp; &nbsp; &nbsp;PID NUMBER,</div><div>&nbsp; &nbsp; &nbsp;ISLEAF NUMBER(1), --0代表非叶子节点，1代表叶子节点</div><div>&nbsp; &nbsp; &nbsp;aleavel number(2)</div><div>);</div><div>--show erro 显示错误</div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div>&nbsp; &nbsp; &nbsp;&nbsp;</div></div>