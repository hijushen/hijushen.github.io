<!DOCTYPE HTML><html><head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">

<title>oracle的建表sql转成sqlserver的建表sql时的注意点</title>
    <!--mark |wiz_custom_css| for wizeditor replace it-->


<style id="wiz_custom_css">        html, body {            font-size: 15px;        }        body {            font-family: Helvetica, 'Hiragino Sans GB', '微软雅黑', 'Microsoft YaHei UI', SimSun, SimHei, arial, sans-serif;            line-height: 1.6;            margin: 0;            padding: 20px 36px;            padding: 1.33rem 2.4rem;        }        h1, h2, h3, h4, h5, h6 {            margin: 20px 0 10px;            margin: 1.33rem 0 0.667rem;            padding: 0;            font-weight: bold;        }        h1 {            font-size: 21px;            font-size: 1.4rem;        }        h2 {            font-size: 20px;            font-size: 1.33rem;        }        h3 {            font-size: 18px;            font-size: 1.2rem;        }        h4 {            font-size: 17px;            font-size: 1.13rem;        }        h5 {            font-size: 15px;            font-size: 1rem;        }        h6 {            font-size: 15px;            font-size: 1rem;            color: #777777;            margin: 1rem 0;        }        div, p, ul, ol, dl, li {            margin: 0;        }        blockquote, table, pre, code {            margin: 8px 0;        }        ul, ol {            padding-left: 32px;            padding-left: 2.13rem;        }        blockquote {            padding: 0 12px;            padding: 0 0.8rem;        }        blockquote > :first-child {            margin-top: 0;        }        blockquote > :last-child {            margin-bottom: 0;        }        img {            border: 0;            max-width: 100%;            height: auto !important;            margin: 2px 0;        }        table {            border-collapse: collapse;            border: 1px solid #bbbbbb;        }        td {            padding: 4px 8px;            border-collapse: collapse;            border: 1px solid #bbbbbb;        }        @media screen and (max-width: 660px) {            body {                padding: 20px 18px;                padding: 1.33rem 1.2rem;            }        }        @media only screen and (-webkit-max-device-width: 1024px), only screen and (-o-max-device-width: 1024px), only screen and (max-device-width: 1024px), only screen and (-webkit-min-device-pixel-ratio: 3), only screen and (-o-min-device-pixel-ratio: 3), only screen and (min-device-pixel-ratio: 3) {            html, body {                font-size: 17px;            }            body {                line-height: 1.7;                padding: 0.75rem 0.9375rem;                color: #353c47;            }            h1 {                font-size: 2.125rem;            }            h2 {                font-size: 1.875rem;            }            h3 {                font-size: 1.625rem;            }            h4 {                font-size: 1.375rem;            }            h5 {                font-size: 1.125rem;            }            h6 {                color: inherit;            }            ul, ol {                padding-left: 2.5rem;            }            blockquote {                padding: 0 0.9375rem;            }        }</style><style type="text/css" id="wiz_todo_style_id" wiz_link_version="01.00.09">.wiz-todo, .wiz-todo-img {width: 16px; height: 16px; cursor: default; padding: 0 10px 0 2px; vertical-align: -10%;-webkit-user-select: none;} .wiz-todo-label { display: inline-block; padding-top: 7px; padding-bottom: 6px; line-height: 1.5;} .wiz-todo-label-checked {  color: #666;} .wiz-todo-label-unchecked {text-decoration: initial;} .wiz-todo-completed-info {padding-left: 44px; display: inline-block; } .wiz-todo-avatar { width:20px; height: 20px; vertical-align: -20%; margin-right:10px; border-radius: 2px;} .wiz-todo-account, .wiz-todo-dt { color: #666; }</style></head>

<body  style=""><p style="padding: 0px; font-family: Helvetica, Tahoma, Arial, sans-serif; font-size: 14px; line-height: 25.2px; widows: 1; background-color: rgb(255, 255, 255);"><span style="font-size: 18px;">oracle的建表sql转成sqlserver的建表sql时的注意点 :</span><br>1.所有的comment语句需要删除。<br>2.clob类型转换为text类型。<br>3.blob类型转换为image类型。<br>4.number类型转换为int，number(16,2)等转换为decimal(16,2)，number(18)转换为bigint。<br>5.default sysdate改为default getDate()。<br>6.to_date('2009-12-18','yyyy-mm-dd')改为cast('2009-12-18'&nbsp; as&nbsp;&nbsp; datetime)<br><br><span style="font-size: 18px;">SQLSERVER:</span><br><span style="font-size: 18px;"><span style="color: rgb(128, 0, 128);"><strong>变量的声明</strong></span>:</span><br>声明变量时必须在变量前加@符号<br>DECLARE @I INT<br><br><strong><span style="font-size: 18px; color: rgb(128, 0, 128);">变量的赋值:</span></strong><br>变量赋值时变量前必须加set<br>SET @I = 30<br><br><span style="font-size: 18px;"><strong><span style="color: rgb(128, 0, 128);">声明多个变量</span></strong></span>:<br>DECLARE @s varchar(10),@a INT<br><br><span style="font-size: 18px;"><strong><span style="color: rgb(128, 0, 128);">if语句</span></strong></span>:</p><div class="dp-highlighter" id="" style="font-family: Monaco, 'DejaVu Sans Mono', 'Bitstream Vera Sans Mono', Consolas, 'Courier New', monospace; font-size: 12px; width: 679px; overflow: auto; margin-left: 9px; padding: 1px; word-break: break-all; word-wrap: break-word; line-height: 25.2px; widows: 1; background-color: rgb(255, 255, 255);"><div class="bar"><div class="tools" style="padding: 3px; font-weight: bold;">Java代码&nbsp;<embed wmode="transparent" src="http://uule.iteye.com/javascripts/syntaxhighlighter/clipboard_new.swf" width="14" height="15" flashvars="clipboard=if%20..%0Abegin%0A%20%20...%0Aend%0Aelse%20if%20..%0Abegin%0A%20%20...%0Aend%0Aelse%0Abegin%0A%20%20...%0Aend%20" quality="high" allowscriptaccess="always" type="application/x-shockwave-flash" pluginspage="http://www.macromedia.com/go/getflashplayer">&nbsp;<a href="" title="收藏这段代码" style="color: rgb(16, 138, 198);"><img class="star" src="http://uule.iteye.com/images/icon_star.png" alt="收藏代码"></a></div></div><ol start="1" class="dp-j" style="font-size: 1em; line-height: 1.4em; margin-bottom: 1px; padding: 2px 0px; border: 1px solid rgb(209, 215, 220); list-style-position: initial; list-style-image: initial; color: rgb(43, 145, 175);"><li style="font-size: 1em; margin-left: 38px; padding: 0px 0px 0px 10px; border-left-width: 1px; border-left-style: solid; border-left-color: rgb(209, 215, 220); line-height: 18px; background-color: rgb(250, 250, 250);"><span style="color: black;"><span class="keyword" style="color: rgb(127, 0, 85); font-weight: bold;">if</span>&nbsp;..&nbsp;&nbsp;</span></li><li style="font-size: 1em; margin-left: 38px; padding: 0px 0px 0px 10px; border-left-width: 1px; border-left-style: solid; border-left-color: rgb(209, 215, 220); line-height: 18px; background-color: rgb(250, 250, 250);"><span style="color: black;">begin&nbsp;&nbsp;</span></li><li style="font-size: 1em; margin-left: 38px; padding: 0px 0px 0px 10px; border-left-width: 1px; border-left-style: solid; border-left-color: rgb(209, 215, 220); line-height: 18px; background-color: rgb(250, 250, 250);"><span style="color: black;">&nbsp;&nbsp;...&nbsp;&nbsp;</span></li><li style="font-size: 1em; margin-left: 38px; padding: 0px 0px 0px 10px; border-left-width: 1px; border-left-style: solid; border-left-color: rgb(209, 215, 220); line-height: 18px; background-color: rgb(250, 250, 250);"><span style="color: black;">end&nbsp;&nbsp;</span></li><li style="font-size: 1em; margin-left: 38px; padding: 0px 0px 0px 10px; border-left-width: 1px; border-left-style: solid; border-left-color: rgb(209, 215, 220); line-height: 18px; background-color: rgb(250, 250, 250);"><span style="color: black;"><span class="keyword" style="color: rgb(127, 0, 85); font-weight: bold;">else</span>&nbsp;<span class="keyword" style="color: rgb(127, 0, 85); font-weight: bold;">if</span>&nbsp;..&nbsp;&nbsp;</span></li><li style="font-size: 1em; margin-left: 38px; padding: 0px 0px 0px 10px; border-left-width: 1px; border-left-style: solid; border-left-color: rgb(209, 215, 220); line-height: 18px; background-color: rgb(250, 250, 250);"><span style="color: black;">begin&nbsp;&nbsp;</span></li><li style="font-size: 1em; margin-left: 38px; padding: 0px 0px 0px 10px; border-left-width: 1px; border-left-style: solid; border-left-color: rgb(209, 215, 220); line-height: 18px; background-color: rgb(250, 250, 250);"><span style="color: black;">&nbsp;&nbsp;...&nbsp;&nbsp;</span></li><li style="font-size: 1em; margin-left: 38px; padding: 0px 0px 0px 10px; border-left-width: 1px; border-left-style: solid; border-left-color: rgb(209, 215, 220); line-height: 18px; background-color: rgb(250, 250, 250);"><span style="color: black;">end&nbsp;&nbsp;</span></li><li style="font-size: 1em; margin-left: 38px; padding: 0px 0px 0px 10px; border-left-width: 1px; border-left-style: solid; border-left-color: rgb(209, 215, 220); line-height: 18px; background-color: rgb(250, 250, 250);"><span style="color: black;"><span class="keyword" style="color: rgb(127, 0, 85); font-weight: bold;">else</span>&nbsp;&nbsp;</span></li><li style="font-size: 1em; margin-left: 38px; padding: 0px 0px 0px 10px; border-left-width: 1px; border-left-style: solid; border-left-color: rgb(209, 215, 220); line-height: 18px; background-color: rgb(250, 250, 250);"><span style="color: black;">begin&nbsp;&nbsp;</span></li><li style="font-size: 1em; margin-left: 38px; padding: 0px 0px 0px 10px; border-left-width: 1px; border-left-style: solid; border-left-color: rgb(209, 215, 220); line-height: 18px; background-color: rgb(250, 250, 250);"><span style="color: black;">&nbsp;&nbsp;...&nbsp;&nbsp;</span></li><li style="font-size: 1em; margin-left: 38px; padding: 0px 0px 0px 10px; border-left-width: 1px; border-left-style: solid; border-left-color: rgb(209, 215, 220); line-height: 18px; background-color: rgb(250, 250, 250);"><span style="color: black;">end&nbsp;&nbsp;&nbsp;</span></li></ol></div><p style="padding: 0px; font-family: Helvetica, Tahoma, Arial, sans-serif; font-size: 14px; line-height: 25.2px; widows: 1; background-color: rgb(255, 255, 255);">&nbsp;Example:</p><div class="dp-highlighter" id="" style="font-family: Monaco, 'DejaVu Sans Mono', 'Bitstream Vera Sans Mono', Consolas, 'Courier New', monospace; font-size: 12px; width: 679px; overflow: auto; margin-left: 9px; padding: 1px; word-break: break-all; word-wrap: break-word; line-height: 25.2px; widows: 1; background-color: rgb(255, 255, 255);"><div class="bar"><div class="tools" style="padding: 3px; font-weight: bold;">Sql代码&nbsp;<embed wmode="transparent" src="http://uule.iteye.com/javascripts/syntaxhighlighter/clipboard_new.swf" width="14" height="15" flashvars="clipboard=DECLARE%20%40d%20INT%0Aset%20%40d%20%3D%201%0AIF%20%40d%20%3D%201%20BEGIN%0A%20%20%20PRINT%20'%E6%AD%A3%E7%A1%AE'%0AEND%0AELSE%20BEGIN%0A%20%20%20PRINT%20'%E9%94%99%E8%AF%AF'%0AEND" quality="high" allowscriptaccess="always" type="application/x-shockwave-flash" pluginspage="http://www.macromedia.com/go/getflashplayer">&nbsp;<a href="" title="收藏这段代码" style="color: rgb(16, 138, 198);"><img class="star" src="http://uule.iteye.com/images/icon_star.png" alt="收藏代码"></a></div></div><ol start="1" class="dp-sql" style="font-size: 1em; line-height: 1.4em; margin-bottom: 1px; padding: 2px 0px; border: 1px solid rgb(209, 215, 220); list-style-position: initial; list-style-image: initial; color: rgb(43, 145, 175);"><li style="font-size: 1em; margin-left: 38px; padding: 0px 0px 0px 10px; border-left-width: 1px; border-left-style: solid; border-left-color: rgb(209, 215, 220); line-height: 18px; background-color: rgb(250, 250, 250);"><span style="color: black;"><span class="keyword" style="color: rgb(127, 0, 85); font-weight: bold;">DECLARE</span>&nbsp;@d&nbsp;<span class="keyword" style="color: rgb(127, 0, 85); font-weight: bold;">INT</span>&nbsp;&nbsp;</span></li><li style="font-size: 1em; margin-left: 38px; padding: 0px 0px 0px 10px; border-left-width: 1px; border-left-style: solid; border-left-color: rgb(209, 215, 220); line-height: 18px; background-color: rgb(250, 250, 250);"><span style="color: black;"><span class="keyword" style="color: rgb(127, 0, 85); font-weight: bold;">set</span>&nbsp;@d&nbsp;=&nbsp;1&nbsp;&nbsp;</span></li><li style="font-size: 1em; margin-left: 38px; padding: 0px 0px 0px 10px; border-left-width: 1px; border-left-style: solid; border-left-color: rgb(209, 215, 220); line-height: 18px; background-color: rgb(250, 250, 250);"><span style="color: black;">IF&nbsp;@d&nbsp;=&nbsp;1&nbsp;<span class="keyword" style="color: rgb(127, 0, 85); font-weight: bold;">BEGIN</span>&nbsp;&nbsp;</span></li><li style="font-size: 1em; margin-left: 38px; padding: 0px 0px 0px 10px; border-left-width: 1px; border-left-style: solid; border-left-color: rgb(209, 215, 220); line-height: 18px; background-color: rgb(250, 250, 250);"><span style="color: black;">&nbsp;&nbsp;&nbsp;PRINT&nbsp;<span class="string" style="color: blue;">'正确'</span>&nbsp;&nbsp;</span></li><li style="font-size: 1em; margin-left: 38px; padding: 0px 0px 0px 10px; border-left-width: 1px; border-left-style: solid; border-left-color: rgb(209, 215, 220); line-height: 18px; background-color: rgb(250, 250, 250);"><span style="color: black;"><span class="keyword" style="color: rgb(127, 0, 85); font-weight: bold;">END</span>&nbsp;&nbsp;</span></li><li style="font-size: 1em; margin-left: 38px; padding: 0px 0px 0px 10px; border-left-width: 1px; border-left-style: solid; border-left-color: rgb(209, 215, 220); line-height: 18px; background-color: rgb(250, 250, 250);"><span style="color: black;"><span class="keyword" style="color: rgb(127, 0, 85); font-weight: bold;">ELSE</span>&nbsp;<span class="keyword" style="color: rgb(127, 0, 85); font-weight: bold;">BEGIN</span>&nbsp;&nbsp;</span></li><li style="font-size: 1em; margin-left: 38px; padding: 0px 0px 0px 10px; border-left-width: 1px; border-left-style: solid; border-left-color: rgb(209, 215, 220); line-height: 18px; background-color: rgb(250, 250, 250);"><span style="color: black;">&nbsp;&nbsp;&nbsp;PRINT&nbsp;<span class="string" style="color: blue;">'错误'</span>&nbsp;&nbsp;</span></li><li style="font-size: 1em; margin-left: 38px; padding: 0px 0px 0px 10px; border-left-width: 1px; border-left-style: solid; border-left-color: rgb(209, 215, 220); line-height: 18px; background-color: rgb(250, 250, 250);"><span style="color: black;"><span class="keyword" style="color: rgb(127, 0, 85); font-weight: bold;">END</span>&nbsp;&nbsp;</span></li></ol></div><p style="padding: 0px; font-family: Helvetica, Tahoma, Arial, sans-serif; font-size: 14px; line-height: 25.2px; widows: 1; background-color: rgb(255, 255, 255);">&nbsp;<br><strong><span style="font-size: 18px; color: rgb(128, 0, 128);">多条件选择语句:</span></strong><br>Example:</p><div class="dp-highlighter" id="" style="font-family: Monaco, 'DejaVu Sans Mono', 'Bitstream Vera Sans Mono', Consolas, 'Courier New', monospace; font-size: 12px; width: 679px; overflow: auto; margin-left: 9px; padding: 1px; word-break: break-all; word-wrap: break-word; line-height: 25.2px; widows: 1; background-color: rgb(255, 255, 255);"><div class="bar"><div class="tools" style="padding: 3px; font-weight: bold;">Sql代码&nbsp;<embed wmode="transparent" src="http://uule.iteye.com/javascripts/syntaxhighlighter/clipboard_new.swf" width="14" height="15" flashvars="clipboard=declare%20%40today%20int%0Adeclare%20%40week%20nvarchar(3)%0Aset%20%40today%3D3%0Aset%20%40week%3D%20case%0A%20%20%20%20%20when%20%40today%3D1%20then%20'%E6%98%9F%E6%9C%9F%E4%B8%80'%0A%20%20%20%20%20when%20%40today%3D2%20then%20'%E6%98%9F%E6%9C%9F%E4%BA%8C'%0A%20%20%20%20%20when%20%40today%3D3%20then%20'%E6%98%9F%E6%9C%9F%E4%B8%89'%0A%20%20%20%20%20when%20%40today%3D4%20then%20'%E6%98%9F%E6%9C%9F%E5%9B%9B'%0A%20%20%20%20%20when%20%40today%3D5%20then%20'%E6%98%9F%E6%9C%9F%E4%BA%94'%0A%20%20%20%20%20when%20%40today%3D6%20then%20'%E6%98%9F%E6%9C%9F%E5%85%AD'%0A%20%20%20%20%20when%20%40today%3D7%20then%20'%E6%98%9F%E6%9C%9F%E6%97%A5'%0A%20%20%20%20%20else%20'%E5%80%BC%E9%94%99%E8%AF%AF'%0Aend%0Aprint%20%40week" quality="high" allowscriptaccess="always" type="application/x-shockwave-flash" pluginspage="http://www.macromedia.com/go/getflashplayer">&nbsp;<a href="" title="收藏这段代码" style="color: rgb(16, 138, 198);"><img class="star" src="http://uule.iteye.com/images/icon_star.png" alt="收藏代码"></a></div></div><ol start="1" class="dp-sql" style="font-size: 1em; line-height: 1.4em; margin-bottom: 1px; padding: 2px 0px; border: 1px solid rgb(209, 215, 220); list-style-position: initial; list-style-image: initial; color: rgb(43, 145, 175);"><li style="font-size: 1em; margin-left: 38px; padding: 0px 0px 0px 10px; border-left-width: 1px; border-left-style: solid; border-left-color: rgb(209, 215, 220); line-height: 18px; background-color: rgb(250, 250, 250);"><span style="color: black;"><span class="keyword" style="color: rgb(127, 0, 85); font-weight: bold;">declare</span>&nbsp;@today&nbsp;<span class="keyword" style="color: rgb(127, 0, 85); font-weight: bold;">int</span>&nbsp;&nbsp;</span></li><li style="font-size: 1em; margin-left: 38px; padding: 0px 0px 0px 10px; border-left-width: 1px; border-left-style: solid; border-left-color: rgb(209, 215, 220); line-height: 18px; background-color: rgb(250, 250, 250);"><span style="color: black;"><span class="keyword" style="color: rgb(127, 0, 85); font-weight: bold;">declare</span>&nbsp;@week&nbsp;nvarchar(3)&nbsp;&nbsp;</span></li><li style="font-size: 1em; margin-left: 38px; padding: 0px 0px 0px 10px; border-left-width: 1px; border-left-style: solid; border-left-color: rgb(209, 215, 220); line-height: 18px; background-color: rgb(250, 250, 250);"><span style="color: black;"><span class="keyword" style="color: rgb(127, 0, 85); font-weight: bold;">set</span>&nbsp;@today=3&nbsp;&nbsp;</span></li><li style="font-size: 1em; margin-left: 38px; padding: 0px 0px 0px 10px; border-left-width: 1px; border-left-style: solid; border-left-color: rgb(209, 215, 220); line-height: 18px; background-color: rgb(250, 250, 250);"><span style="color: black;"><span class="keyword" style="color: rgb(127, 0, 85); font-weight: bold;">set</span>&nbsp;@week=&nbsp;<span class="func" style="color: rgb(255, 20, 147);">case</span>&nbsp;&nbsp;</span></li><li style="font-size: 1em; margin-left: 38px; padding: 0px 0px 0px 10px; border-left-width: 1px; border-left-style: solid; border-left-color: rgb(209, 215, 220); line-height: 18px; background-color: rgb(250, 250, 250);"><span style="color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" style="color: rgb(127, 0, 85); font-weight: bold;">when</span>&nbsp;@today=1&nbsp;<span class="keyword" style="color: rgb(127, 0, 85); font-weight: bold;">then</span>&nbsp;<span class="string" style="color: blue;">'星期一'</span>&nbsp;&nbsp;</span></li><li style="font-size: 1em; margin-left: 38px; padding: 0px 0px 0px 10px; border-left-width: 1px; border-left-style: solid; border-left-color: rgb(209, 215, 220); line-height: 18px; background-color: rgb(250, 250, 250);"><span style="color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" style="color: rgb(127, 0, 85); font-weight: bold;">when</span>&nbsp;@today=2&nbsp;<span class="keyword" style="color: rgb(127, 0, 85); font-weight: bold;">then</span>&nbsp;<span class="string" style="color: blue;">'星期二'</span>&nbsp;&nbsp;</span></li><li style="font-size: 1em; margin-left: 38px; padding: 0px 0px 0px 10px; border-left-width: 1px; border-left-style: solid; border-left-color: rgb(209, 215, 220); line-height: 18px; background-color: rgb(250, 250, 250);"><span style="color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" style="color: rgb(127, 0, 85); font-weight: bold;">when</span>&nbsp;@today=3&nbsp;<span class="keyword" style="color: rgb(127, 0, 85); font-weight: bold;">then</span>&nbsp;<span class="string" style="color: blue;">'星期三'</span>&nbsp;&nbsp;</span></li><li style="font-size: 1em; margin-left: 38px; padding: 0px 0px 0px 10px; border-left-width: 1px; border-left-style: solid; border-left-color: rgb(209, 215, 220); line-height: 18px; background-color: rgb(250, 250, 250);"><span style="color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" style="color: rgb(127, 0, 85); font-weight: bold;">when</span>&nbsp;@today=4&nbsp;<span class="keyword" style="color: rgb(127, 0, 85); font-weight: bold;">then</span>&nbsp;<span class="string" style="color: blue;">'星期四'</span>&nbsp;&nbsp;</span></li><li style="font-size: 1em; margin-left: 38px; padding: 0px 0px 0px 10px; border-left-width: 1px; border-left-style: solid; border-left-color: rgb(209, 215, 220); line-height: 18px; background-color: rgb(250, 250, 250);"><span style="color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" style="color: rgb(127, 0, 85); font-weight: bold;">when</span>&nbsp;@today=5&nbsp;<span class="keyword" style="color: rgb(127, 0, 85); font-weight: bold;">then</span>&nbsp;<span class="string" style="color: blue;">'星期五'</span>&nbsp;&nbsp;</span></li><li style="font-size: 1em; margin-left: 38px; padding: 0px 0px 0px 10px; border-left-width: 1px; border-left-style: solid; border-left-color: rgb(209, 215, 220); line-height: 18px; background-color: rgb(250, 250, 250);"><span style="color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" style="color: rgb(127, 0, 85); font-weight: bold;">when</span>&nbsp;@today=6&nbsp;<span class="keyword" style="color: rgb(127, 0, 85); font-weight: bold;">then</span>&nbsp;<span class="string" style="color: blue;">'星期六'</span>&nbsp;&nbsp;</span></li><li style="font-size: 1em; margin-left: 38px; padding: 0px 0px 0px 10px; border-left-width: 1px; border-left-style: solid; border-left-color: rgb(209, 215, 220); line-height: 18px; background-color: rgb(250, 250, 250);"><span style="color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" style="color: rgb(127, 0, 85); font-weight: bold;">when</span>&nbsp;@today=7&nbsp;<span class="keyword" style="color: rgb(127, 0, 85); font-weight: bold;">then</span>&nbsp;<span class="string" style="color: blue;">'星期日'</span>&nbsp;&nbsp;</span></li><li style="font-size: 1em; margin-left: 38px; padding: 0px 0px 0px 10px; border-left-width: 1px; border-left-style: solid; border-left-color: rgb(209, 215, 220); line-height: 18px; background-color: rgb(250, 250, 250);"><span style="color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" style="color: rgb(127, 0, 85); font-weight: bold;">else</span>&nbsp;<span class="string" style="color: blue;">'值错误'</span>&nbsp;&nbsp;</span></li><li style="font-size: 1em; margin-left: 38px; padding: 0px 0px 0px 10px; border-left-width: 1px; border-left-style: solid; border-left-color: rgb(209, 215, 220); line-height: 18px; background-color: rgb(250, 250, 250);"><span style="color: black;"><span class="keyword" style="color: rgb(127, 0, 85); font-weight: bold;">end</span>&nbsp;&nbsp;</span></li><li style="font-size: 1em; margin-left: 38px; padding: 0px 0px 0px 10px; border-left-width: 1px; border-left-style: solid; border-left-color: rgb(209, 215, 220); line-height: 18px; background-color: rgb(250, 250, 250);"><span style="color: black;">print&nbsp;@week&nbsp;&nbsp;</span></li></ol></div><p style="padding: 0px; font-family: Helvetica, Tahoma, Arial, sans-serif; font-size: 14px; line-height: 25.2px; widows: 1; background-color: rgb(255, 255, 255);">&nbsp;<br><strong><span style="font-size: 18px; color: rgb(128, 0, 128);">循环语句</span></strong>:</p><div class="dp-highlighter" id="" style="font-family: Monaco, 'DejaVu Sans Mono', 'Bitstream Vera Sans Mono', Consolas, 'Courier New', monospace; font-size: 12px; width: 679px; overflow: auto; margin-left: 9px; padding: 1px; word-break: break-all; word-wrap: break-word; line-height: 25.2px; widows: 1; background-color: rgb(255, 255, 255);"><div class="bar"><div class="tools" style="padding: 3px; font-weight: bold;">Java代码&nbsp;<embed wmode="transparent" src="http://uule.iteye.com/javascripts/syntaxhighlighter/clipboard_new.swf" width="14" height="15" flashvars="clipboard=WHILE%20%E6%9D%A1%E4%BB%B6%20BEGIN%20%20%0A%E6%89%A7%E8%A1%8C%E8%AF%AD%E5%8F%A5%0AEND%20%20" quality="high" allowscriptaccess="always" type="application/x-shockwave-flash" pluginspage="http://www.macromedia.com/go/getflashplayer">&nbsp;<a href="" title="收藏这段代码" style="color: rgb(16, 138, 198);"><img class="star" src="http://uule.iteye.com/images/icon_star.png" alt="收藏代码"></a></div></div><ol start="1" class="dp-j" style="font-size: 1em; line-height: 1.4em; margin-bottom: 1px; padding: 2px 0px; border: 1px solid rgb(209, 215, 220); list-style-position: initial; list-style-image: initial; color: rgb(43, 145, 175);"><li style="font-size: 1em; margin-left: 38px; padding: 0px 0px 0px 10px; border-left-width: 1px; border-left-style: solid; border-left-color: rgb(209, 215, 220); line-height: 18px; background-color: rgb(250, 250, 250);"><span style="color: black;">WHILE&nbsp;条件&nbsp;BEGIN&nbsp;&nbsp;&nbsp;&nbsp;</span></li><li style="font-size: 1em; margin-left: 38px; padding: 0px 0px 0px 10px; border-left-width: 1px; border-left-style: solid; border-left-color: rgb(209, 215, 220); line-height: 18px; background-color: rgb(250, 250, 250);"><span style="color: black;">执行语句&nbsp;&nbsp;</span></li><li style="font-size: 1em; margin-left: 38px; padding: 0px 0px 0px 10px; border-left-width: 1px; border-left-style: solid; border-left-color: rgb(209, 215, 220); line-height: 18px; background-color: rgb(250, 250, 250);"><span style="color: black;">END&nbsp;&nbsp;&nbsp;&nbsp;</span></li></ol></div><p style="padding: 0px; font-family: Helvetica, Tahoma, Arial, sans-serif; font-size: 14px; line-height: 25.2px; widows: 1; background-color: rgb(255, 255, 255);">&nbsp;Example:</p><div class="dp-highlighter" id="" style="font-family: Monaco, 'DejaVu Sans Mono', 'Bitstream Vera Sans Mono', Consolas, 'Courier New', monospace; font-size: 12px; width: 679px; overflow: auto; margin-left: 9px; padding: 1px; word-break: break-all; word-wrap: break-word; line-height: 25.2px; widows: 1; background-color: rgb(255, 255, 255);"><div class="bar"><div class="tools" style="padding: 3px; font-weight: bold;">Java代码&nbsp;<embed wmode="transparent" src="http://uule.iteye.com/javascripts/syntaxhighlighter/clipboard_new.swf" width="14" height="15" flashvars="clipboard=DECLARE%20%40i%20INT%0ASET%20%40i%20%3D%201%0AWHILE%20%40i%3C1000000%20BEGIN%0Aset%20%40i%3D%40i%2B1%0AEND" quality="high" allowscriptaccess="always" type="application/x-shockwave-flash" pluginspage="http://www.macromedia.com/go/getflashplayer">&nbsp;<a href="" title="收藏这段代码" style="color: rgb(16, 138, 198);"><img class="star" src="http://uule.iteye.com/images/icon_star.png" alt="收藏代码"></a></div></div><ol start="1" class="dp-j" style="font-size: 1em; line-height: 1.4em; margin-bottom: 1px; padding: 2px 0px; border: 1px solid rgb(209, 215, 220); list-style-position: initial; list-style-image: initial; color: rgb(43, 145, 175);"><li style="font-size: 1em; margin-left: 38px; padding: 0px 0px 0px 10px; border-left-width: 1px; border-left-style: solid; border-left-color: rgb(209, 215, 220); line-height: 18px; background-color: rgb(250, 250, 250);"><span style="color: black;">DECLARE&nbsp;<span class="annotation" style="color: rgb(100, 100, 100);">@i</span>&nbsp;INT&nbsp;&nbsp;</span></li><li style="font-size: 1em; margin-left: 38px; padding: 0px 0px 0px 10px; border-left-width: 1px; border-left-style: solid; border-left-color: rgb(209, 215, 220); line-height: 18px; background-color: rgb(250, 250, 250);"><span style="color: black;">SET&nbsp;<span class="annotation" style="color: rgb(100, 100, 100);">@i</span>&nbsp;=&nbsp;<span class="number" style="color: rgb(192, 0, 0);">1</span>&nbsp;&nbsp;</span></li><li style="font-size: 1em; margin-left: 38px; padding: 0px 0px 0px 10px; border-left-width: 1px; border-left-style: solid; border-left-color: rgb(209, 215, 220); line-height: 18px; background-color: rgb(250, 250, 250);"><span style="color: black;">WHILE&nbsp;<span class="annotation" style="color: rgb(100, 100, 100);">@i</span>&lt;<span class="number" style="color: rgb(192, 0, 0);">1000000</span>&nbsp;BEGIN&nbsp;&nbsp;</span></li><li style="font-size: 1em; margin-left: 38px; padding: 0px 0px 0px 10px; border-left-width: 1px; border-left-style: solid; border-left-color: rgb(209, 215, 220); line-height: 18px; background-color: rgb(250, 250, 250);"><span style="color: black;">set&nbsp;<span class="annotation" style="color: rgb(100, 100, 100);">@i</span>=<span class="annotation" style="color: rgb(100, 100, 100);">@i</span>+<span class="number" style="color: rgb(192, 0, 0);">1</span>&nbsp;&nbsp;</span></li><li style="font-size: 1em; margin-left: 38px; padding: 0px 0px 0px 10px; border-left-width: 1px; border-left-style: solid; border-left-color: rgb(209, 215, 220); line-height: 18px; background-color: rgb(250, 250, 250);"><span style="color: black;">END&nbsp;&nbsp;</span></li></ol></div><p style="padding: 0px; font-family: Helvetica, Tahoma, Arial, sans-serif; font-size: 14px; line-height: 25.2px; widows: 1; background-color: rgb(255, 255, 255);">&nbsp;</p><p style="padding: 0px; font-family: Helvetica, Tahoma, Arial, sans-serif; font-size: 14px; line-height: 25.2px; widows: 1; background-color: rgb(255, 255, 255);"><strong><span style="font-size: 18px; color: rgb(128, 0, 128);">定义游标：</span></strong></p><div class="dp-highlighter" id="" style="font-family: Monaco, 'DejaVu Sans Mono', 'Bitstream Vera Sans Mono', Consolas, 'Courier New', monospace; font-size: 12px; width: 679px; overflow: auto; margin-left: 9px; padding: 1px; word-break: break-all; word-wrap: break-word; line-height: 25.2px; widows: 1; background-color: rgb(255, 255, 255);"><div class="bar"><div class="tools" style="padding: 3px; font-weight: bold;">Sql代码&nbsp;<embed wmode="transparent" src="http://uule.iteye.com/javascripts/syntaxhighlighter/clipboard_new.swf" width="14" height="15" flashvars="clipboard=DECLARE%20%40cur1%20CURSOR%20FOR%20SELECT%20.........%0A%0AOPEN%20%40cur1%0AFETCH%20NEXT%20FROM%20%40cur1%20INTO%20%E5%8F%98%E9%87%8F%0AWHILE(%40%40FETCH_STATUS%3D0)%0ABEGIN%0A%E5%A4%84%E7%90%86.....%0AFETCH%20NEXT%20FROM%20%40cur1%20INTO%20%E5%8F%98%E9%87%8F%0AEND%0ACLOSE%20%40cur1%0ADEALLOCATE%20%40cur1%20" quality="high" allowscriptaccess="always" type="application/x-shockwave-flash" pluginspage="http://www.macromedia.com/go/getflashplayer">&nbsp;<a href="" title="收藏这段代码" style="color: rgb(16, 138, 198);"><img class="star" src="http://uule.iteye.com/images/icon_star.png" alt="收藏代码"></a></div></div><ol start="1" class="dp-sql" style="font-size: 1em; line-height: 1.4em; margin-bottom: 1px; padding: 2px 0px; border: 1px solid rgb(209, 215, 220); list-style-position: initial; list-style-image: initial; color: rgb(43, 145, 175);"><li style="font-size: 1em; margin-left: 38px; padding: 0px 0px 0px 10px; border-left-width: 1px; border-left-style: solid; border-left-color: rgb(209, 215, 220); line-height: 18px; background-color: rgb(250, 250, 250);"><span style="color: black;"><span class="keyword" style="color: rgb(127, 0, 85); font-weight: bold;">DECLARE</span>&nbsp;@cur1&nbsp;<span class="keyword" style="color: rgb(127, 0, 85); font-weight: bold;">CURSOR</span>&nbsp;<span class="keyword" style="color: rgb(127, 0, 85); font-weight: bold;">FOR</span>&nbsp;<span class="keyword" style="color: rgb(127, 0, 85); font-weight: bold;">SELECT</span>&nbsp;.........&nbsp;&nbsp;</span></li><li style="font-size: 1em; margin-left: 38px; padding: 0px 0px 0px 10px; border-left-width: 1px; border-left-style: solid; border-left-color: rgb(209, 215, 220); line-height: 18px; background-color: rgb(250, 250, 250);"><span style="color: black;">&nbsp;&nbsp;</span></li><li style="font-size: 1em; margin-left: 38px; padding: 0px 0px 0px 10px; border-left-width: 1px; border-left-style: solid; border-left-color: rgb(209, 215, 220); line-height: 18px; background-color: rgb(250, 250, 250);"><span style="color: black;"><span class="keyword" style="color: rgb(127, 0, 85); font-weight: bold;">OPEN</span>&nbsp;@cur1&nbsp;&nbsp;</span></li><li style="font-size: 1em; margin-left: 38px; padding: 0px 0px 0px 10px; border-left-width: 1px; border-left-style: solid; border-left-color: rgb(209, 215, 220); line-height: 18px; background-color: rgb(250, 250, 250);"><span style="color: black;"><span class="keyword" style="color: rgb(127, 0, 85); font-weight: bold;">FETCH</span>&nbsp;<span class="keyword" style="color: rgb(127, 0, 85); font-weight: bold;">NEXT</span>&nbsp;<span class="keyword" style="color: rgb(127, 0, 85); font-weight: bold;">FROM</span>&nbsp;@cur1&nbsp;<span class="keyword" style="color: rgb(127, 0, 85); font-weight: bold;">INTO</span>&nbsp;变量&nbsp;&nbsp;</span></li><li style="font-size: 1em; margin-left: 38px; padding: 0px 0px 0px 10px; border-left-width: 1px; border-left-style: solid; border-left-color: rgb(209, 215, 220); line-height: 18px; background-color: rgb(250, 250, 250);"><span style="color: black;">WHILE(@@FETCH_STATUS=0)&nbsp;&nbsp;</span></li><li style="font-size: 1em; margin-left: 38px; padding: 0px 0px 0px 10px; border-left-width: 1px; border-left-style: solid; border-left-color: rgb(209, 215, 220); line-height: 18px; background-color: rgb(250, 250, 250);"><span style="color: black;"><span class="keyword" style="color: rgb(127, 0, 85); font-weight: bold;">BEGIN</span>&nbsp;&nbsp;</span></li><li style="font-size: 1em; margin-left: 38px; padding: 0px 0px 0px 10px; border-left-width: 1px; border-left-style: solid; border-left-color: rgb(209, 215, 220); line-height: 18px; background-color: rgb(250, 250, 250);"><span style="color: black;">处理.....&nbsp;&nbsp;</span></li><li style="font-size: 1em; margin-left: 38px; padding: 0px 0px 0px 10px; border-left-width: 1px; border-left-style: solid; border-left-color: rgb(209, 215, 220); line-height: 18px; background-color: rgb(250, 250, 250);"><span style="color: black;"><span class="keyword" style="color: rgb(127, 0, 85); font-weight: bold;">FETCH</span>&nbsp;<span class="keyword" style="color: rgb(127, 0, 85); font-weight: bold;">NEXT</span>&nbsp;<span class="keyword" style="color: rgb(127, 0, 85); font-weight: bold;">FROM</span>&nbsp;@cur1&nbsp;<span class="keyword" style="color: rgb(127, 0, 85); font-weight: bold;">INTO</span>&nbsp;变量&nbsp;&nbsp;</span></li><li style="font-size: 1em; margin-left: 38px; padding: 0px 0px 0px 10px; border-left-width: 1px; border-left-style: solid; border-left-color: rgb(209, 215, 220); line-height: 18px; background-color: rgb(250, 250, 250);"><span style="color: black;"><span class="keyword" style="color: rgb(127, 0, 85); font-weight: bold;">END</span>&nbsp;&nbsp;</span></li><li style="font-size: 1em; margin-left: 38px; padding: 0px 0px 0px 10px; border-left-width: 1px; border-left-style: solid; border-left-color: rgb(209, 215, 220); line-height: 18px; background-color: rgb(250, 250, 250);"><span style="color: black;"><span class="keyword" style="color: rgb(127, 0, 85); font-weight: bold;">CLOSE</span>&nbsp;@cur1&nbsp;&nbsp;</span></li><li style="font-size: 1em; margin-left: 38px; padding: 0px 0px 0px 10px; border-left-width: 1px; border-left-style: solid; border-left-color: rgb(209, 215, 220); line-height: 18px; background-color: rgb(250, 250, 250);"><span style="color: black;"><span class="keyword" style="color: rgb(127, 0, 85); font-weight: bold;">DEALLOCATE</span>&nbsp;@cur1&nbsp;&nbsp;&nbsp;</span></li></ol></div><p style="padding: 0px; font-family: Helvetica, Tahoma, Arial, sans-serif; font-size: 14px; line-height: 25.2px; widows: 1; background-color: rgb(255, 255, 255);">&nbsp;</p><div class="dp-highlighter" id="" style="font-family: Monaco, 'DejaVu Sans Mono', 'Bitstream Vera Sans Mono', Consolas, 'Courier New', monospace; font-size: 12px; width: 679px; overflow: auto; margin-left: 9px; padding: 1px; word-break: break-all; word-wrap: break-word; line-height: 25.2px; widows: 1; background-color: rgb(255, 255, 255);"><div class="bar"><div class="tools" style="padding: 3px; font-weight: bold;">Sql代码&nbsp;<embed wmode="transparent" src="http://uule.iteye.com/javascripts/syntaxhighlighter/clipboard_new.swf" width="14" height="15" flashvars="clipboard=AS%0A%0Adeclare%20%40CATEGORY_CI_TABLENAME%20VARCHAR(50)%20%3D''%0Adeclare%20%40result%20VARCHAR(2000)%20%3D%20''%0Adeclare%20%40CI_ID%20DECIMAL%20%3D%200%0Adeclare%20%40num%20int%20%3D%201%0Adeclare%20%40countnum%20int%20%3D%201%0A%0ABEGIN%0Aselect%20%20%40countnum%20%3D%20count(ATTRIBUTE_CONFIG_ID)%20from%20T_ATTRIBUTE_CONFIG%20where%20CMDB_UPDATE_FLAG%3D%20'Y'%20and%20CATEGORY_CODE%20%3D%40CATEGORY_CODE%0A%20%0AIF%20(%40ATTRIBUTE2%3D'A')%0A%20%20begin%20%20%0A%09%09DECLARE%20MyCursor%20CURSOR%20for%20select%20ATTRIBUTE_CONFIG_CODE%20from%20T_ATTRIBUTE_CONFIG%20where%20%20CMDB_UPDATE_FLAG%3D%20'Y'%20and%20CATEGORY_CODE%20%3D%40CATEGORY_CODE%0A%09%09%20OPEN%20MyCursor%20FETCH%20NEXT%20FROM%20MyCursor%20INTO%20%40CONFIG_CODE%0A%09%09%09%09set%20%40result%20%3D%20%40result%2B%40CONFIG_CODE%2B'%2C'%0A%09%09%09%20WHILE%20%40%40FETCH_STATUS%20%3D%200%0A%09%09%09%09%09BEGIN%0A%09%09%09%09%09FETCH%20NEXT%20FROM%20MyCursor%20INTO%20%40CONFIG_CODE%0A%09%09%09%09%09set%20%40num%20%3D%20%40num%2B%201%0A%09%09%09%09%09%09if(%40num%3C%40countnum)%20%0A%09%09%09%09%09%09%09begin%0A%09%09%09%09%09%09%09%09set%20%40result%20%3D%20%40result%2B%40CONFIG_CODE%2B'%2C'%0A%09%09%09%09%09%09%09end%20%0A%09%09%09%09%09%09else%20if(%40num%3D%40countnum)%20%0A%09%09%09%09%09%09%09%20begin%0A%09%09%09%09%09%09%09%09set%20%40result%20%3D%20%40result%20%2B%40CONFIG_CODE%0A%09%09%09%09%09%09%09%20end%20%0A%09%09%09%09%09END%0A%09%09%09CLOSE%20MyCursor%20%0A%09%09%09DEALLOCATE%20MyCursor%20%0A%09%20%20%20%20set%20%40result%20%3D%20'insert%20into%20'%20%2B%20%40ATTRIBUTE1%20%2B%20'('%20%2B%20%40result%20%2B')%20select%20'%2B%20%40result%20%2B'%20from%20'%2B%40CATEGORY_CI_TABLENAME%20%2B'%20where%20CI_ORDER_LINE_ID%3D'%2B%40KEY_ID%0A%20%20end%20%09%09%09%0A%20else%20if((%40ATTRIBUTE2%3D'U'))" quality="high" allowscriptaccess="always" type="application/x-shockwave-flash" pluginspage="http://www.macromedia.com/go/getflashplayer">&nbsp;<a href="" title="收藏这段代码" style="color: rgb(16, 138, 198);"><img class="star" src="http://uule.iteye.com/images/icon_star.png" alt="收藏代码"></a></div></div><ol start="1" class="dp-sql" style="font-size: 1em; line-height: 1.4em; margin-bottom: 1px; padding: 2px 0px; border: 1px solid rgb(209, 215, 220); list-style-position: initial; list-style-image: initial; color: rgb(43, 145, 175);"><li style="font-size: 1em; margin-left: 38px; padding: 0px 0px 0px 10px; border-left-width: 1px; border-left-style: solid; border-left-color: rgb(209, 215, 220); line-height: 18px; background-color: rgb(250, 250, 250);"><span style="color: black;"><span class="keyword" style="color: rgb(127, 0, 85); font-weight: bold;">AS</span>&nbsp;&nbsp;</span></li><li style="font-size: 1em; margin-left: 38px; padding: 0px 0px 0px 10px; border-left-width: 1px; border-left-style: solid; border-left-color: rgb(209, 215, 220); line-height: 18px; background-color: rgb(250, 250, 250);"><span style="color: black;">&nbsp;&nbsp;</span></li><li style="font-size: 1em; margin-left: 38px; padding: 0px 0px 0px 10px; border-left-width: 1px; border-left-style: solid; border-left-color: rgb(209, 215, 220); line-height: 18px; background-color: rgb(250, 250, 250);"><span style="color: black;"><span class="keyword" style="color: rgb(127, 0, 85); font-weight: bold;">declare</span>&nbsp;@CATEGORY_CI_TABLENAME&nbsp;<span class="keyword" style="color: rgb(127, 0, 85); font-weight: bold;">VARCHAR</span>(50)&nbsp;=<span class="string" style="color: blue;">''</span>&nbsp;&nbsp;</span></li><li style="font-size: 1em; margin-left: 38px; padding: 0px 0px 0px 10px; border-left-width: 1px; border-left-style: solid; border-left-color: rgb(209, 215, 220); line-height: 18px; background-color: rgb(250, 250, 250);"><span style="color: black;"><span class="keyword" style="color: rgb(127, 0, 85); font-weight: bold;">declare</span>&nbsp;@result&nbsp;<span class="keyword" style="color: rgb(127, 0, 85); font-weight: bold;">VARCHAR</span>(2000)&nbsp;=&nbsp;<span class="string" style="color: blue;">''</span>&nbsp;&nbsp;</span></li><li style="font-size: 1em; margin-left: 38px; padding: 0px 0px 0px 10px; border-left-width: 1px; border-left-style: solid; border-left-color: rgb(209, 215, 220); line-height: 18px; background-color: rgb(250, 250, 250);"><span style="color: black;"><span class="keyword" style="color: rgb(127, 0, 85); font-weight: bold;">declare</span>&nbsp;@CI_ID&nbsp;<span class="keyword" style="color: rgb(127, 0, 85); font-weight: bold;">DECIMAL</span>&nbsp;=&nbsp;0&nbsp;&nbsp;</span></li><li style="font-size: 1em; margin-left: 38px; padding: 0px 0px 0px 10px; border-left-width: 1px; border-left-style: solid; border-left-color: rgb(209, 215, 220); line-height: 18px; background-color: rgb(250, 250, 250);"><span style="color: black;"><span class="keyword" style="color: rgb(127, 0, 85); font-weight: bold;">declare</span>&nbsp;@num&nbsp;<span class="keyword" style="color: rgb(127, 0, 85); font-weight: bold;">int</span>&nbsp;=&nbsp;1&nbsp;&nbsp;</span></li><li style="font-size: 1em; margin-left: 38px; padding: 0px 0px 0px 10px; border-left-width: 1px; border-left-style: solid; border-left-color: rgb(209, 215, 220); line-height: 18px; background-color: rgb(250, 250, 250);"><span style="color: black;"><span class="keyword" style="color: rgb(127, 0, 85); font-weight: bold;">declare</span>&nbsp;@countnum&nbsp;<span class="keyword" style="color: rgb(127, 0, 85); font-weight: bold;">int</span>&nbsp;=&nbsp;1&nbsp;&nbsp;</span></li><li style="font-size: 1em; margin-left: 38px; padding: 0px 0px 0px 10px; border-left-width: 1px; border-left-style: solid; border-left-color: rgb(209, 215, 220); line-height: 18px; background-color: rgb(250, 250, 250);"><span style="color: black;">&nbsp;&nbsp;</span></li><li style="font-size: 1em; margin-left: 38px; padding: 0px 0px 0px 10px; border-left-width: 1px; border-left-style: solid; border-left-color: rgb(209, 215, 220); line-height: 18px; background-color: rgb(250, 250, 250);"><span style="color: black;"><span class="keyword" style="color: rgb(127, 0, 85); font-weight: bold;">BEGIN</span>&nbsp;&nbsp;</span></li><li style="font-size: 1em; margin-left: 38px; padding: 0px 0px 0px 10px; border-left-width: 1px; border-left-style: solid; border-left-color: rgb(209, 215, 220); line-height: 18px; background-color: rgb(250, 250, 250);"><span style="color: black;"><span class="keyword" style="color: rgb(127, 0, 85); font-weight: bold;">select</span>&nbsp;&nbsp;@countnum&nbsp;=&nbsp;<span class="func" style="color: rgb(255, 20, 147);">count</span>(ATTRIBUTE_CONFIG_ID)&nbsp;<span class="keyword" style="color: rgb(127, 0, 85); font-weight: bold;">from</span>&nbsp;T_ATTRIBUTE_CONFIG&nbsp;<span class="keyword" style="color: rgb(127, 0, 85); font-weight: bold;">where</span>&nbsp;CMDB_UPDATE_FLAG=&nbsp;<span class="string" style="color: blue;">'Y'</span>&nbsp;<span class="op" style="color: rgb(128, 128, 128);">and</span>&nbsp;CATEGORY_CODE&nbsp;=@CATEGORY_CODE&nbsp;&nbsp;</span></li><li style="font-size: 1em; margin-left: 38px; padding: 0px 0px 0px 10px; border-left-width: 1px; border-left-style: solid; border-left-color: rgb(209, 215, 220); line-height: 18px; background-color: rgb(250, 250, 250);"><span style="color: black;">&nbsp;&nbsp;&nbsp;</span></li><li style="font-size: 1em; margin-left: 38px; padding: 0px 0px 0px 10px; border-left-width: 1px; border-left-style: solid; border-left-color: rgb(209, 215, 220); line-height: 18px; background-color: rgb(250, 250, 250);"><span style="color: black;">IF&nbsp;(@ATTRIBUTE2=<span class="string" style="color: blue;">'A'</span>)&nbsp;&nbsp;</span></li><li style="font-size: 1em; margin-left: 38px; padding: 0px 0px 0px 10px; border-left-width: 1px; border-left-style: solid; border-left-color: rgb(209, 215, 220); line-height: 18px; background-color: rgb(250, 250, 250);"><span style="color: black;">&nbsp;&nbsp;<span class="keyword" style="color: rgb(127, 0, 85); font-weight: bold;">begin</span>&nbsp;&nbsp;&nbsp;&nbsp;</span></li><li style="font-size: 1em; margin-left: 38px; padding: 0px 0px 0px 10px; border-left-width: 1px; border-left-style: solid; border-left-color: rgb(209, 215, 220); line-height: 18px; background-color: rgb(250, 250, 250);"><span style="color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" style="color: rgb(127, 0, 85); font-weight: bold;">DECLARE</span>&nbsp;MyCursor&nbsp;<span class="keyword" style="color: rgb(127, 0, 85); font-weight: bold;">CURSOR</span>&nbsp;<span class="keyword" style="color: rgb(127, 0, 85); font-weight: bold;">for</span>&nbsp;<span class="keyword" style="color: rgb(127, 0, 85); font-weight: bold;">select</span>&nbsp;ATTRIBUTE_CONFIG_CODE&nbsp;<span class="keyword" style="color: rgb(127, 0, 85); font-weight: bold;">from</span>&nbsp;T_ATTRIBUTE_CONFIG&nbsp;<span class="keyword" style="color: rgb(127, 0, 85); font-weight: bold;">where</span>&nbsp;&nbsp;CMDB_UPDATE_FLAG=&nbsp;<span class="string" style="color: blue;">'Y'</span>&nbsp;<span class="op" style="color: rgb(128, 128, 128);">and</span>&nbsp;CATEGORY_CODE&nbsp;=@CATEGORY_CODE&nbsp;&nbsp;</span></li><li style="font-size: 1em; margin-left: 38px; padding: 0px 0px 0px 10px; border-left-width: 1px; border-left-style: solid; border-left-color: rgb(209, 215, 220); line-height: 18px; background-color: rgb(250, 250, 250);"><span style="color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" style="color: rgb(127, 0, 85); font-weight: bold;">OPEN</span>&nbsp;MyCursor&nbsp;<span class="keyword" style="color: rgb(127, 0, 85); font-weight: bold;">FETCH</span>&nbsp;<span class="keyword" style="color: rgb(127, 0, 85); font-weight: bold;">NEXT</span>&nbsp;<span class="keyword" style="color: rgb(127, 0, 85); font-weight: bold;">FROM</span>&nbsp;MyCursor&nbsp;<span class="keyword" style="color: rgb(127, 0, 85); font-weight: bold;">INTO</span>&nbsp;@CONFIG_CODE&nbsp;&nbsp;</span></li><li style="font-size: 1em; margin-left: 38px; padding: 0px 0px 0px 10px; border-left-width: 1px; border-left-style: solid; border-left-color: rgb(209, 215, 220); line-height: 18px; background-color: rgb(250, 250, 250);"><span style="color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" style="color: rgb(127, 0, 85); font-weight: bold;">set</span>&nbsp;@result&nbsp;=&nbsp;@result+@CONFIG_CODE+<span class="string" style="color: blue;">','</span>&nbsp;&nbsp;</span></li><li style="font-size: 1em; margin-left: 38px; padding: 0px 0px 0px 10px; border-left-width: 1px; border-left-style: solid; border-left-color: rgb(209, 215, 220); line-height: 18px; background-color: rgb(250, 250, 250);"><span style="color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHILE&nbsp;@@FETCH_STATUS&nbsp;=&nbsp;0&nbsp;&nbsp;</span></li><li style="font-size: 1em; margin-left: 38px; padding: 0px 0px 0px 10px; border-left-width: 1px; border-left-style: solid; border-left-color: rgb(209, 215, 220); line-height: 18px; background-color: rgb(250, 250, 250);"><span style="color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" style="color: rgb(127, 0, 85); font-weight: bold;">BEGIN</span>&nbsp;&nbsp;</span></li><li style="font-size: 1em; margin-left: 38px; padding: 0px 0px 0px 10px; border-left-width: 1px; border-left-style: solid; border-left-color: rgb(209, 215, 220); line-height: 18px; background-color: rgb(250, 250, 250);"><span style="color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" style="color: rgb(127, 0, 85); font-weight: bold;">FETCH</span>&nbsp;<span class="keyword" style="color: rgb(127, 0, 85); font-weight: bold;">NEXT</span>&nbsp;<span class="keyword" style="color: rgb(127, 0, 85); font-weight: bold;">FROM</span>&nbsp;MyCursor&nbsp;<span class="keyword" style="color: rgb(127, 0, 85); font-weight: bold;">INTO</span>&nbsp;@CONFIG_CODE&nbsp;&nbsp;</span></li><li style="font-size: 1em; margin-left: 38px; padding: 0px 0px 0px 10px; border-left-width: 1px; border-left-style: solid; border-left-color: rgb(209, 215, 220); line-height: 18px; background-color: rgb(250, 250, 250);"><span style="color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" style="color: rgb(127, 0, 85); font-weight: bold;">set</span>&nbsp;@num&nbsp;=&nbsp;@num+&nbsp;1&nbsp;&nbsp;</span></li><li style="font-size: 1em; margin-left: 38px; padding: 0px 0px 0px 10px; border-left-width: 1px; border-left-style: solid; border-left-color: rgb(209, 215, 220); line-height: 18px; background-color: rgb(250, 250, 250);"><span style="color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(@num&lt;@countnum)&nbsp;&nbsp;&nbsp;</span></li><li style="font-size: 1em; margin-left: 38px; padding: 0px 0px 0px 10px; border-left-width: 1px; border-left-style: solid; border-left-color: rgb(209, 215, 220); line-height: 18px; background-color: rgb(250, 250, 250);"><span style="color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" style="color: rgb(127, 0, 85); font-weight: bold;">begin</span>&nbsp;&nbsp;</span></li><li style="font-size: 1em; margin-left: 38px; padding: 0px 0px 0px 10px; border-left-width: 1px; border-left-style: solid; border-left-color: rgb(209, 215, 220); line-height: 18px; background-color: rgb(250, 250, 250);"><span style="color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" style="color: rgb(127, 0, 85); font-weight: bold;">set</span>&nbsp;@result&nbsp;=&nbsp;@result+@CONFIG_CODE+<span class="string" style="color: blue;">','</span>&nbsp;&nbsp;</span></li><li style="font-size: 1em; margin-left: 38px; padding: 0px 0px 0px 10px; border-left-width: 1px; border-left-style: solid; border-left-color: rgb(209, 215, 220); line-height: 18px; background-color: rgb(250, 250, 250);"><span style="color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" style="color: rgb(127, 0, 85); font-weight: bold;">end</span>&nbsp;&nbsp;&nbsp;</span></li><li style="font-size: 1em; margin-left: 38px; padding: 0px 0px 0px 10px; border-left-width: 1px; border-left-style: solid; border-left-color: rgb(209, 215, 220); line-height: 18px; background-color: rgb(250, 250, 250);"><span style="color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" style="color: rgb(127, 0, 85); font-weight: bold;">else</span>&nbsp;if(@num=@countnum)&nbsp;&nbsp;&nbsp;</span></li><li style="font-size: 1em; margin-left: 38px; padding: 0px 0px 0px 10px; border-left-width: 1px; border-left-style: solid; border-left-color: rgb(209, 215, 220); line-height: 18px; background-color: rgb(250, 250, 250);"><span style="color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" style="color: rgb(127, 0, 85); font-weight: bold;">begin</span>&nbsp;&nbsp;</span></li><li style="font-size: 1em; margin-left: 38px; padding: 0px 0px 0px 10px; border-left-width: 1px; border-left-style: solid; border-left-color: rgb(209, 215, 220); line-height: 18px; background-color: rgb(250, 250, 250);"><span style="color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" style="color: rgb(127, 0, 85); font-weight: bold;">set</span>&nbsp;@result&nbsp;=&nbsp;@result&nbsp;+@CONFIG_CODE&nbsp;&nbsp;</span></li><li style="font-size: 1em; margin-left: 38px; padding: 0px 0px 0px 10px; border-left-width: 1px; border-left-style: solid; border-left-color: rgb(209, 215, 220); line-height: 18px; background-color: rgb(250, 250, 250);"><span style="color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" style="color: rgb(127, 0, 85); font-weight: bold;">end</span>&nbsp;&nbsp;&nbsp;</span></li><li style="font-size: 1em; margin-left: 38px; padding: 0px 0px 0px 10px; border-left-width: 1px; border-left-style: solid; border-left-color: rgb(209, 215, 220); line-height: 18px; background-color: rgb(250, 250, 250);"><span style="color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" style="color: rgb(127, 0, 85); font-weight: bold;">END</span>&nbsp;&nbsp;</span></li><li style="font-size: 1em; margin-left: 38px; padding: 0px 0px 0px 10px; border-left-width: 1px; border-left-style: solid; border-left-color: rgb(209, 215, 220); line-height: 18px; background-color: rgb(250, 250, 250);"><span style="color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" style="color: rgb(127, 0, 85); font-weight: bold;">CLOSE</span>&nbsp;MyCursor&nbsp;&nbsp;&nbsp;</span></li><li style="font-size: 1em; margin-left: 38px; padding: 0px 0px 0px 10px; border-left-width: 1px; border-left-style: solid; border-left-color: rgb(209, 215, 220); line-height: 18px; background-color: rgb(250, 250, 250);"><span style="color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" style="color: rgb(127, 0, 85); font-weight: bold;">DEALLOCATE</span>&nbsp;MyCursor&nbsp;&nbsp;&nbsp;</span></li><li style="font-size: 1em; margin-left: 38px; padding: 0px 0px 0px 10px; border-left-width: 1px; border-left-style: solid; border-left-color: rgb(209, 215, 220); line-height: 18px; background-color: rgb(250, 250, 250);"><span style="color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" style="color: rgb(127, 0, 85); font-weight: bold;">set</span>&nbsp;@result&nbsp;=&nbsp;<span class="string" style="color: blue;">'insert&nbsp;into&nbsp;'</span>&nbsp;+&nbsp;@ATTRIBUTE1&nbsp;+&nbsp;<span class="string" style="color: blue;">'('</span>&nbsp;+&nbsp;@result&nbsp;+<span class="string" style="color: blue;">')&nbsp;select&nbsp;'</span>+&nbsp;@result&nbsp;+<span class="string" style="color: blue;">'&nbsp;from&nbsp;'</span>+@CATEGORY_CI_TABLENAME&nbsp;+<span class="string" style="color: blue;">'&nbsp;where&nbsp;CI_ORDER_LINE_ID='</span>+@KEY_ID&nbsp;&nbsp;</span></li><li style="font-size: 1em; margin-left: 38px; padding: 0px 0px 0px 10px; border-left-width: 1px; border-left-style: solid; border-left-color: rgb(209, 215, 220); line-height: 18px; background-color: rgb(250, 250, 250);"><span style="color: black;">&nbsp;&nbsp;<span class="keyword" style="color: rgb(127, 0, 85); font-weight: bold;">end</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></li><li style="font-size: 1em; margin-left: 38px; padding: 0px 0px 0px 10px; border-left-width: 1px; border-left-style: solid; border-left-color: rgb(209, 215, 220); line-height: 18px; background-color: rgb(250, 250, 250);"><span style="color: black;">&nbsp;<span class="keyword" style="color: rgb(127, 0, 85); font-weight: bold;">else</span>&nbsp;if((@ATTRIBUTE2=<span class="string" style="color: blue;">'U'</span>))&nbsp;&nbsp;</span></li></ol></div><p style="padding: 0px; font-family: Helvetica, Tahoma, Arial, sans-serif; font-size: 14px; line-height: 25.2px; widows: 1; background-color: rgb(255, 255, 255);">&nbsp;</p><p style="padding: 0px; font-family: Helvetica, Tahoma, Arial, sans-serif; font-size: 14px; line-height: 25.2px; widows: 1; background-color: rgb(255, 255, 255);"><span style="color: rgb(128, 0, 128);"><strong><span style="font-size: 18px;">临时表：</span></strong></span></p><p style="padding: 0px; font-family: Helvetica, Tahoma, Arial, sans-serif; font-size: 14px; line-height: 25.2px; widows: 1; background-color: rgb(255, 255, 255);">--&nbsp;<strong>Select INTO 从一个查询的计算结果中<span style="color: rgb(128, 0, 128);">创建</span>一个新表</strong>。 数据并不返回给客户端，这一点和普通的Select 不同。 新表的字段具有和 Select 的输出字段相关联（相同）的名字和数据类型。<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; select * into NewTable<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; from Uname<br><br>-- Insert INTO ABC Select<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; --&nbsp;<strong><span style="color: rgb(128, 0, 128);">表ABC必须存在&nbsp;</span></strong><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; -- 把表Uname里面的字段Username复制到表ABC<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Insert INTO ABC Select Username FROM Uname<br><br>-- 创建临时表<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Create TABLE #temp(<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; UID int identity(1, 1) PRIMARY KEY,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; UserName varchar(16),<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Pwd varchar(50),<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Age smallint,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Sex varchar(6)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; )<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;<br>-- 打开临时表<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Select * from #temp</p><p style="padding: 0px; font-family: Helvetica, Tahoma, Arial, sans-serif; font-size: 14px; line-height: 25.2px; widows: 1; background-color: rgb(255, 255, 255);">&nbsp;</p><p style="padding: 0px; font-family: Helvetica, Tahoma, Arial, sans-serif; font-size: 14px; line-height: 25.2px; widows: 1; background-color: rgb(255, 255, 255);">&nbsp;1、局部临时表（#开头）只对当前连接有效，当前连接断开时自动删除。<br>2、全局临时表（##开头）对其它连接也有效，在当前连接和其他访问过它的连接都断开时自动删除。<br>3、不管局部临时表还是全局临时表，只要连接有访问权限，都可以用drop table #Tmp(或者drop table ##Tmp)来显式删除临时表。<br><br>临时表对执行效率应该影响不大，只要不是太过份，相反可以提高效率特别是连接查询的地方，只要你的数据库临时表空间足够<br>游标多，会严重执行效率，能免则免！</p><p style="padding: 0px; font-family: Helvetica, Tahoma, Arial, sans-serif; font-size: 14px; line-height: 25.2px; widows: 1; background-color: rgb(255, 255, 255);">&nbsp;</p><p style="padding: 0px; font-family: Helvetica, Tahoma, Arial, sans-serif; font-size: 14px; line-height: 25.2px; widows: 1; background-color: rgb(255, 255, 255);"><a href="http://javaeye-mao.iteye.com/blog/1511385" target="_blank" style="color: rgb(16, 138, 198);">临时表在不同数据库设计中的作用</a></p><p style="padding: 0px; font-family: Helvetica, Tahoma, Arial, sans-serif; font-size: 14px; line-height: 25.2px; widows: 1; background-color: rgb(255, 255, 255);"><a href="http://blog.csdn.net/mx1029/article/details/1680910" target="_blank" style="color: rgb(16, 138, 198);">SQLSERVER 存储过程 语法</a></p><p style="padding: 0px; font-family: Helvetica, Tahoma, Arial, sans-serif; font-size: 14px; line-height: 25.2px; widows: 1; background-color: rgb(255, 255, 255);">&nbsp;===============================================================================</p><p style="padding: 0px; font-family: Helvetica, Tahoma, Arial, sans-serif; font-size: 14px; line-height: 25.2px; widows: 1; background-color: rgb(255, 255, 255);">其他：</p><div class="blog_content" style="font-family: Helvetica, Tahoma, Arial, sans-serif; font-size: 14px; line-height: 25.2px; widows: 1; background-color: rgb(255, 255, 255);"><p style="padding: 0px;"><strong>--有输入参数的存储过程--</strong></p><p style="padding: 0px;">create proc GetComment</p><p style="padding: 0px;">(@commentid int)</p><p style="padding: 0px;">as</p><p style="padding: 0px;">select * from Comment where CommentID=@commentid</p><p style="padding: 0px;">&nbsp;</p><p style="padding: 0px;"><strong>--有输入与输出参数的存储过程--</strong></p><p style="padding: 0px;">create proc GetCommentCount</p><p style="padding: 0px;">@newsid int,</p><p style="padding: 0px;">@count int output</p><p style="padding: 0px;">as</p><p style="padding: 0px;">select @count=count(*) from Comment where NewsID=@newsid</p><p style="padding: 0px;">&nbsp;</p><p style="padding: 0px;">&nbsp;</p><p style="padding: 0px;"><strong>--返回单个值的函数--</strong></p><p style="padding: 0px;">create function MyFunction</p><p style="padding: 0px;">(@newsid int)</p><p style="padding: 0px;">returns int</p><p style="padding: 0px;">as</p><p style="padding: 0px;">begin</p><p style="padding: 0px;">declare @count int</p><p style="padding: 0px;">select @count=count(*) from Comment where NewsID=@newsid</p><p style="padding: 0px;">return @count</p><p style="padding: 0px;">end</p><p style="padding: 0px;">&nbsp;</p><p style="padding: 0px;"><strong>--调用方法--</strong></p><p style="padding: 0px;">declare @count int</p><p style="padding: 0px;">exec @count=MyFunction 2</p><p style="padding: 0px;">print @count</p><p style="padding: 0px;">&nbsp;</p><p style="padding: 0px;"><strong>--返回值为表的函数--</strong></p><p style="padding: 0px;">Create function GetFunctionTable</p><p style="padding: 0px;">(@newsid int)</p><p style="padding: 0px;">returns table</p><p style="padding: 0px;">as</p><p style="padding: 0px;">return</p><p style="padding: 0px;">(select * from Comment where NewsID=@newsid)</p><p style="padding: 0px;">&nbsp;</p><p style="padding: 0px;"><strong>--返回值为表的函数的调用--</strong></p><p style="padding: 0px;">select * from GetFunctionTable(2)</p><p style="padding: 0px;">&nbsp;</p><p style="padding: 0px;">&nbsp;</p><p style="padding: 0px;">-----------------------------------------------------------------------------------------------------------------------------------</p><h1 style="font-size: 2em; line-height: 1.5em; margin-top: 0px; margin-bottom: 0.5em;">SQLServer 存储过程中不拼接SQL字符串实现多条件查询</h1><p style="padding: 0px;">　以前拼接的写法<br>　　set @sql=' select * from table where 1=1 '<br>　　if (@addDate is not null)&nbsp;<br>　　 set @sql = @sql+' and addDate = '+ @addDate + ' '&nbsp;<br>　　if (@name &lt;&gt;'' and is not null)&nbsp;<br>　　 set @sql = @sql+ ' and name = ' + @name + ' '<br>　　exec(@sql)<br>下面是 不采用拼接SQL字符串实现多条件查询的解决方案<br>　　<strong>第一种写法是</strong>&nbsp;感觉代码有些冗余<br>　　if (@addDate is not null) and (@name &lt;&gt; '')&nbsp;<br>　　 select * from table where addDate = @addDate and name = @name&nbsp;<br>　　else if (@addDate is not null) and (@name ='')&nbsp;<br>　　 select * from table where addDate = @addDate&nbsp;<br>　　else if(@addDate is null) and (@name &lt;&gt; '')&nbsp;<br>　　 select * from table where and name = @name&nbsp;<br>　　else if(@addDate is null) and (@name = '')&nbsp;<br>　　select * from table&nbsp;<br>　　<strong>第二种写法是&nbsp;</strong><br>　　select * from table where (addDate = @addDate or @addDate is null) and (name = @name or @name = '')&nbsp;<br>　　<strong>第三种写法是</strong>&nbsp;<br>　　SELECT * FROM table where&nbsp;<br>　　addDate = CASE @addDate IS NULL THEN addDate ELSE @addDate END,&nbsp;<br>　　name = CASE @name WHEN '' THEN name ELSE @name END</p><p style="padding: 0px;">&nbsp;</p><p style="padding: 0px;">-----------------------------------------------------------------------------------------------------------------------------------</p><div>&nbsp;</div><p style="padding: 0px;"><span style="font-size: medium;">SQLSERVER存储过程基本语法</span></p><p style="padding: 0px;">&nbsp;</p><p style="padding: 0px;"><strong>一、定义变量</strong></p><div class="cnblogs_Highlighter"><div class="syntaxhighlighter nogutter  sql"><div class="lines"><div class="line alt1"><table border="0"><tbody><tr><td class="content" style="font-size: 1em;"><code class="sql comments" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">--简单赋值 </code></td></tr></tbody></table></div><div class="line alt2"><table border="0"><tbody><tr><td class="content" style="font-size: 1em;"><code class="sql keyword" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">declare</code>&nbsp;<code class="sql plain" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">@a </code>&nbsp;<code class="sql keyword" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">int</code></td></tr></tbody></table></div><div class="line alt1"><table border="0"><tbody><tr><td class="content" style="font-size: 1em;"><code class="sql keyword" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">set</code>&nbsp;<code class="sql plain" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">@a=5 </code></td></tr></tbody></table></div><div class="line alt2"><table border="0"><tbody><tr><td class="content" style="font-size: 1em;"><code class="sql plain" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">print @a </code></td></tr></tbody></table></div><div class="line alt1"><table border="0"><tbody><tr><td class="content" style="font-size: 1em;"><code class="spaces" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">&nbsp;</code>&nbsp;&nbsp;</td></tr></tbody></table></div><div class="line alt2"><table border="0"><tbody><tr><td class="content" style="font-size: 1em;"><code class="sql comments" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">--使用select语句赋值 </code></td></tr></tbody></table></div><div class="line alt1"><table border="0"><tbody><tr><td class="content" style="font-size: 1em;"><code class="sql keyword" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">declare</code>&nbsp;<code class="sql plain" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">@user1 nvarchar(50) </code></td></tr></tbody></table></div><div class="line alt2"><table border="0"><tbody><tr><td class="content" style="font-size: 1em;"><code class="sql keyword" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">select</code>&nbsp;<code class="sql plain" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">@user1=</code>&nbsp;<code class="sql string" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">'张三'</code></td></tr></tbody></table></div><div class="line alt1"><table border="0"><tbody><tr><td class="content" style="font-size: 1em;"><code class="sql plain" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">print @user1 </code></td></tr></tbody></table></div><div class="line alt2"><table border="0"><tbody><tr><td class="content" style="font-size: 1em;"><code class="sql keyword" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">declare</code>&nbsp;<code class="sql plain" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">@user2 nvarchar(50) </code></td></tr></tbody></table></div><div class="line alt1"><table border="0"><tbody><tr><td class="content" style="font-size: 1em;"><code class="sql keyword" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">select</code>&nbsp;<code class="sql plain" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">@user2 = </code>&nbsp;<code class="sql keyword" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">Name</code>&nbsp;<code class="sql keyword" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">from</code>&nbsp;<code class="sql plain" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">ST_User </code>&nbsp;<code class="sql keyword" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">where</code>&nbsp;<code class="sql plain" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">ID=1 </code></td></tr></tbody></table></div><div class="line alt2"><table border="0"><tbody><tr><td class="content" style="font-size: 1em;"><code class="sql plain" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">print @user2 </code></td></tr></tbody></table></div><div class="line alt1"><table border="0"><tbody><tr><td class="content" style="font-size: 1em;"><code class="spaces" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">&nbsp;</code>&nbsp;&nbsp;</td></tr></tbody></table></div><div class="line alt2"><table border="0"><tbody><tr><td class="content" style="font-size: 1em;"><code class="sql comments" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">--使用update语句赋值 </code></td></tr></tbody></table></div><div class="line alt1"><table border="0"><tbody><tr><td class="content" style="font-size: 1em;"><code class="sql keyword" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">declare</code>&nbsp;<code class="sql plain" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">@user3 nvarchar(50) </code></td></tr></tbody></table></div><div class="line alt2"><table border="0"><tbody><tr><td class="content" style="font-size: 1em;"><code class="sql keyword" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">update</code>&nbsp;<code class="sql plain" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">ST_User </code>&nbsp;<code class="sql keyword" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">set</code>&nbsp;<code class="sql plain" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">@user3 = </code>&nbsp;<code class="sql keyword" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">Name</code>&nbsp;<code class="sql keyword" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">where</code>&nbsp;<code class="sql plain" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">ID=1 </code></td></tr></tbody></table></div><div class="line alt1"><table border="0"><tbody><tr><td class="content" style="font-size: 1em;"><code class="sql plain" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">print @user3</code></td></tr></tbody></table></div></div></div></div><p style="padding: 0px;"><strong>&nbsp;</strong></p><p style="padding: 0px;"><strong>二、表、临时表、表变量</strong></p><div class="cnblogs_Highlighter"><div class="syntaxhighlighter nogutter  sql"><div class="lines"><div class="line alt1"><table border="0"><tbody><tr><td class="content" style="font-size: 1em;"><code class="sql comments" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">--创建临时表1 </code></td></tr></tbody></table></div><div class="line alt2"><table border="0"><tbody><tr><td class="content" style="font-size: 1em;"><code class="sql keyword" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">create</code>&nbsp;<code class="sql keyword" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">table</code>&nbsp;<code class="sql plain" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">#DU_User1 </code></td></tr></tbody></table></div><div class="line alt1"><table border="0"><tbody><tr><td class="content" style="font-size: 1em;"><code class="sql plain" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">( </code></td></tr></tbody></table></div><div class="line alt2"><table border="0"><tbody><tr><td class="content" style="font-size: 1em;"><code class="spaces" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code>&nbsp;<code class="sql plain" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">[ID] [</code>&nbsp;<code class="sql keyword" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">int</code>&nbsp;<code class="sql plain" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">]&nbsp; </code>&nbsp;<code class="sql color1" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">NOT</code>&nbsp;<code class="sql color1" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">NULL</code>&nbsp;<code class="sql plain" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">, </code></td></tr></tbody></table></div><div class="line alt1"><table border="0"><tbody><tr><td class="content" style="font-size: 1em;"><code class="spaces" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code>&nbsp;<code class="sql plain" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">[Oid] [</code>&nbsp;<code class="sql keyword" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">int</code>&nbsp;<code class="sql plain" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">] </code>&nbsp;<code class="sql color1" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">NOT</code>&nbsp;<code class="sql color1" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">NULL</code>&nbsp;<code class="sql plain" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">, </code></td></tr></tbody></table></div><div class="line alt2"><table border="0"><tbody><tr><td class="content" style="font-size: 1em;"><code class="spaces" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code>&nbsp;<code class="sql plain" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">[Login] [nvarchar](50) </code>&nbsp;<code class="sql color1" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">NOT</code>&nbsp;<code class="sql color1" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">NULL</code>&nbsp;<code class="sql plain" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">, </code></td></tr></tbody></table></div><div class="line alt1"><table border="0"><tbody><tr><td class="content" style="font-size: 1em;"><code class="spaces" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code>&nbsp;<code class="sql plain" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">[Rtx] [nvarchar](4) </code>&nbsp;<code class="sql color1" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">NOT</code>&nbsp;<code class="sql color1" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">NULL</code>&nbsp;<code class="sql plain" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">, </code></td></tr></tbody></table></div><div class="line alt2"><table border="0"><tbody><tr><td class="content" style="font-size: 1em;"><code class="spaces" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code>&nbsp;<code class="sql plain" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">[</code>&nbsp;<code class="sql keyword" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">Name</code>&nbsp;<code class="sql plain" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">] [nvarchar](5) </code>&nbsp;<code class="sql color1" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">NOT</code>&nbsp;<code class="sql color1" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">NULL</code>&nbsp;<code class="sql plain" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">, </code></td></tr></tbody></table></div><div class="line alt1"><table border="0"><tbody><tr><td class="content" style="font-size: 1em;"><code class="spaces" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code>&nbsp;<code class="sql plain" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">[</code>&nbsp;<code class="sql keyword" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">Password</code>&nbsp;<code class="sql plain" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">] [nvarchar](</code>&nbsp;<code class="sql keyword" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">max</code>&nbsp;<code class="sql plain" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">) </code>&nbsp;<code class="sql color1" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">NULL</code>&nbsp;<code class="sql plain" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">, </code></td></tr></tbody></table></div><div class="line alt2"><table border="0"><tbody><tr><td class="content" style="font-size: 1em;"><code class="spaces" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code>&nbsp;<code class="sql plain" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">[State] [nvarchar](8) </code>&nbsp;<code class="sql color1" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">NOT</code>&nbsp;<code class="sql color1" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">NULL</code></td></tr></tbody></table></div><div class="line alt1"><table border="0"><tbody><tr><td class="content" style="font-size: 1em;"><code class="sql plain" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">); </code></td></tr></tbody></table></div><div class="line alt2"><table border="0"><tbody><tr><td class="content" style="font-size: 1em;"><code class="sql comments" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">--向临时表1插入一条记录 </code></td></tr></tbody></table></div><div class="line alt1"><table border="0"><tbody><tr><td class="content" style="font-size: 1em;"><code class="sql keyword" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">insert</code>&nbsp;<code class="sql keyword" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">into</code>&nbsp;<code class="sql plain" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">#DU_User1 (ID,Oid,[Login],Rtx,</code>&nbsp;<code class="sql keyword" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">Name</code>&nbsp;<code class="sql plain" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">,[</code>&nbsp;<code class="sql keyword" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">Password</code>&nbsp;<code class="sql plain" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">],State) </code>&nbsp;<code class="sql keyword" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">values</code>&nbsp;<code class="sql plain" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">(100,2,</code>&nbsp;<code class="sql string" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">'LS'</code>&nbsp;<code class="sql plain" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">,</code><code class="sql string" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">'0000'</code>&nbsp;<code class="sql plain" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">,</code>&nbsp;<code class="sql string" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">'临时'</code>&nbsp;<code class="sql plain" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">,</code>&nbsp;<code class="sql string" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">'321'</code>&nbsp;<code class="sql plain" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">,</code>&nbsp;<code class="sql string" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">'特殊'</code>&nbsp;<code class="sql plain" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">); </code></td></tr></tbody></table></div><div class="line alt2"><table border="0"><tbody><tr><td class="content" style="font-size: 1em;"><code class="spaces" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">&nbsp;</code>&nbsp;&nbsp;</td></tr></tbody></table></div><div class="line alt1"><table border="0"><tbody><tr><td class="content" style="font-size: 1em;"><code class="sql comments" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">--从ST_User查询数据，填充至新生成的临时表 </code></td></tr></tbody></table></div><div class="line alt2"><table border="0"><tbody><tr><td class="content" style="font-size: 1em;"><code class="sql keyword" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">select</code>&nbsp;<code class="sql plain" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">* </code>&nbsp;<code class="sql keyword" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">into</code>&nbsp;<code class="sql plain" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">#DU_User2 </code>&nbsp;<code class="sql keyword" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">from</code>&nbsp;<code class="sql plain" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">ST_User </code>&nbsp;<code class="sql keyword" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">where</code>&nbsp;<code class="sql plain" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">ID&lt;8 </code></td></tr></tbody></table></div><div class="line alt1"><table border="0"><tbody><tr><td class="content" style="font-size: 1em;"><code class="spaces" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">&nbsp;</code>&nbsp;&nbsp;</td></tr></tbody></table></div><div class="line alt2"><table border="0"><tbody><tr><td class="content" style="font-size: 1em;"><code class="sql comments" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">--查询并联合两临时表 </code></td></tr></tbody></table></div><div class="line alt1"><table border="0"><tbody><tr><td class="content" style="font-size: 1em;"><code class="sql keyword" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">select</code>&nbsp;<code class="sql plain" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">* </code>&nbsp;<code class="sql keyword" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">from</code>&nbsp;<code class="sql plain" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">#DU_User2 </code>&nbsp;<code class="sql keyword" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">where</code>&nbsp;<code class="sql plain" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">ID&lt;3 </code>&nbsp;<code class="sql keyword" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">union</code>&nbsp;<code class="sql keyword" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">select</code>&nbsp;<code class="sql plain" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">* </code>&nbsp;<code class="sql keyword" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">from</code>&nbsp;<code class="sql plain" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">#DU_User1 </code></td></tr></tbody></table></div><div class="line alt2"><table border="0"><tbody><tr><td class="content" style="font-size: 1em;"><code class="spaces" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">&nbsp;</code>&nbsp;&nbsp;</td></tr></tbody></table></div><div class="line alt1"><table border="0"><tbody><tr><td class="content" style="font-size: 1em;"><code class="sql comments" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">--删除两临时表 </code></td></tr></tbody></table></div><div class="line alt2"><table border="0"><tbody><tr><td class="content" style="font-size: 1em;"><code class="sql keyword" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">drop</code>&nbsp;<code class="sql keyword" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">table</code>&nbsp;<code class="sql plain" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">#DU_User1 </code></td></tr></tbody></table></div><div class="line alt1"><table border="0"><tbody><tr><td class="content" style="font-size: 1em;"><code class="sql keyword" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">drop</code>&nbsp;<code class="sql keyword" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">table</code>&nbsp;<code class="sql plain" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">#DU_User2</code></td></tr></tbody></table></div></div></div></div><div class="cnblogs_Highlighter">&nbsp;</div><div class="cnblogs_Highlighter"><div class="syntaxhighlighter nogutter  sql"><div class="lines"><div class="line alt1"><table border="0"><tbody><tr><td class="content" style="font-size: 1em;"><code class="sql comments" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">--创建临时表 </code></td></tr></tbody></table></div><div class="line alt2"><table border="0"><tbody><tr><td class="content" style="font-size: 1em;"><code class="sql keyword" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">CREATE</code>&nbsp;<code class="sql keyword" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">TABLE</code>&nbsp;<code class="sql plain" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">#t </code></td></tr></tbody></table></div><div class="line alt1"><table border="0"><tbody><tr><td class="content" style="font-size: 1em;"><code class="sql plain" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">( </code></td></tr></tbody></table></div><div class="line alt2"><table border="0"><tbody><tr><td class="content" style="font-size: 1em;"><code class="spaces" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">&nbsp;&nbsp;&nbsp;&nbsp;</code>&nbsp;<code class="sql plain" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">[ID] [</code>&nbsp;<code class="sql keyword" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">int</code>&nbsp;<code class="sql plain" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">] </code>&nbsp;<code class="sql color1" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">NOT</code>&nbsp;<code class="sql color1" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">NULL</code>&nbsp;<code class="sql plain" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">, </code></td></tr></tbody></table></div><div class="line alt1"><table border="0"><tbody><tr><td class="content" style="font-size: 1em;"><code class="spaces" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">&nbsp;&nbsp;&nbsp;&nbsp;</code>&nbsp;<code class="sql plain" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">[Oid] [</code>&nbsp;<code class="sql keyword" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">int</code>&nbsp;<code class="sql plain" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">] </code>&nbsp;<code class="sql color1" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">NOT</code>&nbsp;<code class="sql color1" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">NULL</code>&nbsp;<code class="sql plain" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">, </code></td></tr></tbody></table></div><div class="line alt2"><table border="0"><tbody><tr><td class="content" style="font-size: 1em;"><code class="spaces" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">&nbsp;&nbsp;&nbsp;&nbsp;</code>&nbsp;<code class="sql plain" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">[Login] [nvarchar](50) </code>&nbsp;<code class="sql color1" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">NOT</code>&nbsp;<code class="sql color1" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">NULL</code>&nbsp;<code class="sql plain" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">, </code></td></tr></tbody></table></div><div class="line alt1"><table border="0"><tbody><tr><td class="content" style="font-size: 1em;"><code class="spaces" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">&nbsp;&nbsp;&nbsp;&nbsp;</code>&nbsp;<code class="sql plain" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">[Rtx] [nvarchar](4) </code>&nbsp;<code class="sql color1" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">NOT</code>&nbsp;<code class="sql color1" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">NULL</code>&nbsp;<code class="sql plain" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">, </code></td></tr></tbody></table></div><div class="line alt2"><table border="0"><tbody><tr><td class="content" style="font-size: 1em;"><code class="spaces" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">&nbsp;&nbsp;&nbsp;&nbsp;</code>&nbsp;<code class="sql plain" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">[</code>&nbsp;<code class="sql keyword" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">Name</code>&nbsp;<code class="sql plain" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">] [nvarchar](5) </code>&nbsp;<code class="sql color1" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">NOT</code>&nbsp;<code class="sql color1" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">NULL</code>&nbsp;<code class="sql plain" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">, </code></td></tr></tbody></table></div><div class="line alt1"><table border="0"><tbody><tr><td class="content" style="font-size: 1em;"><code class="spaces" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">&nbsp;&nbsp;&nbsp;&nbsp;</code>&nbsp;<code class="sql plain" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">[</code>&nbsp;<code class="sql keyword" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">Password</code>&nbsp;<code class="sql plain" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">] [nvarchar](</code>&nbsp;<code class="sql keyword" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">max</code>&nbsp;<code class="sql plain" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">) </code>&nbsp;<code class="sql color1" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">NULL</code>&nbsp;<code class="sql plain" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">, </code></td></tr></tbody></table></div><div class="line alt2"><table border="0"><tbody><tr><td class="content" style="font-size: 1em;"><code class="spaces" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">&nbsp;&nbsp;&nbsp;&nbsp;</code>&nbsp;<code class="sql plain" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">[State] [nvarchar](8) </code>&nbsp;<code class="sql color1" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">NOT</code>&nbsp;<code class="sql color1" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">NULL</code>&nbsp;<code class="sql plain" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">, </code></td></tr></tbody></table></div><div class="line alt1"><table border="0"><tbody><tr><td class="content" style="font-size: 1em;"><code class="sql plain" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">) </code></td></tr></tbody></table></div><div class="line alt2"><table border="0"><tbody><tr><td class="content" style="font-size: 1em;"><code class="spaces" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">&nbsp;</code>&nbsp;&nbsp;</td></tr></tbody></table></div><div class="line alt1"><table border="0"><tbody><tr><td class="content" style="font-size: 1em;"><code class="sql comments" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">--将查询结果集（多条数据）插入临时表 </code></td></tr></tbody></table></div><div class="line alt2"><table border="0"><tbody><tr><td class="content" style="font-size: 1em;"><code class="sql keyword" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">insert</code>&nbsp;<code class="sql keyword" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">into</code>&nbsp;<code class="sql plain" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">#t </code>&nbsp;<code class="sql keyword" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">select</code>&nbsp;<code class="sql plain" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">* </code>&nbsp;<code class="sql keyword" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">from</code>&nbsp;<code class="sql plain" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">ST_User </code></td></tr></tbody></table></div><div class="line alt1"><table border="0"><tbody><tr><td class="content" style="font-size: 1em;"><code class="sql comments" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">--不能这样插入 </code></td></tr></tbody></table></div><div class="line alt2"><table border="0"><tbody><tr><td class="content" style="font-size: 1em;"><code class="sql comments" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">--select * into #t from dbo.ST_User </code></td></tr></tbody></table></div><div class="line alt1"><table border="0"><tbody><tr><td class="content" style="font-size: 1em;"><code class="spaces" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">&nbsp;</code>&nbsp;&nbsp;</td></tr></tbody></table></div><div class="line alt2"><table border="0"><tbody><tr><td class="content" style="font-size: 1em;"><code class="sql comments" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">--添加一列，为int型自增长子段 </code></td></tr></tbody></table></div><div class="line alt1"><table border="0"><tbody><tr><td class="content" style="font-size: 1em;"><code class="sql keyword" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">alter</code>&nbsp;<code class="sql keyword" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">table</code>&nbsp;<code class="sql plain" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">#t </code>&nbsp;<code class="sql keyword" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">add</code>&nbsp;<code class="sql plain" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">[myid] </code>&nbsp;<code class="sql keyword" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">int</code>&nbsp;<code class="sql color1" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">NOT</code>&nbsp;<code class="sql color1" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">NULL</code>&nbsp;<code class="sql plain" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">IDENTITY(1,1) </code></td></tr></tbody></table></div><div class="line alt2"><table border="0"><tbody><tr><td class="content" style="font-size: 1em;"><code class="sql comments" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">--添加一列，默认填充全球唯一标识 </code></td></tr></tbody></table></div><div class="line alt1"><table border="0"><tbody><tr><td class="content" style="font-size: 1em;"><code class="sql keyword" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">alter</code>&nbsp;<code class="sql keyword" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">table</code>&nbsp;<code class="sql plain" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">#t </code>&nbsp;<code class="sql keyword" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">add</code>&nbsp;<code class="sql plain" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">[myid1] uniqueidentifier </code>&nbsp;<code class="sql color1" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">NOT</code>&nbsp;<code class="sql color1" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">NULL</code>&nbsp;<code class="sql keyword" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">default</code>&nbsp;<code class="sql plain" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">(newid()) </code></td></tr></tbody></table></div><div class="line alt2"><table border="0"><tbody><tr><td class="content" style="font-size: 1em;"><code class="spaces" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">&nbsp;</code>&nbsp;&nbsp;</td></tr></tbody></table></div><div class="line alt1"><table border="0"><tbody><tr><td class="content" style="font-size: 1em;"><code class="sql keyword" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">select</code>&nbsp;<code class="sql plain" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">* </code>&nbsp;<code class="sql keyword" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">from</code>&nbsp;<code class="sql plain" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">#t </code></td></tr></tbody></table></div><div class="line alt2"><table border="0"><tbody><tr><td class="content" style="font-size: 1em;"><code class="sql keyword" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">drop</code>&nbsp;<code class="sql keyword" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">table</code>&nbsp;<code class="sql plain" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">#t</code></td></tr></tbody></table></div></div></div></div><div class="cnblogs_Highlighter"><div class="syntaxhighlighter nogutter  sql"><div class="lines"><div class="line alt1"><table border="0"><tbody><tr><td class="content" style="font-size: 1em;"><code class="sql comments" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">--给查询结果集增加自增长列 </code></td></tr></tbody></table></div><div class="line alt2"><table border="0"><tbody><tr><td class="content" style="font-size: 1em;"><code class="spaces" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">&nbsp;</code>&nbsp;&nbsp;</td></tr></tbody></table></div><div class="line alt1"><table border="0"><tbody><tr><td class="content" style="font-size: 1em;"><code class="sql comments" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">--无主键时： </code></td></tr></tbody></table></div><div class="line alt2"><table border="0"><tbody><tr><td class="content" style="font-size: 1em;"><code class="sql keyword" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">select</code>&nbsp;<code class="sql plain" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">IDENTITY(</code>&nbsp;<code class="sql keyword" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">int</code>&nbsp;<code class="sql plain" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">,1,1)</code>&nbsp;<code class="sql keyword" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">as</code>&nbsp;<code class="sql plain" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">ID, </code>&nbsp;<code class="sql keyword" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">Name</code>&nbsp;<code class="sql plain" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">,[Login],[</code>&nbsp;<code class="sql keyword" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">Password</code>&nbsp;<code class="sql plain" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">] </code>&nbsp;<code class="sql keyword" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">into</code>&nbsp;<code class="sql plain" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">#t </code>&nbsp;<code class="sql keyword" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">from</code>&nbsp;<code class="sql plain" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">ST_User </code></td></tr></tbody></table></div><div class="line alt1"><table border="0"><tbody><tr><td class="content" style="font-size: 1em;"><code class="sql keyword" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">select</code>&nbsp;<code class="sql plain" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">* </code>&nbsp;<code class="sql keyword" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">from</code>&nbsp;<code class="sql plain" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">#t </code></td></tr></tbody></table></div><div class="line alt2"><table border="0"><tbody><tr><td class="content" style="font-size: 1em;"><code class="spaces" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">&nbsp;</code>&nbsp;&nbsp;</td></tr></tbody></table></div><div class="line alt1"><table border="0"><tbody><tr><td class="content" style="font-size: 1em;"><code class="sql comments" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">--有主键时： </code></td></tr></tbody></table></div><div class="line alt2"><table border="0"><tbody><tr><td class="content" style="font-size: 1em;"><code class="sql keyword" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">select</code>&nbsp;<code class="sql plain" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">(</code>&nbsp;<code class="sql keyword" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">select</code>&nbsp;<code class="sql color2" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">SUM</code>&nbsp;<code class="sql plain" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">(1) </code>&nbsp;<code class="sql keyword" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">from</code>&nbsp;<code class="sql plain" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">ST_User </code>&nbsp;<code class="sql keyword" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">where</code>&nbsp;<code class="sql plain" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">ID&lt;= a.ID) </code>&nbsp;<code class="sql keyword" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">as</code>&nbsp;<code class="sql plain" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">myID,* </code>&nbsp;<code class="sql keyword" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">from</code>&nbsp;<code class="sql plain" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">ST_User a </code>&nbsp;<code class="sql keyword" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">order</code>&nbsp;<code class="sql keyword" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">by</code><code class="sql plain" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">myID</code></td></tr></tbody></table></div></div></div></div><div class="cnblogs_Highlighter"><div class="syntaxhighlighter nogutter  sql"><div class="lines"><div class="line alt1"><table border="0"><tbody><tr><td class="content" style="font-size: 1em;"><code class="sql comments" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">--定义表变量 </code></td></tr></tbody></table></div><div class="line alt2"><table border="0"><tbody><tr><td class="content" style="font-size: 1em;"><code class="sql keyword" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">declare</code>&nbsp;<code class="sql plain" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">@t </code>&nbsp;<code class="sql keyword" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">table</code></td></tr></tbody></table></div><div class="line alt1"><table border="0"><tbody><tr><td class="content" style="font-size: 1em;"><code class="sql plain" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">( </code></td></tr></tbody></table></div><div class="line alt2"><table border="0"><tbody><tr><td class="content" style="font-size: 1em;"><code class="spaces" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">&nbsp;&nbsp;&nbsp;&nbsp;</code>&nbsp;<code class="sql plain" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">id </code>&nbsp;<code class="sql keyword" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">int</code>&nbsp;<code class="sql color1" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">not</code>&nbsp;<code class="sql color1" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">null</code>&nbsp;<code class="sql plain" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">, </code></td></tr></tbody></table></div><div class="line alt1"><table border="0"><tbody><tr><td class="content" style="font-size: 1em;"><code class="spaces" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">&nbsp;&nbsp;&nbsp;&nbsp;</code>&nbsp;<code class="sql plain" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">msg nvarchar(50) </code>&nbsp;<code class="sql color1" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">null</code></td></tr></tbody></table></div><div class="line alt2"><table border="0"><tbody><tr><td class="content" style="font-size: 1em;"><code class="sql plain" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">) </code></td></tr></tbody></table></div><div class="line alt1"><table border="0"><tbody><tr><td class="content" style="font-size: 1em;"><code class="sql keyword" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">insert</code>&nbsp;<code class="sql keyword" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">into</code>&nbsp;<code class="sql plain" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">@t </code>&nbsp;<code class="sql keyword" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">values</code>&nbsp;<code class="sql plain" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">(1,</code>&nbsp;<code class="sql string" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">'1'</code>&nbsp;<code class="sql plain" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">) </code></td></tr></tbody></table></div><div class="line alt2"><table border="0"><tbody><tr><td class="content" style="font-size: 1em;"><code class="sql keyword" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">insert</code>&nbsp;<code class="sql keyword" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">into</code>&nbsp;<code class="sql plain" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">@t </code>&nbsp;<code class="sql keyword" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">values</code>&nbsp;<code class="sql plain" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">(2,</code>&nbsp;<code class="sql string" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">'2'</code>&nbsp;<code class="sql plain" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">) </code></td></tr></tbody></table></div><div class="line alt1"><table border="0"><tbody><tr><td class="content" style="font-size: 1em;"><code class="sql keyword" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">select</code>&nbsp;<code class="sql plain" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">* </code>&nbsp;<code class="sql keyword" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">from</code>&nbsp;<code class="sql plain" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">@t</code></td></tr></tbody></table></div></div></div></div><p style="padding: 0px;"><strong>&nbsp;三、循环</strong></p><div class="cnblogs_Highlighter"><div class="syntaxhighlighter nogutter  sql"><div class="lines"><div class="line alt1"><table border="0"><tbody><tr><td class="content" style="font-size: 1em;"><code class="sql comments" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">--while循环计算1到100的和 </code></td></tr></tbody></table></div><div class="line alt2"><table border="0"><tbody><tr><td class="content" style="font-size: 1em;"><code class="sql keyword" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">declare</code>&nbsp;<code class="sql plain" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">@a </code>&nbsp;<code class="sql keyword" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">int</code></td></tr></tbody></table></div><div class="line alt1"><table border="0"><tbody><tr><td class="content" style="font-size: 1em;"><code class="sql keyword" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">declare</code>&nbsp;<code class="sql plain" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">@</code>&nbsp;<code class="sql color2" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">sum</code>&nbsp;<code class="sql keyword" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">int</code></td></tr></tbody></table></div><div class="line alt2"><table border="0"><tbody><tr><td class="content" style="font-size: 1em;"><code class="sql keyword" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">set</code>&nbsp;<code class="sql plain" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">@a=1 </code></td></tr></tbody></table></div><div class="line alt1"><table border="0"><tbody><tr><td class="content" style="font-size: 1em;"><code class="sql keyword" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">set</code>&nbsp;<code class="sql plain" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">@</code>&nbsp;<code class="sql color2" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">sum</code>&nbsp;<code class="sql plain" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">=0 </code></td></tr></tbody></table></div><div class="line alt2"><table border="0"><tbody><tr><td class="content" style="font-size: 1em;"><code class="sql plain" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">while @a&lt;=100 </code></td></tr></tbody></table></div><div class="line alt1"><table border="0"><tbody><tr><td class="content" style="font-size: 1em;"><code class="sql keyword" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">begin</code></td></tr></tbody></table></div><div class="line alt2"><table border="0"><tbody><tr><td class="content" style="font-size: 1em;"><code class="spaces" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">&nbsp;&nbsp;&nbsp;&nbsp;</code>&nbsp;<code class="sql keyword" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">set</code>&nbsp;<code class="sql plain" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">@</code>&nbsp;<code class="sql color2" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">sum</code>&nbsp;<code class="sql plain" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">+=@a </code></td></tr></tbody></table></div><div class="line alt1"><table border="0"><tbody><tr><td class="content" style="font-size: 1em;"><code class="spaces" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">&nbsp;&nbsp;&nbsp;&nbsp;</code>&nbsp;<code class="sql keyword" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">set</code>&nbsp;<code class="sql plain" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">@a+=1 </code></td></tr></tbody></table></div><div class="line alt2"><table border="0"><tbody><tr><td class="content" style="font-size: 1em;"><code class="sql keyword" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">end</code></td></tr></tbody></table></div><div class="line alt1"><table border="0"><tbody><tr><td class="content" style="font-size: 1em;"><code class="sql plain" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">print @</code>&nbsp;<code class="sql color2" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">sum</code></td></tr></tbody></table></div></div></div></div><p style="padding: 0px;"><strong>四、条件语句</strong></p><div class="cnblogs_Highlighter"><div class="syntaxhighlighter nogutter  sql"><div class="lines"><div class="line alt1"><table border="0"><tbody><tr><td class="content" style="font-size: 1em;"><code class="sql comments" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">--if,else条件分支 </code></td></tr></tbody></table></div><div class="line alt2"><table border="0"><tbody><tr><td class="content" style="font-size: 1em;"><code class="sql plain" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">if(1+1=2) </code></td></tr></tbody></table></div><div class="line alt1"><table border="0"><tbody><tr><td class="content" style="font-size: 1em;"><code class="sql keyword" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">begin</code></td></tr></tbody></table></div><div class="line alt2"><table border="0"><tbody><tr><td class="content" style="font-size: 1em;"><code class="spaces" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">&nbsp;&nbsp;&nbsp;&nbsp;</code>&nbsp;<code class="sql plain" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">print </code>&nbsp;<code class="sql string" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">'对'</code></td></tr></tbody></table></div><div class="line alt1"><table border="0"><tbody><tr><td class="content" style="font-size: 1em;"><code class="sql keyword" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">end</code></td></tr></tbody></table></div><div class="line alt2"><table border="0"><tbody><tr><td class="content" style="font-size: 1em;"><code class="sql keyword" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">else</code></td></tr></tbody></table></div><div class="line alt1"><table border="0"><tbody><tr><td class="content" style="font-size: 1em;"><code class="sql keyword" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">begin</code></td></tr></tbody></table></div><div class="line alt2"><table border="0"><tbody><tr><td class="content" style="font-size: 1em;"><code class="spaces" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">&nbsp;&nbsp;&nbsp;&nbsp;</code>&nbsp;<code class="sql plain" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">print </code>&nbsp;<code class="sql string" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">'错'</code></td></tr></tbody></table></div><div class="line alt1"><table border="0"><tbody><tr><td class="content" style="font-size: 1em;"><code class="sql keyword" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">end</code></td></tr></tbody></table></div><div class="line alt2"><table border="0"><tbody><tr><td class="content" style="font-size: 1em;"><code class="spaces" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">&nbsp;</code>&nbsp;&nbsp;</td></tr></tbody></table></div><div class="line alt1"><table border="0"><tbody><tr><td class="content" style="font-size: 1em;"><code class="sql comments" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">--when then条件分支 </code></td></tr></tbody></table></div><div class="line alt2"><table border="0"><tbody><tr><td class="content" style="font-size: 1em;"><code class="sql keyword" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">declare</code>&nbsp;<code class="sql plain" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">@today </code>&nbsp;<code class="sql keyword" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">int</code></td></tr></tbody></table></div><div class="line alt1"><table border="0"><tbody><tr><td class="content" style="font-size: 1em;"><code class="sql keyword" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">declare</code>&nbsp;<code class="sql plain" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">@week nvarchar(3) </code></td></tr></tbody></table></div><div class="line alt2"><table border="0"><tbody><tr><td class="content" style="font-size: 1em;"><code class="sql keyword" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">set</code>&nbsp;<code class="sql plain" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">@today=3 </code></td></tr></tbody></table></div><div class="line alt1"><table border="0"><tbody><tr><td class="content" style="font-size: 1em;"><code class="sql keyword" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">set</code>&nbsp;<code class="sql plain" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">@week=</code>&nbsp;<code class="sql color2" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">case</code></td></tr></tbody></table></div><div class="line alt2"><table border="0"><tbody><tr><td class="content" style="font-size: 1em;"><code class="spaces" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">&nbsp;&nbsp;&nbsp;&nbsp;</code>&nbsp;<code class="sql keyword" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">when</code>&nbsp;<code class="sql plain" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">@today=1 </code>&nbsp;<code class="sql keyword" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">then</code>&nbsp;<code class="sql string" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">'星期一'</code></td></tr></tbody></table></div><div class="line alt1"><table border="0"><tbody><tr><td class="content" style="font-size: 1em;"><code class="spaces" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">&nbsp;&nbsp;&nbsp;&nbsp;</code>&nbsp;<code class="sql keyword" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">when</code>&nbsp;<code class="sql plain" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">@today=2 </code>&nbsp;<code class="sql keyword" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">then</code>&nbsp;<code class="sql string" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">'星期二'</code></td></tr></tbody></table></div><div class="line alt2"><table border="0"><tbody><tr><td class="content" style="font-size: 1em;"><code class="spaces" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">&nbsp;&nbsp;&nbsp;&nbsp;</code>&nbsp;<code class="sql keyword" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">when</code>&nbsp;<code class="sql plain" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">@today=3 </code>&nbsp;<code class="sql keyword" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">then</code>&nbsp;<code class="sql string" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">'星期三'</code></td></tr></tbody></table></div><div class="line alt1"><table border="0"><tbody><tr><td class="content" style="font-size: 1em;"><code class="spaces" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">&nbsp;&nbsp;&nbsp;&nbsp;</code>&nbsp;<code class="sql keyword" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">when</code>&nbsp;<code class="sql plain" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">@today=4 </code>&nbsp;<code class="sql keyword" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">then</code>&nbsp;<code class="sql string" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">'星期四'</code></td></tr></tbody></table></div><div class="line alt2"><table border="0"><tbody><tr><td class="content" style="font-size: 1em;"><code class="spaces" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">&nbsp;&nbsp;&nbsp;&nbsp;</code>&nbsp;<code class="sql keyword" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">when</code>&nbsp;<code class="sql plain" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">@today=5 </code>&nbsp;<code class="sql keyword" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">then</code>&nbsp;<code class="sql string" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">'星期五'</code></td></tr></tbody></table></div><div class="line alt1"><table border="0"><tbody><tr><td class="content" style="font-size: 1em;"><code class="spaces" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">&nbsp;&nbsp;&nbsp;&nbsp;</code>&nbsp;<code class="sql keyword" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">when</code>&nbsp;<code class="sql plain" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">@today=6 </code>&nbsp;<code class="sql keyword" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">then</code>&nbsp;<code class="sql string" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">'星期六'</code></td></tr></tbody></table></div><div class="line alt2"><table border="0"><tbody><tr><td class="content" style="font-size: 1em;"><code class="spaces" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">&nbsp;&nbsp;&nbsp;&nbsp;</code>&nbsp;<code class="sql keyword" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">when</code>&nbsp;<code class="sql plain" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">@today=7 </code>&nbsp;<code class="sql keyword" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">then</code>&nbsp;<code class="sql string" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">'星期日'</code></td></tr></tbody></table></div><div class="line alt1"><table border="0"><tbody><tr><td class="content" style="font-size: 1em;"><code class="spaces" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">&nbsp;&nbsp;&nbsp;&nbsp;</code>&nbsp;<code class="sql keyword" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">else</code>&nbsp;<code class="sql string" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">'值错误'</code></td></tr></tbody></table></div><div class="line alt2"><table border="0"><tbody><tr><td class="content" style="font-size: 1em;"><code class="sql keyword" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">end</code></td></tr></tbody></table></div><div class="line alt1"><table border="0"><tbody><tr><td class="content" style="font-size: 1em;"><code class="sql plain" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">print @week</code></td></tr></tbody></table></div></div></div></div><p style="padding: 0px;"><strong>&nbsp;</strong></p><p style="padding: 0px;"><strong>五、游标</strong></p><div class="cnblogs_Highlighter"><div class="syntaxhighlighter nogutter  sql"><div class="lines"><div class="line alt1"><table border="0"><tbody><tr><td class="content" style="font-size: 1em;"><code class="sql keyword" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">declare</code>&nbsp;<code class="sql plain" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">@ID </code>&nbsp;<code class="sql keyword" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">int</code></td></tr></tbody></table></div><div class="line alt2"><table border="0"><tbody><tr><td class="content" style="font-size: 1em;"><code class="sql keyword" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">declare</code>&nbsp;<code class="sql plain" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">@Oid </code>&nbsp;<code class="sql keyword" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">int</code></td></tr></tbody></table></div><div class="line alt1"><table border="0"><tbody><tr><td class="content" style="font-size: 1em;"><code class="sql keyword" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">declare</code>&nbsp;<code class="sql plain" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">@Login </code>&nbsp;<code class="sql keyword" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">varchar</code>&nbsp;<code class="sql plain" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">(50) </code></td></tr></tbody></table></div><div class="line alt2"><table border="0"><tbody><tr><td class="content" style="font-size: 1em;"><code class="spaces" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">&nbsp;</code>&nbsp;&nbsp;</td></tr></tbody></table></div><div class="line alt1"><table border="0"><tbody><tr><td class="content" style="font-size: 1em;"><code class="sql comments" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">--定义一个游标 </code></td></tr></tbody></table></div><div class="line alt2"><table border="0"><tbody><tr><td class="content" style="font-size: 1em;"><code class="sql keyword" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">declare</code>&nbsp;<code class="sql plain" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">user_cur </code>&nbsp;<code class="sql keyword" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">cursor</code>&nbsp;<code class="sql keyword" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">for</code>&nbsp;<code class="sql keyword" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">select</code>&nbsp;<code class="sql plain" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">ID,Oid,[Login] </code>&nbsp;<code class="sql keyword" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">from</code>&nbsp;<code class="sql plain" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">ST_User </code></td></tr></tbody></table></div><div class="line alt1"><table border="0"><tbody><tr><td class="content" style="font-size: 1em;"><code class="sql comments" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">--打开游标 </code></td></tr></tbody></table></div><div class="line alt2"><table border="0"><tbody><tr><td class="content" style="font-size: 1em;"><code class="sql keyword" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">open</code>&nbsp;<code class="sql plain" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">user_cur </code></td></tr></tbody></table></div><div class="line alt1"><table border="0"><tbody><tr><td class="content" style="font-size: 1em;"><code class="sql plain" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">while @@fetch_status=0 </code></td></tr></tbody></table></div><div class="line alt2"><table border="0"><tbody><tr><td class="content" style="font-size: 1em;"><code class="sql keyword" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">begin</code></td></tr></tbody></table></div><div class="line alt1"><table border="0"><tbody><tr><td class="content" style="font-size: 1em;"><code class="sql comments" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">--读取游标 </code></td></tr></tbody></table></div><div class="line alt2"><table border="0"><tbody><tr><td class="content" style="font-size: 1em;"><code class="spaces" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">&nbsp;&nbsp;&nbsp;&nbsp;</code>&nbsp;<code class="sql keyword" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">fetch</code>&nbsp;<code class="sql keyword" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">next</code>&nbsp;<code class="sql keyword" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">from</code>&nbsp;<code class="sql plain" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">user_cur </code>&nbsp;<code class="sql keyword" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">into</code>&nbsp;<code class="sql plain" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">@ID,@Oid,@Login </code></td></tr></tbody></table></div><div class="line alt1"><table border="0"><tbody><tr><td class="content" style="font-size: 1em;"><code class="spaces" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">&nbsp;&nbsp;&nbsp;&nbsp;</code>&nbsp;<code class="sql plain" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">print @ID </code></td></tr></tbody></table></div><div class="line alt2"><table border="0"><tbody><tr><td class="content" style="font-size: 1em;"><code class="spaces" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">&nbsp;&nbsp;&nbsp;&nbsp;</code>&nbsp;<code class="sql comments" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">--print @Login </code></td></tr></tbody></table></div><div class="line alt1"><table border="0"><tbody><tr><td class="content" style="font-size: 1em;"><code class="sql keyword" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">end</code></td></tr></tbody></table></div><div class="line alt2"><table border="0"><tbody><tr><td class="content" style="font-size: 1em;"><code class="sql keyword" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">close</code>&nbsp;<code class="sql plain" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">user_cur </code></td></tr></tbody></table></div><div class="line alt1"><table border="0"><tbody><tr><td class="content" style="font-size: 1em;"><code class="sql comments" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">--摧毁游标 </code></td></tr></tbody></table></div><div class="line alt2"><table border="0"><tbody><tr><td class="content" style="font-size: 1em;"><code class="sql keyword" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">deallocate</code>&nbsp;<code class="sql plain" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">user_cur</code></td></tr></tbody></table></div></div></div></div><p style="padding: 0px;"><strong>六、触发器</strong></p><p style="padding: 0px;"><strong>　　</strong>&nbsp;触发器中的临时表：</p><p style="padding: 0px;">　　<span style="color: rgb(0, 0, 255);">Inserted&nbsp;</span><br>　　存放进行insert和update 操作后的数据&nbsp;<br>　　<span style="color: rgb(0, 0, 255);">Deleted&nbsp;</span><br>　　存放进行delete 和update操作前的数据</p><div class="cnblogs_Highlighter"><div class="syntaxhighlighter nogutter  sql"><div class="lines"><div class="line alt1"><table border="0"><tbody><tr><td class="content" style="font-size: 1em;"><code class="sql comments" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">--创建触发器 </code></td></tr></tbody></table></div><div class="line alt2"><table border="0"><tbody><tr><td class="content" style="font-size: 1em;"><code class="sql keyword" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">Create</code>&nbsp;<code class="sql keyword" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">trigger</code>&nbsp;<code class="sql plain" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">User_OnUpdate&nbsp; </code></td></tr></tbody></table></div><div class="line alt1"><table border="0"><tbody><tr><td class="content" style="font-size: 1em;"><code class="spaces" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">&nbsp;&nbsp;&nbsp;&nbsp;</code>&nbsp;<code class="sql keyword" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">On</code>&nbsp;<code class="sql plain" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">ST_User&nbsp; </code></td></tr></tbody></table></div><div class="line alt2"><table border="0"><tbody><tr><td class="content" style="font-size: 1em;"><code class="spaces" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">&nbsp;&nbsp;&nbsp;&nbsp;</code>&nbsp;<code class="sql keyword" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">for</code>&nbsp;<code class="sql keyword" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">Update</code>&nbsp;&nbsp;</td></tr></tbody></table></div><div class="line alt1"><table border="0"><tbody><tr><td class="content" style="font-size: 1em;"><code class="sql keyword" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">As</code>&nbsp;&nbsp;</td></tr></tbody></table></div><div class="line alt2"><table border="0"><tbody><tr><td class="content" style="font-size: 1em;"><code class="spaces" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">&nbsp;&nbsp;&nbsp;&nbsp;</code>&nbsp;<code class="sql keyword" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">declare</code>&nbsp;<code class="sql plain" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">@msg nvarchar(50) </code></td></tr></tbody></table></div><div class="line alt1"><table border="0"><tbody><tr><td class="content" style="font-size: 1em;"><code class="spaces" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">&nbsp;&nbsp;&nbsp;&nbsp;</code>&nbsp;<code class="sql comments" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">--@msg记录修改情况 </code></td></tr></tbody></table></div><div class="line alt2"><table border="0"><tbody><tr><td class="content" style="font-size: 1em;"><code class="spaces" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">&nbsp;&nbsp;&nbsp;&nbsp;</code>&nbsp;<code class="sql keyword" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">select</code>&nbsp;<code class="sql plain" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">@msg = N</code>&nbsp;<code class="sql string" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">'姓名从“'</code>&nbsp;<code class="sql plain" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">+ Deleted.</code>&nbsp;<code class="sql keyword" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">Name</code>&nbsp;<code class="sql plain" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">+ N</code>&nbsp;<code class="sql string" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">'”修改为“'</code>&nbsp;<code class="sql plain" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">+ Inserted.</code>&nbsp;<code class="sql keyword" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">Name</code>&nbsp;<code class="sql plain" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">+ </code>&nbsp;<code class="sql string" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">'”'</code>&nbsp;<code class="sql keyword" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">from</code><code class="sql plain" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">Inserted,Deleted </code></td></tr></tbody></table></div><div class="line alt1"><table border="0"><tbody><tr><td class="content" style="font-size: 1em;"><code class="spaces" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">&nbsp;&nbsp;&nbsp;&nbsp;</code>&nbsp;<code class="sql comments" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">--插入日志表 </code></td></tr></tbody></table></div><div class="line alt2"><table border="0"><tbody><tr><td class="content" style="font-size: 1em;"><code class="spaces" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">&nbsp;&nbsp;&nbsp;&nbsp;</code>&nbsp;<code class="sql keyword" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">insert</code>&nbsp;<code class="sql keyword" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">into</code>&nbsp;<code class="sql plain" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">[LOG](MSG)</code>&nbsp;<code class="sql keyword" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">values</code>&nbsp;<code class="sql plain" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">(@msg) </code></td></tr></tbody></table></div><div class="line alt1"><table border="0"><tbody><tr><td class="content" style="font-size: 1em;"><code class="spaces" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code>&nbsp;&nbsp;</td></tr></tbody></table></div><div class="line alt2"><table border="0"><tbody><tr><td class="content" style="font-size: 1em;"><code class="sql comments" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">--删除触发器 </code></td></tr></tbody></table></div><div class="line alt1"><table border="0"><tbody><tr><td class="content" style="font-size: 1em;"><code class="sql keyword" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">drop</code>&nbsp;<code class="sql keyword" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">trigger</code>&nbsp;<code class="sql plain" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">User_OnUpdate</code></td></tr></tbody></table></div></div></div></div><p style="padding: 0px;"><strong>七、存储过程</strong></p><div class="cnblogs_Highlighter"><div class="syntaxhighlighter nogutter  sql"><div class="lines"><div class="line alt1"><table border="0"><tbody><tr><td class="content" style="font-size: 1em;"><code class="sql comments" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">--创建带output参数的存储过程 </code></td></tr></tbody></table></div><div class="line alt2"><table border="0"><tbody><tr><td class="content" style="font-size: 1em;"><code class="sql keyword" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">CREATE</code>&nbsp;<code class="sql keyword" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">PROCEDURE</code>&nbsp;<code class="sql plain" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">PR_Sum </code></td></tr></tbody></table></div><div class="line alt1"><table border="0"><tbody><tr><td class="content" style="font-size: 1em;"><code class="spaces" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">&nbsp;&nbsp;&nbsp;&nbsp;</code>&nbsp;<code class="sql plain" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">@a </code>&nbsp;<code class="sql keyword" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">int</code>&nbsp;<code class="sql plain" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">, </code></td></tr></tbody></table></div><div class="line alt2"><table border="0"><tbody><tr><td class="content" style="font-size: 1em;"><code class="spaces" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">&nbsp;&nbsp;&nbsp;&nbsp;</code>&nbsp;<code class="sql plain" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">@b </code>&nbsp;<code class="sql keyword" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">int</code>&nbsp;<code class="sql plain" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">, </code></td></tr></tbody></table></div><div class="line alt1"><table border="0"><tbody><tr><td class="content" style="font-size: 1em;"><code class="spaces" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">&nbsp;&nbsp;&nbsp;&nbsp;</code>&nbsp;<code class="sql plain" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">@</code>&nbsp;<code class="sql color2" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">sum</code>&nbsp;<code class="sql keyword" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">int</code>&nbsp;<code class="sql keyword" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">output</code></td></tr></tbody></table></div><div class="line alt2"><table border="0"><tbody><tr><td class="content" style="font-size: 1em;"><code class="sql keyword" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">AS</code></td></tr></tbody></table></div><div class="line alt1"><table border="0"><tbody><tr><td class="content" style="font-size: 1em;"><code class="sql keyword" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">BEGIN</code></td></tr></tbody></table></div><div class="line alt2"><table border="0"><tbody><tr><td class="content" style="font-size: 1em;"><code class="spaces" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">&nbsp;&nbsp;&nbsp;&nbsp;</code>&nbsp;<code class="sql keyword" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">set</code>&nbsp;<code class="sql plain" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">@</code>&nbsp;<code class="sql color2" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">sum</code>&nbsp;<code class="sql plain" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">=@a+@b </code></td></tr></tbody></table></div><div class="line alt1"><table border="0"><tbody><tr><td class="content" style="font-size: 1em;"><code class="sql keyword" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">END</code></td></tr></tbody></table></div><div class="line alt2"><table border="0"><tbody><tr><td class="content" style="font-size: 1em;"><code class="spaces" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">&nbsp;</code>&nbsp;&nbsp;</td></tr></tbody></table></div><div class="line alt1"><table border="0"><tbody><tr><td class="content" style="font-size: 1em;"><code class="sql comments" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">--创建Return返回值存储过程 </code></td></tr></tbody></table></div><div class="line alt2"><table border="0"><tbody><tr><td class="content" style="font-size: 1em;"><code class="sql keyword" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">CREATE</code>&nbsp;<code class="sql keyword" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">PROCEDURE</code>&nbsp;<code class="sql plain" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">PR_Sum2 </code></td></tr></tbody></table></div><div class="line alt1"><table border="0"><tbody><tr><td class="content" style="font-size: 1em;"><code class="spaces" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">&nbsp;&nbsp;&nbsp;&nbsp;</code>&nbsp;<code class="sql plain" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">@a </code>&nbsp;<code class="sql keyword" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">int</code>&nbsp;<code class="sql plain" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">, </code></td></tr></tbody></table></div><div class="line alt2"><table border="0"><tbody><tr><td class="content" style="font-size: 1em;"><code class="spaces" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">&nbsp;&nbsp;&nbsp;&nbsp;</code>&nbsp;<code class="sql plain" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">@b </code>&nbsp;<code class="sql keyword" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">int</code></td></tr></tbody></table></div><div class="line alt1"><table border="0"><tbody><tr><td class="content" style="font-size: 1em;"><code class="sql keyword" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">AS</code></td></tr></tbody></table></div><div class="line alt2"><table border="0"><tbody><tr><td class="content" style="font-size: 1em;"><code class="sql keyword" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">BEGIN</code></td></tr></tbody></table></div><div class="line alt1"><table border="0"><tbody><tr><td class="content" style="font-size: 1em;"><code class="spaces" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">&nbsp;&nbsp;&nbsp;&nbsp;</code>&nbsp;<code class="sql keyword" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">Return</code>&nbsp;<code class="sql plain" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">@a+@b </code></td></tr></tbody></table></div><div class="line alt2"><table border="0"><tbody><tr><td class="content" style="font-size: 1em;"><code class="sql keyword" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">END</code></td></tr></tbody></table></div><div class="line alt1"><table border="0"><tbody><tr><td class="content" style="font-size: 1em;"><code class="spaces" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code>&nbsp;&nbsp;</td></tr></tbody></table></div><div class="line alt2"><table border="0"><tbody><tr><td class="content" style="font-size: 1em;"><code class="sql comments" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">--执行存储过程获取output型返回值 </code></td></tr></tbody></table></div><div class="line alt1"><table border="0"><tbody><tr><td class="content" style="font-size: 1em;"><code class="sql keyword" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">declare</code>&nbsp;<code class="sql plain" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">@mysum </code>&nbsp;<code class="sql keyword" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">int</code></td></tr></tbody></table></div><div class="line alt2"><table border="0"><tbody><tr><td class="content" style="font-size: 1em;"><code class="sql keyword" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">execute</code>&nbsp;<code class="sql plain" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">PR_Sum 1,2,@mysum </code>&nbsp;<code class="sql keyword" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">output</code></td></tr></tbody></table></div><div class="line alt1"><table border="0"><tbody><tr><td class="content" style="font-size: 1em;"><code class="sql plain" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">print @mysum </code></td></tr></tbody></table></div><div class="line alt2"><table border="0"><tbody><tr><td class="content" style="font-size: 1em;"><code class="spaces" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">&nbsp;</code>&nbsp;&nbsp;</td></tr></tbody></table></div><div class="line alt1"><table border="0"><tbody><tr><td class="content" style="font-size: 1em;"><code class="sql comments" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">--执行存储过程获取Return型返回值 </code></td></tr></tbody></table></div><div class="line alt2"><table border="0"><tbody><tr><td class="content" style="font-size: 1em;"><code class="sql keyword" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">declare</code>&nbsp;<code class="sql plain" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">@mysum2 </code>&nbsp;<code class="sql keyword" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">int</code></td></tr></tbody></table></div><div class="line alt1"><table border="0"><tbody><tr><td class="content" style="font-size: 1em;"><code class="sql keyword" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">execute</code>&nbsp;<code class="sql plain" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">@mysum2= PR_Sum2 1,2 </code></td></tr></tbody></table></div><div class="line alt2"><table border="0"><tbody><tr><td class="content" style="font-size: 1em;"><code class="sql plain" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">print @mysum2</code></td></tr></tbody></table></div></div></div></div><div class="cnblogs_Highlighter">&nbsp;</div><p style="padding: 0px;"><span style="background-color: rgb(248, 248, 248);">&nbsp;</span>&nbsp;&nbsp;</p><p style="padding: 0px;"><strong>八、自定义函数</strong></p><p style="padding: 0px;">　　函数的分类：</p><p style="padding: 0px;">　　　　1）<span style="color: rgb(255, 0, 0);">标量值函数</span></p><p style="padding: 0px;">　　　　2）<span style="color: rgb(255, 0, 0);">表值函数</span></p><p style="padding: 0px;">　　　　　　　　a:<span style="color: rgb(255, 102, 0);">内联表值函数</span></p><p style="padding: 0px;">　　　　　　　　b:<span style="color: rgb(255, 102, 0);">多语句表值函数</span></p><p style="padding: 0px;">　　　　3）<span style="color: rgb(0, 0, 255);">系统函数</span></p><p style="padding: 0px;">&nbsp;</p><div class="cnblogs_Highlighter"><div class="syntaxhighlighter nogutter  sql"><div class="lines"><div class="line alt1"><table border="0"><tbody><tr><td class="content" style="font-size: 1em;"><code class="sql comments" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">--新建标量值函数 </code></td></tr></tbody></table></div><div class="line alt2"><table border="0"><tbody><tr><td class="content" style="font-size: 1em;"><code class="sql keyword" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">create</code>&nbsp;<code class="sql keyword" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">function</code>&nbsp;<code class="sql plain" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">FUNC_Sum1 </code></td></tr></tbody></table></div><div class="line alt1"><table border="0"><tbody><tr><td class="content" style="font-size: 1em;"><code class="sql plain" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">( </code></td></tr></tbody></table></div><div class="line alt2"><table border="0"><tbody><tr><td class="content" style="font-size: 1em;"><code class="spaces" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">&nbsp;&nbsp;&nbsp;&nbsp;</code>&nbsp;<code class="sql plain" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">@a </code>&nbsp;<code class="sql keyword" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">int</code>&nbsp;<code class="sql plain" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">, </code></td></tr></tbody></table></div><div class="line alt1"><table border="0"><tbody><tr><td class="content" style="font-size: 1em;"><code class="spaces" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">&nbsp;&nbsp;&nbsp;&nbsp;</code>&nbsp;<code class="sql plain" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">@b </code>&nbsp;<code class="sql keyword" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">int</code></td></tr></tbody></table></div><div class="line alt2"><table border="0"><tbody><tr><td class="content" style="font-size: 1em;"><code class="sql plain" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">) </code></td></tr></tbody></table></div><div class="line alt1"><table border="0"><tbody><tr><td class="content" style="font-size: 1em;"><code class="sql keyword" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">returns</code>&nbsp;<code class="sql keyword" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">int</code></td></tr></tbody></table></div><div class="line alt2"><table border="0"><tbody><tr><td class="content" style="font-size: 1em;"><code class="sql keyword" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">as</code></td></tr></tbody></table></div><div class="line alt1"><table border="0"><tbody><tr><td class="content" style="font-size: 1em;"><code class="sql keyword" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">begin</code></td></tr></tbody></table></div><div class="line alt2"><table border="0"><tbody><tr><td class="content" style="font-size: 1em;"><code class="spaces" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">&nbsp;&nbsp;&nbsp;&nbsp;</code>&nbsp;<code class="sql keyword" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">return</code>&nbsp;<code class="sql plain" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">@a+@b </code></td></tr></tbody></table></div><div class="line alt1"><table border="0"><tbody><tr><td class="content" style="font-size: 1em;"><code class="sql keyword" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">end</code></td></tr></tbody></table></div><div class="line alt2"><table border="0"><tbody><tr><td class="content" style="font-size: 1em;"><code class="spaces" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">&nbsp;</code>&nbsp;&nbsp;</td></tr></tbody></table></div><div class="line alt1"><table border="0"><tbody><tr><td class="content" style="font-size: 1em;"><code class="sql comments" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">--新建内联表值函数 </code></td></tr></tbody></table></div><div class="line alt2"><table border="0"><tbody><tr><td class="content" style="font-size: 1em;"><code class="sql keyword" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">create</code>&nbsp;<code class="sql keyword" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">function</code>&nbsp;<code class="sql plain" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">FUNC_UserTab_1 </code></td></tr></tbody></table></div><div class="line alt1"><table border="0"><tbody><tr><td class="content" style="font-size: 1em;"><code class="sql plain" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">( </code></td></tr></tbody></table></div><div class="line alt2"><table border="0"><tbody><tr><td class="content" style="font-size: 1em;"><code class="spaces" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">&nbsp;&nbsp;&nbsp;&nbsp;</code>&nbsp;<code class="sql plain" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">@myId </code>&nbsp;<code class="sql keyword" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">int</code></td></tr></tbody></table></div><div class="line alt1"><table border="0"><tbody><tr><td class="content" style="font-size: 1em;"><code class="sql plain" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">) </code></td></tr></tbody></table></div><div class="line alt2"><table border="0"><tbody><tr><td class="content" style="font-size: 1em;"><code class="sql keyword" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">returns</code>&nbsp;<code class="sql keyword" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">table</code></td></tr></tbody></table></div><div class="line alt1"><table border="0"><tbody><tr><td class="content" style="font-size: 1em;"><code class="sql keyword" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">as</code></td></tr></tbody></table></div><div class="line alt2"><table border="0"><tbody><tr><td class="content" style="font-size: 1em;"><code class="sql keyword" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">return</code>&nbsp;<code class="sql plain" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">(</code>&nbsp;<code class="sql keyword" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">select</code>&nbsp;<code class="sql plain" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">* </code>&nbsp;<code class="sql keyword" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">from</code>&nbsp;<code class="sql plain" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">ST_User </code>&nbsp;<code class="sql keyword" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">where</code>&nbsp;<code class="sql plain" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">ID&lt;@myId) </code></td></tr></tbody></table></div><div class="line alt1"><table border="0"><tbody><tr><td class="content" style="font-size: 1em;"><code class="spaces" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">&nbsp;</code>&nbsp;&nbsp;</td></tr></tbody></table></div><div class="line alt2"><table border="0"><tbody><tr><td class="content" style="font-size: 1em;"><code class="sql comments" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">--新建多语句表值函数 </code></td></tr></tbody></table></div><div class="line alt1"><table border="0"><tbody><tr><td class="content" style="font-size: 1em;"><code class="sql keyword" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">create</code>&nbsp;<code class="sql keyword" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">function</code>&nbsp;<code class="sql plain" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">FUNC_UserTab_2 </code></td></tr></tbody></table></div><div class="line alt2"><table border="0"><tbody><tr><td class="content" style="font-size: 1em;"><code class="sql plain" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">( </code></td></tr></tbody></table></div><div class="line alt1"><table border="0"><tbody><tr><td class="content" style="font-size: 1em;"><code class="spaces" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">&nbsp;&nbsp;&nbsp;&nbsp;</code>&nbsp;<code class="sql plain" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">@myId </code>&nbsp;<code class="sql keyword" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">int</code></td></tr></tbody></table></div><div class="line alt2"><table border="0"><tbody><tr><td class="content" style="font-size: 1em;"><code class="sql plain" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">) </code></td></tr></tbody></table></div><div class="line alt1"><table border="0"><tbody><tr><td class="content" style="font-size: 1em;"><code class="sql keyword" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">returns</code>&nbsp;<code class="sql plain" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">@t </code>&nbsp;<code class="sql keyword" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">table</code></td></tr></tbody></table></div><div class="line alt2"><table border="0"><tbody><tr><td class="content" style="font-size: 1em;"><code class="sql plain" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">( </code></td></tr></tbody></table></div><div class="line alt1"><table border="0"><tbody><tr><td class="content" style="font-size: 1em;"><code class="spaces" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">&nbsp;&nbsp;&nbsp;&nbsp;</code>&nbsp;<code class="sql plain" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">[ID] [</code>&nbsp;<code class="sql keyword" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">int</code>&nbsp;<code class="sql plain" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">] </code>&nbsp;<code class="sql color1" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">NOT</code>&nbsp;<code class="sql color1" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">NULL</code>&nbsp;<code class="sql plain" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">, </code></td></tr></tbody></table></div><div class="line alt2"><table border="0"><tbody><tr><td class="content" style="font-size: 1em;"><code class="spaces" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">&nbsp;&nbsp;&nbsp;&nbsp;</code>&nbsp;<code class="sql plain" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">[Oid] [</code>&nbsp;<code class="sql keyword" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">int</code>&nbsp;<code class="sql plain" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">] </code>&nbsp;<code class="sql color1" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">NOT</code>&nbsp;<code class="sql color1" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">NULL</code>&nbsp;<code class="sql plain" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">, </code></td></tr></tbody></table></div><div class="line alt1"><table border="0"><tbody><tr><td class="content" style="font-size: 1em;"><code class="spaces" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">&nbsp;&nbsp;&nbsp;&nbsp;</code>&nbsp;<code class="sql plain" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">[Login] [nvarchar](50) </code>&nbsp;<code class="sql color1" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">NOT</code>&nbsp;<code class="sql color1" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">NULL</code>&nbsp;<code class="sql plain" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">, </code></td></tr></tbody></table></div><div class="line alt2"><table border="0"><tbody><tr><td class="content" style="font-size: 1em;"><code class="spaces" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">&nbsp;&nbsp;&nbsp;&nbsp;</code>&nbsp;<code class="sql plain" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">[Rtx] [nvarchar](4) </code>&nbsp;<code class="sql color1" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">NOT</code>&nbsp;<code class="sql color1" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">NULL</code>&nbsp;<code class="sql plain" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">, </code></td></tr></tbody></table></div><div class="line alt1"><table border="0"><tbody><tr><td class="content" style="font-size: 1em;"><code class="spaces" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">&nbsp;&nbsp;&nbsp;&nbsp;</code>&nbsp;<code class="sql plain" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">[</code>&nbsp;<code class="sql keyword" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">Name</code>&nbsp;<code class="sql plain" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">] [nvarchar](5) </code>&nbsp;<code class="sql color1" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">NOT</code>&nbsp;<code class="sql color1" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">NULL</code>&nbsp;<code class="sql plain" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">, </code></td></tr></tbody></table></div><div class="line alt2"><table border="0"><tbody><tr><td class="content" style="font-size: 1em;"><code class="spaces" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">&nbsp;&nbsp;&nbsp;&nbsp;</code>&nbsp;<code class="sql plain" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">[</code>&nbsp;<code class="sql keyword" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">Password</code>&nbsp;<code class="sql plain" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">] [nvarchar](</code>&nbsp;<code class="sql keyword" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">max</code>&nbsp;<code class="sql plain" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">) </code>&nbsp;<code class="sql color1" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">NULL</code>&nbsp;<code class="sql plain" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">, </code></td></tr></tbody></table></div><div class="line alt1"><table border="0"><tbody><tr><td class="content" style="font-size: 1em;"><code class="spaces" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">&nbsp;&nbsp;&nbsp;&nbsp;</code>&nbsp;<code class="sql plain" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">[State] [nvarchar](8) </code>&nbsp;<code class="sql color1" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">NOT</code>&nbsp;<code class="sql color1" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">NULL</code></td></tr></tbody></table></div><div class="line alt2"><table border="0"><tbody><tr><td class="content" style="font-size: 1em;"><code class="sql plain" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">) </code></td></tr></tbody></table></div><div class="line alt1"><table border="0"><tbody><tr><td class="content" style="font-size: 1em;"><code class="sql keyword" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">as</code></td></tr></tbody></table></div><div class="line alt2"><table border="0"><tbody><tr><td class="content" style="font-size: 1em;"><code class="sql keyword" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">begin</code></td></tr></tbody></table></div><div class="line alt1"><table border="0"><tbody><tr><td class="content" style="font-size: 1em;"><code class="spaces" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">&nbsp;&nbsp;&nbsp;&nbsp;</code>&nbsp;<code class="sql keyword" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">insert</code>&nbsp;<code class="sql keyword" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">into</code>&nbsp;<code class="sql plain" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">@t </code>&nbsp;<code class="sql keyword" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">select</code>&nbsp;<code class="sql plain" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">* </code>&nbsp;<code class="sql keyword" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">from</code>&nbsp;<code class="sql plain" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">ST_User </code>&nbsp;<code class="sql keyword" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">where</code>&nbsp;<code class="sql plain" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">ID&lt;@myId </code></td></tr></tbody></table></div><div class="line alt2"><table border="0"><tbody><tr><td class="content" style="font-size: 1em;"><code class="spaces" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">&nbsp;&nbsp;&nbsp;&nbsp;</code>&nbsp;<code class="sql keyword" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">return</code></td></tr></tbody></table></div><div class="line alt1"><table border="0"><tbody><tr><td class="content" style="font-size: 1em;"><code class="sql keyword" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">end</code></td></tr></tbody></table></div><div class="line alt2"><table border="0"><tbody><tr><td class="content" style="font-size: 1em;"><code class="spaces" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">&nbsp;</code>&nbsp;&nbsp;</td></tr></tbody></table></div><div class="line alt1"><table border="0"><tbody><tr><td class="content" style="font-size: 1em;"><code class="sql comments" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">--调用表值函数 </code></td></tr></tbody></table></div><div class="line alt2"><table border="0"><tbody><tr><td class="content" style="font-size: 1em;"><code class="sql keyword" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">select</code>&nbsp;<code class="sql plain" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">* </code>&nbsp;<code class="sql keyword" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">from</code>&nbsp;<code class="sql plain" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">dbo.FUNC_UserTab_1(15) </code></td></tr></tbody></table></div><div class="line alt1"><table border="0"><tbody><tr><td class="content" style="font-size: 1em;"><code class="sql comments" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">--调用标量值函数 </code></td></tr></tbody></table></div><div class="line alt2"><table border="0"><tbody><tr><td class="content" style="font-size: 1em;"><code class="sql keyword" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">declare</code>&nbsp;<code class="sql plain" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">@s </code>&nbsp;<code class="sql keyword" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">int</code></td></tr></tbody></table></div><div class="line alt1"><table border="0"><tbody><tr><td class="content" style="font-size: 1em;"><code class="sql keyword" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">set</code>&nbsp;<code class="sql plain" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">@s=dbo.FUNC_Sum1(100,50) </code></td></tr></tbody></table></div><div class="line alt2"><table border="0"><tbody><tr><td class="content" style="font-size: 1em;"><code class="sql plain" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">print @s </code></td></tr></tbody></table></div><div class="line alt1"><table border="0"><tbody><tr><td class="content" style="font-size: 1em;"><code class="spaces" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">&nbsp;</code>&nbsp;&nbsp;</td></tr></tbody></table></div><div class="line alt2"><table border="0"><tbody><tr><td class="content" style="font-size: 1em;"><code class="sql comments" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">--删除标量值函数 </code></td></tr></tbody></table></div><div class="line alt1"><table border="0"><tbody><tr><td class="content" style="font-size: 1em;"><code class="sql keyword" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">drop</code>&nbsp;<code class="sql keyword" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">function</code>&nbsp;<code class="sql plain" style="font-family: 'Courier New', Courier, monospace; font-size: 1em; white-space: pre;">FUNC_Sum1</code></td></tr></tbody></table></div></div></div></div><p style="padding: 0px;"><span style="color: rgb(255, 0, 0);"><strong>谈谈自定义函数与存储过程的区别：</strong></span></p><p style="padding: 0px;">一、自定义函数：</p><p style="padding: 0px;">　　1. 可以返回表变量</p><p style="padding: 0px;">　　2. 限制颇多，包括</p><p style="padding: 0px;">　　　　不能使用output参数；</p><p style="padding: 0px;">　　　　不能用临时表；</p><p style="padding: 0px;">　　　　函数内部的操作不能影响到外部环境；</p><p style="padding: 0px;">　　　　不能通过select返回结果集；</p><p style="padding: 0px;">　　　　不能update，delete，数据库表；</p><p style="padding: 0px;">　　3. 必须return 一个标量值或表变量</p><p style="padding: 0px;">　　自定义函数一般用在复用度高，功能简单单一，争对性强的地方。</p><p style="padding: 0px;">二、存储过程</p><p style="padding: 0px;">　　1. 不能返回表变量</p><p style="padding: 0px;">　　2. 限制少，可以执行对数据库表的操作，可以返回数据集</p><p style="padding: 0px;">　　3. 可以return一个标量值，也可以省略return</p><p style="padding: 0px;">　　　存储过程一般用在实现复杂的功能，数据操纵方面。</p><h2 style="font-size: 1.5em; line-height: 1.5em; margin-top: 0px; margin-bottom: 0.5em;">&nbsp;</h2><p style="padding: 0px;">-----------------------------------------------------------------------------------------------------------------------------------</p><h2 class="titName SG_txta" style="font-size: 1.5em; line-height: 1.5em; margin-top: 0px; margin-bottom: 0.5em;">SqlServer存储过程--实例</h2><p style="padding: 0px;"><strong>实例1：只返回单一记录集的存储过程。</strong></p><p style="padding: 0px;">　　表银行存款表（bankMoney）的内容如下</p><p style="padding: 0px;">&nbsp;</p><table border="1" cellspacing="0" cellpadding="0"><tbody><tr><td width="57" style="font-size: 1em; padding: 0cm 5.4pt; width: 42.55pt; background-color: transparent;"><p style="margin: 0cm 0cm 0pt; padding: 0px;"><span style="font-family: Arial;">Id</span></p></td><td width="77" style="font-size: 1em; padding: 0cm 5.4pt; width: 57.55pt; background-color: transparent;"><p style="margin: 0cm 0cm 0pt; padding: 0px;">userID</p></td><td width="57" style="font-size: 1em; padding: 0cm 5.4pt; width: 42.55pt; background-color: transparent;"><p style="margin: 0cm 0cm 0pt; padding: 0px;"><span style="font-family: Arial;">Sex</span></p></td><td width="57" style="font-size: 1em; padding: 0cm 5.4pt; width: 42.55pt; background-color: transparent;"><p style="margin: 0cm 0cm 0pt; padding: 0px;"><span style="font-family: Arial;">Money</span></p></td></tr><tr><td width="57" style="font-size: 1em; padding: 0cm 5.4pt; width: 42.55pt; background-color: transparent;"><p style="margin: 0cm 0cm 0pt; padding: 0px;"><span style="font-family: Arial;">001</span></p></td><td width="77" style="font-size: 1em; padding: 0cm 5.4pt; width: 57.55pt; background-color: transparent;"><p style="margin: 0cm 0cm 0pt; padding: 0px;"><span style="font-family: Arial;">Zhangsan</span></p></td><td width="57" style="font-size: 1em; padding: 0cm 5.4pt; width: 42.55pt; background-color: transparent;"><p style="margin: 0cm 0cm 0pt; padding: 0px;">男</p></td><td width="57" style="font-size: 1em; padding: 0cm 5.4pt; width: 42.55pt; background-color: transparent;"><p style="margin: 0cm 0cm 0pt; padding: 0px;"><span style="font-family: Arial;">30</span></p></td></tr><tr><td width="57" style="font-size: 1em; padding: 0cm 5.4pt; width: 42.55pt; background-color: transparent;"><p style="margin: 0cm 0cm 0pt; padding: 0px;"><span style="font-family: Arial;">002</span></p></td><td width="77" style="font-size: 1em; padding: 0cm 5.4pt; width: 57.55pt; background-color: transparent;"><p style="margin: 0cm 0cm 0pt; padding: 0px;"><span style="font-family: Arial;">Wangwu</span></p></td><td width="57" style="font-size: 1em; padding: 0cm 5.4pt; width: 42.55pt; background-color: transparent;"><p style="margin: 0cm 0cm 0pt; padding: 0px;">男</p></td><td width="57" style="font-size: 1em; padding: 0cm 5.4pt; width: 42.55pt; background-color: transparent;"><p style="margin: 0cm 0cm 0pt; padding: 0px;"><span style="font-family: Arial;">50</span></p></td></tr><tr><td width="57" style="font-size: 1em; padding: 0cm 5.4pt; width: 42.55pt; background-color: transparent;"><p style="margin: 0cm 0cm 0pt; padding: 0px;"><span style="font-family: Arial;">003</span></p></td><td width="77" style="font-size: 1em; padding: 0cm 5.4pt; width: 57.55pt; background-color: transparent;"><p style="margin: 0cm 0cm 0pt; padding: 0px;"><span style="font-family: Arial;">Zhangsan</span></p></td><td width="57" style="font-size: 1em; padding: 0cm 5.4pt; width: 42.55pt; background-color: transparent;"><p style="margin: 0cm 0cm 0pt; padding: 0px;">男</p></td><td width="57" style="font-size: 1em; padding: 0cm 5.4pt; width: 42.55pt; background-color: transparent;"><p style="margin: 0cm 0cm 0pt; padding: 0px;"><span style="font-family: Arial;">40</span></p></td></tr></tbody></table><p style="padding: 0px;">&nbsp;</p><p style="padding: 0px;">要求1：查询表bankMoney的内容的存储过程</p><p style="padding: 0px;">create procedure sp_query_bankMoney<br>as<br>select * from bankMoney<br>go<br>exec sp_query_bankMoney</p><p style="padding: 0px;"><strong><span style="color: rgb(255, 0, 0);">注*&nbsp; 在使用过程中只需要把T-Sql中的SQL语句替换为存储过程名，就可以了很方便吧！</span></strong></p><p style="padding: 0px;"><strong>实例2（向存储过程中传递参数）：</strong></p><p style="padding: 0px;">加入一笔记录到表bankMoney，并查询此表中userID= Zhangsan的所有存款的总金额。</p><p style="padding: 0px;">Create proc insert_bank @param1 char(10),@param2 varchar(20),@param3 varchar(20),@param4 int,@param5 int output<br>with encryption ---------加密<br>as<br>insert into&nbsp;bankMoney (id,userID,sex,Money)<br>Values(@param1,@param2,@param3, @param4)<br>select @param5=sum(Money) from bankMoney where userID='Zhangsan'<br>go<br>在SQL Server查询分析器中执行该存储过程的方法是：<br>declare @total_price int<br>exec insert_bank '004','Zhangsan','男',100,@total_price output<br>print '总余额为'+convert(varchar,@total_price)<br>go</p><p style="padding: 0px;">在这里再啰嗦一下存储过程的3种传回值（方便正在看这个例子的朋友不用再去查看语法内容）:</p><p style="padding: 0px;">1.以Return传回整数<br>2.以output格式传回参数<br>3.Recordset</p><p style="padding: 0px;">传回值的区别:</p><p style="padding: 0px;">output和return都可在批次程式中用变量接收,而recordset则传回到执行批次的客户端中。</p><p style="padding: 0px;"><strong>实例3：使用带有复杂 SELECT 语句的简单过程</strong></p><p style="padding: 0px;">　　下面的存储过程从四个表的联接中返回所有作者（提供了姓名）、出版的书籍以及出版社。该存储过程不使用任何参数。</p><p style="padding: 0px;">　　USE pubs<br>IF EXISTS (SELECT name FROM sysobjects<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; WHERE name = 'au_info_all' AND type = 'P')<br>&nbsp;&nbsp; DROP PROCEDURE au_info_all<br>GO<br>CREATE PROCEDURE au_info_all<br>AS<br>SELECT au_lname, au_fname, title, pub_name<br>&nbsp;&nbsp; FROM authors a INNER JOIN titleauthor ta<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ON a.au_id = ta.au_id INNER JOIN titles t<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ON t.title_id = ta.title_id INNER JOIN publishers p<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ON t.pub_id = p.pub_id<br>GO</p><p style="padding: 0px;">　　au_info_all 存储过程可以通过以下方法执行：</p><p style="padding: 0px;">　　EXECUTE au_info_all<br>-- Or<br>EXEC au_info_all</p><p style="padding: 0px;">　　如果该过程是批处理中的第一条语句，则可使用：</p><p style="padding: 0px;">　　au_info_all</p><p style="padding: 0px;"><strong>实例4：使用带有参数的简单过程</strong></p><p style="padding: 0px;">　　CREATE PROCEDURE au_info<br>&nbsp;&nbsp; @lastname varchar(40),<br>&nbsp;&nbsp; @firstname varchar(20)<br>AS<br>SELECT au_lname, au_fname, title, pub_name<br>&nbsp;&nbsp; FROM authors a INNER JOIN titleauthor ta<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ON a.au_id = ta.au_id INNER JOIN titles t<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ON t.title_id = ta.title_id INNER JOIN publishers p<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ON t.pub_id = p.pub_id<br>&nbsp;&nbsp; WHERE&nbsp; au_fname = @firstname<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; AND au_lname = @lastname<br>GO</p><p style="padding: 0px;">　　au_info 存储过程可以通过以下方法执行：</p><p style="padding: 0px;">　　EXECUTE au_info 'Dull', 'Ann'<br>-- Or<br>EXECUTE au_info @lastname = 'Dull', @firstname = 'Ann'<br>-- Or<br>EXECUTE au_info @firstname = 'Ann', @lastname = 'Dull'<br>-- Or<br>EXEC au_info 'Dull', 'Ann'<br>-- Or<br>EXEC au_info @lastname = 'Dull', @firstname = 'Ann'<br>-- Or<br>EXEC au_info @firstname = 'Ann', @lastname = 'Dull'</p><p style="padding: 0px;">　　如果该过程是批处理中的第一条语句，则可使用：</p><p style="padding: 0px;">　　au_info 'Dull', 'Ann'<br>-- Or<br>au_info @lastname = 'Dull', @firstname = 'Ann'<br>-- Or<br>au_info @firstname = 'Ann', @lastname = 'Dull'</p><p style="padding: 0px;">&nbsp;</p><table border="0" cellspacing="0" cellpadding="0" style="width: 686px;"><tbody><tr><td width="100%" height="62" style="font-size: 1em;"><p style="padding: 0px;">&nbsp;<strong>实例5：使用带有通配符参数的简单过程</strong></p><p style="padding: 0px;">CREATE PROCEDURE au_info2<br>@lastname varchar(30) = 'D%',<br>@firstname varchar(18) = '%'<br>AS<br>SELECT au_lname, au_fname, title, pub_name<br>FROM authors a INNER JOIN titleauthor ta<br>&nbsp;&nbsp; ON a.au_id = ta.au_id INNER JOIN titles t<br>&nbsp;&nbsp; ON t.title_id = ta.title_id INNER JOIN publishers p<br>&nbsp;&nbsp; ON t.pub_id = p.pub_id<br>WHERE au_fname LIKE @firstname<br>&nbsp;&nbsp; AND au_lname LIKE @lastname<br>GO</p><p style="padding: 0px;">　　au_info2 存储过程可以用多种组合执行。下面只列出了部分组合：</p><p style="padding: 0px;">　　EXECUTE au_info2<br>-- Or<br>EXECUTE au_info2 'Wh%'<br>-- Or<br>EXECUTE au_info2 @firstname = 'A%'<br>-- Or<br>EXECUTE au_info2 '[CK]ars[OE]n'<br>-- Or<br>EXECUTE au_info2 'Hunter', 'Sheryl'<br>-- Or<br>EXECUTE au_info2 'H%', 'S%'</p><p style="padding: 0px;">　　= 'proc2'</p><p style="padding: 0px;"><strong>实例6：if...else</strong></p></td></tr></tbody></table><p style="padding: 0px;"><span style="color: rgb(0, 128, 0);">存储过程，其中@case作为执行update的选择依据，用if...else实现执行时根据传入的参数执行不同的修改.</span>&nbsp;<br><span style="color: green;">--下面是if……else的存储过程：</span>&nbsp;<br><span style="color: blue;">if</span>&nbsp;<span style="color: blue;">exists</span>&nbsp;(<span style="color: blue;">select</span>&nbsp;1&nbsp;<span style="color: blue;">from</span>&nbsp;sysobjects&nbsp;<span style="color: blue;">where</span>&nbsp;<span style="color: blue;">name</span>&nbsp;=&nbsp;<span style="color: rgb(163, 21, 21);">'Student'</span>&nbsp;<span style="color: blue;">and</span>&nbsp;<span style="color: blue;">type</span>&nbsp;=<span style="color: rgb(163, 21, 21);">'u'</span>&nbsp;)<br><span style="color: blue;">drop</span>&nbsp;<span style="color: blue;">table</span>&nbsp;Student<br>go<br><br><span style="color: blue;">if</span>&nbsp;<span style="color: blue;">exists</span>&nbsp;(<span style="color: blue;">select</span>&nbsp;1&nbsp;<span style="color: blue;">from</span>&nbsp;sysobjects&nbsp;<span style="color: blue;">where</span>&nbsp;<span style="color: blue;">name</span>&nbsp;=&nbsp;<span style="color: rgb(163, 21, 21);">'spUpdateStudent'</span>&nbsp;<span style="color: blue;">and</span>&nbsp;<span style="color: blue;">type</span>&nbsp;=<span style="color: rgb(163, 21, 21);">'p'</span>&nbsp;)<br><span style="color: blue;">drop</span>&nbsp;<span style="color: blue;">proc</span>&nbsp;spUpdateStudent<br>go<br><br><span style="color: blue;">create</span>&nbsp;<span style="color: blue;">table</span>&nbsp;Student<br>(<br>fName&nbsp;<span style="color: blue;">nvarchar</span>&nbsp;(10),<br>fAge&nbsp;</p><p style="padding: 0px;"><span style="color: blue;">smallint</span>&nbsp;,<br>fDiqu&nbsp;<span style="color: blue;">varchar</span>&nbsp;(50),<br>fTel&nbsp;&nbsp;<span style="color: blue;">int</span>&nbsp;<br>)<br>go<br><br><span style="color: blue;">insert</span>&nbsp;<span style="color: blue;">into</span>&nbsp;Student&nbsp;<span style="color: blue;">values</span>&nbsp;(<span style="color: rgb(163, 21, 21);">'X.X.Y'</span>&nbsp;, 28,&nbsp;<span style="color: rgb(163, 21, 21);">'Tesing'</span>&nbsp;, 888888)<br>go<br><br><span style="color: blue;">create</span>&nbsp;<span style="color: blue;">proc</span>&nbsp;spUpdateStudent<br>(<br>@fCase&nbsp;<span style="color: blue;">int</span>&nbsp;,<br>@fName&nbsp;<span style="color: blue;">nvarchar</span>&nbsp;(10),<br>@fAge&nbsp;<span style="color: blue;">smallint</span>&nbsp;,<br>@fDiqu&nbsp;<span style="color: blue;">varchar</span>&nbsp;(50),<br>@fTel&nbsp;&nbsp;<span style="color: blue;">int</span>&nbsp;<br>)<br><span style="color: blue;">as</span>&nbsp;<br><span style="color: blue;">update</span>&nbsp;Student<br><span style="color: blue;">set</span>&nbsp;fAge = @fAge,&nbsp;<span style="color: green;">-- 传 1,2,3 都要更新 fAge 不需要用 case</span>&nbsp;<br>fDiqu = (<span style="color: blue;">case</span>&nbsp;<span style="color: blue;">when</span>&nbsp;@fCase = 2&nbsp;<span style="color: blue;">or</span>&nbsp;@fCase = 3&nbsp;<span style="color: blue;">then</span>&nbsp;@fDiqu&nbsp;<span style="color: blue;">else</span>&nbsp;fDiqu&nbsp;<span style="color: blue;">end</span>&nbsp;),<br>fTel&nbsp; = (<span style="color: blue;">case</span>&nbsp;<span style="color: blue;">when</span>&nbsp;@fCase = 3&nbsp;<span style="color: blue;">then</span>&nbsp;@fTel&nbsp;<span style="color: blue;">else</span>&nbsp;fTel&nbsp;<span style="color: blue;">end</span>&nbsp;)<br><span style="color: blue;">where</span>&nbsp;fName = @fName<br><span style="color: blue;">select</span>&nbsp;*&nbsp;<span style="color: blue;">from</span>&nbsp;Student<br>go<br><br><span style="color: green;">-- 只改 Age</span>&nbsp;<br><span style="color: blue;">exec</span>&nbsp;spUpdateStudent<br>@fCase = 1,<br>@fName = N<span style="color: rgb(163, 21, 21);">'X.X.Y'</span>&nbsp;,<br>@fAge = 80,<br>@fDiqu = N<span style="color: rgb(163, 21, 21);">'Update'</span>&nbsp;,<br>@fTel&nbsp; = 1010101<br><br><span style="color: green;">-- 改 Age 和 Diqu</span>&nbsp;<br><span style="color: blue;">exec</span>&nbsp;spUpdateStudent<br>@fCase = 2,<br>@fName = N<span style="color: rgb(163, 21, 21);">'X.X.Y'</span>&nbsp;,<br>@fAge = 80,<br>@fDiqu = N<span style="color: rgb(163, 21, 21);">'Update'</span>&nbsp;,<br>@fTel&nbsp; = 1010101<br><br><span style="color: green;">-- 全改</span>&nbsp;<br><span style="color: blue;">exec</span>&nbsp;spUpdateStudent<br>@fCase = 3,<br>@fName = N<span style="color: rgb(163, 21, 21);">'X.X.Y'</span>&nbsp;,<br>@fAge = 80,<br>@fDiqu = N<span style="color: rgb(163, 21, 21);">'Update'</span>&nbsp;,<br>@fTel&nbsp; = 1010101</p><br><div style="color:gray"><small>来源：&nbsp;<a href="http://uule.iteye.com/blog/1988137">http://uule.iteye.com/blog/1988137</a></small></div></div></body></html>