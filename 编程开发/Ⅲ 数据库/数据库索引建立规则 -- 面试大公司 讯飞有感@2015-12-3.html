<!DOCTYPE html>
<html><head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">

<!--defaultCSS-->
<title>数据库索引建立规则 -- 面试大公司 讯飞有感@2015/12/3</title>



<style type="text/css" id="wiz_custom_css">
body
{
    font-family: Microsoft YaHei UI,"Microsoft YaHei", Georgia,Helvetica,Arial,sans-serif,宋体, PMingLiU,serif;
    font-size: 10.5pt;
    line-height: 1.5;
}
html, body
{
    
    
}
h1 {
    font-size:1.5em;
    font-weight:bold;
}
h2 {
    font-size:1.4em;
    font-weight:bold;
}
h3 {
    font-size:1.3em;
    font-weight:bold;
}
h4 {
    font-size:1.2em;
    font-weight:bold;
}
h5 {
    font-size:1.1em;
    font-weight:bold;
}
h6 {
    font-size:1.0em;
    font-weight:bold;
}
img {
    border:0;
    max-width: 100%;
    height: auto !important;
}
blockquote {
    margin-top:0px;
    margin-bottom:0px;
}
table {
    border-collapse:collapse;
    border:1px solid #bbbbbb;
}
td {
    border-collapse:collapse;
    border:1px solid #bbbbbb;
}
</style>

<style type="text/css" id="wiz_todo_style_id" wiz_link_version="01.00.09">.wiz-todo, .wiz-todo-img {width: 16px; height: 16px; cursor: default; padding: 0 10px 0 2px; vertical-align: -10%;-webkit-user-select: none;} .wiz-todo-label { display: inline-block; padding-top: 7px; padding-bottom: 6px; line-height: 1.5;} .wiz-todo-label-checked {  color: #666;} .wiz-todo-label-unchecked {text-decoration: initial;} .wiz-todo-completed-info {padding-left: 44px; display: inline-block; } .wiz-todo-avatar { width:20px; height: 20px; vertical-align: -20%; margin-right:10px; border-radius: 2px;} .wiz-todo-account, .wiz-todo-dt { color: #666; }</style></head>

<body  style=""><h1 class="postTitle" style="font-size: 14.7px; margin-bottom: 10px; color: rgb(75, 75, 75); font-family: Verdana, Geneva, Arial, Helvetica, sans-serif; widows: 1;">红色部分已标识， 查漏补缺！！！ 面试问的问题。。。</h1><h1 class="postTitle" style="font-size: 14.7px; margin-bottom: 10px; color: rgb(75, 75, 75); font-family: Verdana, Geneva, Arial, Helvetica, sans-serif; widows: 1;"><a id="cb_post_title_url" class="postTitle2" href="http://www.cnblogs.com/net-study/p/3397359.html" style="text-decoration: none; color: rgb(26, 139, 200);">建立索引的规则</a></h1><div id="cnblogs_post_body" style="margin-bottom: 20px; word-break: break-word; font-family: Verdana, Geneva, Arial, Helvetica, sans-serif; font-size: 13px; line-height: 19.5px; widows: 1;"><p style="color: rgb(75, 75, 75); line-height: 1.5; margin: 10px auto;">建立索引常用的规则如下：</p><p style="color: rgb(75, 75, 75); line-height: 1.5; margin: 10px auto;">1、表的主键、外键必须有索引；</p><p style="color: rgb(75, 75, 75); line-height: 1.5; margin: 10px auto;">2、数据量超过300的表应该有索引；</p><p style="line-height: 1.5; margin: 10px auto;"><span style="color: rgb(75, 75, 75);">3、经常与其他表进行连接的表，</span><font color="#ff0000">在连接字段上应该建立索引；</font></p><p style="color: rgb(75, 75, 75); line-height: 1.5; margin: 10px auto;">4、经常出现在Where子句中的字段，特别是大表的字段，应该建立索引；</p><p style="color: rgb(75, 75, 75); line-height: 1.5; margin: 10px auto;">5、索引应该建在选择性高的字段上；</p><p style="color: rgb(75, 75, 75); line-height: 1.5; margin: 10px auto;">6、索引应该建在小字段上，对于大的文本字段甚至超长字段，不要建索引；</p><p style="line-height: 1.5; margin: 10px auto;"><font color="#ff0000">7、复合索引的建立需要进行仔细分析；尽量考虑用单字段索引代替：</font></p><p style="line-height: 1.5; margin: 10px auto;"><font color="#ff0000">&nbsp;&nbsp; A、正确选择复合索引中的主列字段，一般是选择性较好的字段；</font></p><p style="line-height: 1.5; margin: 10px auto;"><font color="#ff0000">&nbsp;&nbsp; B、复合索引的几个字段是否经常同时以AND方式出现在Where子句中？单字段查询是否极少甚至没有？如果是，则可以建立复合索引；否则考虑单字段索引；</font></p><p style="line-height: 1.5; margin: 10px auto;"><font color="#ff0000">&nbsp;&nbsp; C、如果复合索引中包含的字段经常单独出现在Where子句中，则分解为多个单字段索引；</font></p><p style="line-height: 1.5; margin: 10px auto;"><font color="#ff0000">&nbsp;&nbsp; D、如果复合索引所包含的字段超过3个，那么仔细考虑其必要性，考虑减少复合的字段；</font></p><p style="line-height: 1.5; margin: 10px auto;"><font color="#ff0000">&nbsp;&nbsp; E、如果既有单字段索引，又有这几个字段上的复合索引，一般可以删除复合索引；</font></p><p style="color: rgb(75, 75, 75); line-height: 1.5; margin: 10px auto;">8、频繁进行数据操作的表，不要建立太多的索引；</p><p style="color: rgb(75, 75, 75); line-height: 1.5; margin: 10px auto;">9、删除无用的索引，避免对执行计划造成负面影响；</p><p style="color: rgb(75, 75, 75); line-height: 1.5; margin: 10px auto;">&nbsp;&nbsp; 以上是一些普遍的建立索引时的判断依据。一言以蔽之，索引的建立必须慎重，对每个索引的必要性都应该经过仔细分析，要有建立的依据。因为太多的索引与不充 分、不正确的索引对性能都毫无益处：在表上建立的每个索引都会增加存储开销，索引对于插入、删除、更新操作也会增加处理上的开销。另外，过多的复合索引， 在有单字段索引的情况下，一般都是没有存在价值的；相反，还会降低数据增加删除时的性能，特别是对频繁更新的表来说，负面影响更大。</p><p style="color: rgb(75, 75, 75); line-height: 1.5; margin: 10px auto;">&nbsp;</p><div style="color: rgb(75, 75, 75);"><br><a class="keylink" href="http://www.2cto.com/database/" target="_blank" style="color: rgb(26, 139, 200); text-decoration: none;">数据库</a>创建索引的原则</div><div style="color: rgb(75, 75, 75);">&nbsp;</div><div style="color: rgb(75, 75, 75);">索引可以提高数据的访问速度，但同时也增加了插入、更新和删除操作的处理时间。所以是否要为表增加索引、索引建立在那些字段上，是创建索引前必须要考虑的问题。解决此问题就是分析应用程序的业务处理、数据使用，为经常被用作查询条件、或者被要求排序的字段建立索引。</div><div style="color: rgb(75, 75, 75);">&nbsp;</div><div style="color: rgb(75, 75, 75);">索引是建立在数据库表中的某些列的上面。因此，在创建索引的时候，应该仔细考虑在哪些列上可以创建索引，在哪些列上不能创建索引。</div><div style="color: rgb(75, 75, 75);">&nbsp; www.2cto.com &nbsp;</div><div style="color: rgb(75, 75, 75);">一般选择在这样的列上创建索引：</div><div style="color: rgb(75, 75, 75);">&nbsp;</div><div style="color: rgb(75, 75, 75);">1. &nbsp; &nbsp;在经常需要搜索查询的列上创建索引，可以加快搜索的速度；</div><div style="color: rgb(75, 75, 75);">&nbsp;</div><div style="color: rgb(75, 75, 75);">2. &nbsp; &nbsp;在作为主键的列上创建索引，强制该列的唯一性和组织表中数据的排列结构；</div><div style="color: rgb(75, 75, 75);">&nbsp;</div><div><span style="color: rgb(75, 75, 75);">3. &nbsp; &nbsp;在经常用在连接的列上创建索引，</span><font color="#ff0000">这些列主要是一些外键，可以加快连接的速度；</font></div><div style="color: rgb(75, 75, 75);">&nbsp;</div><div style="color: rgb(75, 75, 75);">4. &nbsp; &nbsp;在经常需要根据范围进行搜索的列上创建索引，因为索引已经排序，其指定的范围是连续的；</div><div style="color: rgb(75, 75, 75);">&nbsp;</div><div style="color: rgb(75, 75, 75);">5. &nbsp; &nbsp;在经常需要排序的列上创建索引，因为索引已经排序，这样查询可以利用索引的排序，加快排序查询 时间；</div><div style="color: rgb(75, 75, 75);">&nbsp;</div><div style="color: rgb(75, 75, 75);">6. &nbsp; &nbsp;在经常使用在Where子句中的列上面创建索引，加快条件的判断速度；</div><div style="color: rgb(75, 75, 75);">&nbsp;</div><div><span style="color: rgb(75, 75, 75);">7. &nbsp; &nbsp;</span><font color="#ff0000">为经常出现在关键字order by、group by、distinct后面的字段，建立索引。</font></div><div style="color: rgb(75, 75, 75);">&nbsp;</div><div style="color: rgb(75, 75, 75);">&nbsp;一般不选择具有这些特点的列上创建索引：</div><div style="color: rgb(75, 75, 75);">&nbsp;</div><div style="color: rgb(75, 75, 75);">1. &nbsp; &nbsp;对于那些在查询中很少使用或者参考的列不应该创建索引。这是因为，既然这些列很少使用到，因此有索引或者无索引，并不能提高查 询速度。相反，由于增加了索引，反而降低了<a class="keylink" href="http://www.2cto.com/os/" target="_blank" style="color: rgb(26, 139, 200); text-decoration: none;">系统</a>的维护速度和增大了空间需求；</div><div style="color: rgb(75, 75, 75);">&nbsp;</div><div style="color: rgb(75, 75, 75);">2. &nbsp; &nbsp;不要在有大量相同取值的字段上，建立索引。这是因为，由于这些列的取值很少，例如人事表的性别列，在查询的结果中，结果集的数据行占了表中数据行的很大比例，即需要在表中搜索的数据行的比例很大。增加索引，并不能明显加 快检索速度；</div><div style="color: rgb(75, 75, 75);">&nbsp;</div><div style="color: rgb(75, 75, 75);">3. &nbsp; &nbsp;对于那些定义为text, image和bit数据类型的列不应该增加索引。这是因为，这些列的数据量要么相当大，要么取值很少；</div><div style="color: rgb(75, 75, 75);">&nbsp;</div><div style="color: rgb(75, 75, 75);">4. &nbsp; &nbsp;当修改性能远远大于检索性能时，不应该创建索引。这是因为，修改性能和检索性能是互相矛盾的。当增加索引时，会提高检索性能，但是会降低修改性能。当减少索引时，会提高修改性能，降低检索性能。因此，当修改性能远远大于检索性能时，不应该创建索引。</div><div style="color: rgb(75, 75, 75);">&nbsp;</div><div style="color: rgb(75, 75, 75);">创建索引需要注意的地方：</div><div style="color: rgb(75, 75, 75);">&nbsp; www.2cto.com &nbsp;</div><div style="color: rgb(75, 75, 75);">1. &nbsp; &nbsp;限制表上的索引数目。对一个存在大量更新操作的表，所建索引的数目一般不要超过3个，最多不要超过5个。索引虽说提高了访问速度，但太多索引会影响数据的更新操作。</div><div style="color: rgb(75, 75, 75);">&nbsp;</div><div><span style="color: rgb(75, 75, 75);">2. &nbsp; &nbsp;</span><font color="#ff0000">避免在取值朝一个方向增长的字段（例如：日期类型的字段）上，建立索引；对复合索引，避免将这种类型的字段放置在最前面。由于字段的取值总是朝一个方向 增长，新记录总是存放在索引的最后一个叶页中，从而不断地引起该叶页的访问竞争、新叶页的分配、中间分支页的拆分。此外，如果所建索引是聚集索引，表中数 据按照索引的排列顺序存放，所有的插入操作都集中在最后一个数据页上进行，从而引起插入“热点”。</font></div><div style="color: rgb(75, 75, 75);">&nbsp;</div><div><span style="color: rgb(75, 75, 75);">3. &nbsp; &nbsp;对复合索引，按照字段在查询条件中出现的频度建立索引。在复合索引中，记录首先按照第一个字段排序。对于在第一个字段上取值相同的记录，系统再按照第二 个字段的取值排序，</span><font color="#ff0000">以此类推。因此只有复合索引的第一个字段出现在查询条件中，该索引才可能被使用。因此将应用频度高的字段，放置在复合索引的前面，会使 系统最大可能地使用此索引，发挥索引的作用。</font></div><div style="color: rgb(75, 75, 75);">&nbsp;</div><p style="color: rgb(75, 75, 75); line-height: 1.5; margin: 10px auto;">4. &nbsp; &nbsp;删除不再使用，或者很少被使用的索引。表中的数据被大量更新，或者数据的使用方式被改变后，原有的一些索引可能不再被需要。数据库管理员应当定期找出这些索引，将它们删除，从而减少索引对更新操作的影响。</p><br><div style="color: gray;"><small>来源：&nbsp;&lt;<a href="http://www.cnblogs.com/net-study/p/3397359.html">http://www.cnblogs.com/net-study/p/3397359.html</a><small>&gt;</small></small></div><small style="color: rgb(75, 75, 75);"><small>&nbsp;</small></small></div></body></html>