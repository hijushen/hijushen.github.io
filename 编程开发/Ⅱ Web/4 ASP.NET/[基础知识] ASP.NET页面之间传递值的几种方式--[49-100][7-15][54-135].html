<!DOCTYPE html>
<html><head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">

<!--defaultCSS-->
<title>[基础知识] ASP.NET页面之间传递值的几种方式--[49/100][7/15][54/135][C#](9/30)</title>



<style type="text/css" id="wiz_custom_css">
body
{
    font-family: Microsoft YaHei UI,"Microsoft YaHei", Georgia,Helvetica,Arial,sans-serif,宋体, PMingLiU,serif;
    font-size: 10.5pt;
    line-height: 1.5;
}
html, body
{
    
    
}
h1 {
    font-size:1.5em;
    font-weight:bold;
}
h2 {
    font-size:1.4em;
    font-weight:bold;
}
h3 {
    font-size:1.3em;
    font-weight:bold;
}
h4 {
    font-size:1.2em;
    font-weight:bold;
}
h5 {
    font-size:1.1em;
    font-weight:bold;
}
h6 {
    font-size:1.0em;
    font-weight:bold;
}
img {
    border:0;
    max-width: 100%;
    height: auto !important;
}
blockquote {
    margin-top:0px;
    margin-bottom:0px;
}
table {
    border-collapse:collapse;
    border:1px solid #bbbbbb;
}
td {
    border-collapse:collapse;
    border:1px solid #bbbbbb;
}
</style>

<style type="text/css" id="wiz_todo_style_id" wiz_link_version="01.00.09">.wiz-todo, .wiz-todo-img {width: 16px; height: 16px; cursor: default; padding: 0 10px 0 2px; vertical-align: -10%;-webkit-user-select: none;} .wiz-todo-label { display: inline-block; padding-top: 7px; padding-bottom: 6px; line-height: 1.5;} .wiz-todo-label-checked {  color: #666;} .wiz-todo-label-unchecked {text-decoration: initial;} .wiz-todo-completed-info {padding-left: 44px; display: inline-block; } .wiz-todo-avatar { width:20px; height: 20px; vertical-align: -20%; margin-right:10px; border-radius: 2px;} .wiz-todo-account, .wiz-todo-dt { color: #666; }</style></head>

<body  style=""><p style="margin: 10px auto; padding: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 13.9200000762939px; line-height: 16.7040004730225px; widows: 1; background-color: rgb(255, 255, 255);"><p style="margin: 10px auto; padding: 0px; font-size: 13.9200000762939px; line-height: 16.7040004730225px;">页面传值是学习asp.net初期都会面临的一个问题，总的来说有页面传值、存储对象传值、ajax、类、model、表单等。但是一般来说，常用的较简单有QueryString，Session，Cookies，Application，Server.Transfer。</p><p style="margin: 10px auto; padding: 0px; font-size: 13.9200000762939px; line-height: 16.7040004730225px;">&nbsp;</p><p style="margin: 10px auto; padding: 0px; font-size: 13.9200000762939px; line-height: 16.7040004730225px;">　　<strong style="margin: 0px; padding: 0px;">一、QueryString</strong></p><p style="margin: 10px auto; padding: 0px; font-size: 13.9200000762939px; line-height: 16.7040004730225px;">　　QueryString是一种非常简单的传值方式，他可以将传送的值显示在浏览器的地址栏中。如果是传递一个或多个安全性要求不高或是结构简单的数值时，可以使用这个方法。但是对于传递数组或对象的话，就不能用这个方法了。</p><p style="margin: 10px auto; padding: 0px; font-size: 13.9200000762939px; line-height: 16.7040004730225px;">　　<span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255);">这种方法的优点：</span>1.使用简单，对于安全性要求不高时传递数字或是文本值非常有效。<br style="margin: 0px; padding: 0px;">　　<span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255);">这种方法的缺点：</span>1.缺乏安全性，由于它的值暴露在浏览器的URL地址中的。<br style="margin: 0px; padding: 0px;">　　　　　　　　　　2.不能传递对象。</p><p style="margin: 10px auto; padding: 0px; font-size: 13.9200000762939px; line-height: 16.7040004730225px;">　　<span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255);">使用方法：</span>1.在源页面的代码中用需要传递的名称和值构造URL地址。<br style="margin: 0px; padding: 0px;">　　　　　　　2.在源页面的代码用Response.Redirect(URL);重定向到上面的URL地址中。<br style="margin: 0px; padding: 0px;">　　　　　　　3.在目的页面的代码使用Request.QueryString["name"];取出URL地址中传递的值。</p><p style="margin: 10px auto; padding: 0px; font-size: 13.9200000762939px; line-height: 16.7040004730225px;">　　<span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255);">例子：</span>(1)a.aspx</p><div class="cnblogs_code" style="margin: 5px 0px; padding: 5px; border: 1px solid rgb(204, 204, 204); overflow: auto; background-color: rgb(245, 245, 245); font-family: 'Courier New' !important; font-size: 12px !important;"><pre style="margin-top: 0px; margin-bottom: 0px; padding: 0px; white-space: pre-wrap; word-wrap: break-word; font-family: 'Courier New' !important;"><span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); line-height: 1.5 !important;">private</span> <span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); line-height: 1.5 !important;">void</span> Button1_Click(<span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); line-height: 1.5 !important;">object</span><span style="margin: 0px; padding: 0px; line-height: 1.5 !important;"> sender, System.EventArgs e) 
{ 
　　</span><span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); line-height: 1.5 !important;">string</span><span style="margin: 0px; padding: 0px; line-height: 1.5 !important;"> s_url; 
　　s_url </span>= <span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); line-height: 1.5 !important;">"</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); line-height: 1.5 !important;">b.aspx?name=</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); line-height: 1.5 !important;">"</span> +<span style="margin: 0px; padding: 0px; line-height: 1.5 !important;"> Label1.Text; 
　　Response.Redirect(s_url); 
}</span></pre></div><p style="margin: 10px auto; padding: 0px; font-size: 13.9200000762939px; line-height: 16.7040004730225px;">　　(2)b.aspx</p><div class="cnblogs_code" style="margin: 5px 0px; padding: 5px; border: 1px solid rgb(204, 204, 204); overflow: auto; background-color: rgb(245, 245, 245); font-family: 'Courier New' !important; font-size: 12px !important;"><pre style="margin-top: 0px; margin-bottom: 0px; padding: 0px; white-space: pre-wrap; word-wrap: break-word; font-family: 'Courier New' !important;"><span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); line-height: 1.5 !important;">private</span> <span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); line-height: 1.5 !important;">void</span> Page_Load(<span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); line-height: 1.5 !important;">object</span><span style="margin: 0px; padding: 0px; line-height: 1.5 !important;"> sender, EventArgs e) 
{ 
　　Label2.Text </span>= Request.QueryString[<span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); line-height: 1.5 !important;">"</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); line-height: 1.5 !important;">name</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); line-height: 1.5 !important;">"</span><span style="margin: 0px; padding: 0px; line-height: 1.5 !important;">]; 
}</span></pre></div><p style="margin: 10px auto; padding: 0px; font-size: 13.9200000762939px; line-height: 16.7040004730225px;">&nbsp;</p><p style="margin: 10px auto; padding: 0px; font-size: 13.9200000762939px; line-height: 16.7040004730225px;">　　<strong style="margin: 0px; padding: 0px;">二、Session</strong></p><p style="margin: 10px auto; padding: 0px; font-size: 13.9200000762939px; line-height: 16.7040004730225px;"><strong style="margin: 0px; padding: 0px;">　　</strong>想必这个肯定是大家使用中最常见的用法了，其操作与Application类似，作用于用户个人，所以，过量的存储会导致服务器内存资源的耗尽。</p><p style="margin: 10px auto; padding: 0px; font-size: 13.9200000762939px; line-height: 16.7040004730225px;">　　<span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255);">优点：</span>1.使用简单，不仅能传递简单数据类型，还能传递对象。<br style="margin: 0px; padding: 0px;">　　　　　2.数据量大小是不限制的。</p><p style="margin: 10px auto; padding: 0px; font-size: 13.9200000762939px; line-height: 16.7040004730225px;">　　<span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255);">缺点：</span>1.在Session变量存储大量的数据会消耗较多的服务器资源。</p><p style="margin: 10px auto; padding: 0px; font-size: 13.9200000762939px; line-height: 16.7040004730225px;">　　　　　2.容易丢失。</p><p style="margin: 10px auto; padding: 0px; font-size: 13.9200000762939px; line-height: 16.7040004730225px;">　　<span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255);">使用方法：</span>1.在源页面的代码中创建你需要传递的名称和值构造Session变量:Session["Name"]="Value(Or Object)";</p><p style="margin: 10px auto; padding: 0px; font-size: 13.9200000762939px; line-height: 16.7040004730225px;">　　　　　　　2.在目的页面的代码使用Session变量取出传递的值。Result = Session["Nmae"]</p><p style="margin: 10px auto; padding: 0px; font-size: 13.9200000762939px; line-height: 16.7040004730225px;">　　<span style="margin: 0px; padding: 0px; color: rgb(255, 0, 0);">注意：</span>session不用时可以销毁它，销毁的方法是：清除一个：Session.Remove("session名");</p><p style="margin: 10px auto; padding: 0px; font-size: 13.9200000762939px; line-height: 16.7040004730225px;">　　　　　　　　　　　　　　　　　　　　　　　　　清除所有：Session.Clear();</p><p style="margin: 10px auto; padding: 0px; font-size: 13.9200000762939px; line-height: 16.7040004730225px;">　　<span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255);">例子：</span>(1)a.aspx</p><div class="cnblogs_code" style="margin: 5px 0px; padding: 5px; border: 1px solid rgb(204, 204, 204); overflow: auto; background-color: rgb(245, 245, 245); font-family: 'Courier New' !important; font-size: 12px !important;"><pre style="margin-top: 0px; margin-bottom: 0px; padding: 0px; white-space: pre-wrap; word-wrap: break-word; font-family: 'Courier New' !important;"><span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); line-height: 1.5 !important;">private</span> <span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); line-height: 1.5 !important;">void</span> Button1_Click(<span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); line-height: 1.5 !important;">object</span><span style="margin: 0px; padding: 0px; line-height: 1.5 !important;"> sender, System.EventArgs e) 
{ 
　　Session[</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); line-height: 1.5 !important;">"</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); line-height: 1.5 !important;">name</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); line-height: 1.5 !important;">"</span>] =<span style="margin: 0px; padding: 0px; line-height: 1.5 !important;"> Label.Text; 
}</span></pre></div><p style="margin: 10px auto; padding: 0px; font-size: 13.9200000762939px; line-height: 16.7040004730225px;">　　(2)b.aspx</p><div class="cnblogs_code" style="margin: 5px 0px; padding: 5px; border: 1px solid rgb(204, 204, 204); overflow: auto; background-color: rgb(245, 245, 245); font-family: 'Courier New' !important; font-size: 12px !important;"><pre style="margin-top: 0px; margin-bottom: 0px; padding: 0px; white-space: pre-wrap; word-wrap: break-word; font-family: 'Courier New' !important;"><span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); line-height: 1.5 !important;">private</span> <span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); line-height: 1.5 !important;">void</span> Page_Load(<span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); line-height: 1.5 !important;">object</span><span style="margin: 0px; padding: 0px; line-height: 1.5 !important;"> sender, EventArgs e) 
{ 
　　</span><span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); line-height: 1.5 !important;">string</span><span style="margin: 0px; padding: 0px; line-height: 1.5 !important;"> name; 
　　name </span>= Session[<span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); line-height: 1.5 !important;">"</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); line-height: 1.5 !important;">name</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); line-height: 1.5 !important;">"</span><span style="margin: 0px; padding: 0px; line-height: 1.5 !important;">].ToString(); 
}</span></pre></div><p style="margin: 10px auto; padding: 0px; font-size: 13.9200000762939px; line-height: 16.7040004730225px;">&nbsp;</p><p style="margin: 10px auto; padding: 0px; font-size: 13.9200000762939px; line-height: 16.7040004730225px;"><strong style="margin: 0px; padding: 0px;">　　三、Cookie</strong></p><p style="margin: 10px auto; padding: 0px; font-size: 13.9200000762939px; line-height: 16.7040004730225px;"><strong style="margin: 0px; padding: 0px;">　　</strong>这个也是大家常使用的方法，Cookie用于在用户浏览器上存储小块的信息，保存用户的相关信息，比如用户访问某网站时用户的ID，用户的偏好等，用户下次访问就可以通过检索获得以前的信息。所以Cookie也可以在页面间传递值。Cookie通过HTTP头在浏览器和服务器之间来回传递的。Cookie只能包含字符串的值，如果想在Cookie存储整数值，那么需要先转换为字符串的形式。</p><p style="margin: 10px auto; padding: 0px; font-size: 13.9200000762939px; line-height: 16.7040004730225px;">　　与Session一样，其是什对每一个用户而言的，但是有个本质的区别，即Cookie是存放在客户端的，而session是存放在服务器端的。而且Cookie的使用要配合ASP.NET内置对象Request来使用。</p><p style="margin: 10px auto; padding: 0px; font-size: 13.9200000762939px; line-height: 16.7040004730225px;">　　<span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255);">优点：</span>1.使用简单，是保持用户状态的一种非常常用的方法。比如在购物网站中用户跨多个页面表单时可以用它来保持用户状态。</p><p style="margin: 10px auto; padding: 0px; font-size: 13.9200000762939px; line-height: 16.7040004730225px;">　　<span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255);">缺点：</span>1.常常被人认为用来收集用户隐私而遭到批评。</p><p style="margin: 10px auto; padding: 0px; font-size: 13.9200000762939px; line-height: 16.7040004730225px;">　　　　　2.安全性不高，容易伪造。</p><p style="margin: 10px auto; padding: 0px; font-size: 13.9200000762939px; line-height: 16.7040004730225px;">　　</p><p style="margin: 10px auto; padding: 0px; font-size: 13.9200000762939px; line-height: 16.7040004730225px;">　　<span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255);">使用方法：</span>1.在源页面的代码中创建你需要传递的名称和值构造Cookie对象:</p><div class="cnblogs_code" style="margin: 5px 0px; padding: 5px; border: 1px solid rgb(204, 204, 204); overflow: auto; background-color: rgb(245, 245, 245); font-family: 'Courier New' !important; font-size: 12px !important;"><pre style="margin-top: 0px; margin-bottom: 0px; padding: 0px; white-space: pre-wrap; word-wrap: break-word; font-family: 'Courier New' !important;">HttpCookie objCookie = <span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); line-height: 1.5 !important;">new</span> HttpCookie(<span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); line-height: 1.5 !important;">"</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); line-height: 1.5 !important;">myCookie</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); line-height: 1.5 !important;">"</span>,<span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); line-height: 1.5 !important;">"</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); line-height: 1.5 !important;">Hello,Cookie!</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); line-height: 1.5 !important;">"</span><span style="margin: 0px; padding: 0px; line-height: 1.5 !important;">);
Response.Cookies.Add(cookie); </span></pre></div><p style="margin: 10px auto; padding: 0px; font-size: 13.9200000762939px; line-height: 16.7040004730225px;">　　　　　　2.在目的页面的代码使用Cookie对象取出传递的值：Result = Request.Cookies[ "myCookie" ].Value;</p><p style="margin: 10px auto; padding: 0px; font-size: 13.9200000762939px; line-height: 16.7040004730225px;">　　<span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255);">例子：</span>(1)a.aspx</p><div class="cnblogs_code" style="margin: 5px 0px; padding: 5px; border: 1px solid rgb(204, 204, 204); overflow: auto; background-color: rgb(245, 245, 245); font-family: 'Courier New' !important; font-size: 12px !important;"><pre style="margin-top: 0px; margin-bottom: 0px; padding: 0px; white-space: pre-wrap; word-wrap: break-word; font-family: 'Courier New' !important;"><span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); line-height: 1.5 !important;">private</span> <span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); line-height: 1.5 !important;">void</span> Button1_Click(<span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); line-height: 1.5 !important;">object</span><span style="margin: 0px; padding: 0px; line-height: 1.5 !important;"> sender, System.EventArgs e)
{
　　HttpCookie objCookie </span>= <span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); line-height: 1.5 !important;">new</span> HttpCookie(<span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); line-height: 1.5 !important;">"</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); line-height: 1.5 !important;">myCookie</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); line-height: 1.5 !important;">"</span>,<span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); line-height: 1.5 !important;">"</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); line-height: 1.5 !important;">Hello,Cookie!</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); line-height: 1.5 !important;">"</span><span style="margin: 0px; padding: 0px; line-height: 1.5 !important;">);
　　Response.Cookies.Add(objCookie); 
}</span></pre></div><p style="margin: 10px auto; padding: 0px; font-size: 13.9200000762939px; line-height: 16.7040004730225px;">　　(2)b.aspx</p><div class="cnblogs_code" style="margin: 5px 0px; padding: 5px; border: 1px solid rgb(204, 204, 204); overflow: auto; background-color: rgb(245, 245, 245); font-family: 'Courier New' !important; font-size: 12px !important;"><pre style="margin-top: 0px; margin-bottom: 0px; padding: 0px; white-space: pre-wrap; word-wrap: break-word; font-family: 'Courier New' !important;"><span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); line-height: 1.5 !important;">string</span><span style="margin: 0px; padding: 0px; line-height: 1.5 !important;"> myName1Value;
myName1Value </span>= Request.Cookies[ <span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); line-height: 1.5 !important;">"</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); line-height: 1.5 !important;">myCookie</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); line-height: 1.5 !important;">"</span> ].Value;</pre></div><p style="margin: 10px auto; padding: 0px; font-size: 13.9200000762939px; line-height: 16.7040004730225px;">&nbsp;</p><p style="margin: 10px auto; padding: 0px; font-size: 13.9200000762939px; line-height: 16.7040004730225px;">　　<strong style="margin: 0px; padding: 0px;">四、Application</strong></p><p style="margin: 10px auto; padding: 0px; font-size: 13.9200000762939px; line-height: 16.7040004730225px;">　　Application对象的作用范围是整个全局，也就是说对所有用户都有效。它在整个应用程序生命周期中都是有效的，类似于使用全局变量一样，所以可以在不同页面中对它进行存取。它和Session变量的区别在于，前者是所有的用户共用的全局变量，后者是各个用户独有的全局变量。</p><p style="margin: 10px auto; padding: 0px; font-size: 13.9200000762939px; line-height: 16.7040004730225px;">　　可能有人会问，既然所有用户都可以使用application变量，那他可以用在什么场合呢？这里举个例子：网站访问数。多个请求访问时都可以对它进行操作。</p><p style="margin: 10px auto; padding: 0px; font-size: 13.9200000762939px; line-height: 16.7040004730225px;">　　<span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255);">优点：</span>1.使用简单，消耗较少的服务器资源。</p><p style="margin: 10px auto; padding: 0px; font-size: 13.9200000762939px; line-height: 16.7040004730225px;">　　　　　2.不仅能传递简单数据，还能传递对象。</p><p style="margin: 10px auto; padding: 0px; font-size: 13.9200000762939px; line-height: 16.7040004730225px;">　　　　　3.数据量大小是不限制的。</p><p style="margin: 10px auto; padding: 0px; font-size: 13.9200000762939px; line-height: 16.7040004730225px;">　　<span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255);">缺点：</span>1.作为全局变量容易被误操作。所以单个用户使用的变量一般不能用application。</p><p style="margin: 10px auto; padding: 0px; font-size: 13.9200000762939px; line-height: 16.7040004730225px;">　　<span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255);">使用方法：</span>1.在源页面的代码中创建你需要传递的名称和值构造Application变量:Application["Nmae"]="Value(Or Object)";</p><p style="margin: 10px auto; padding: 0px; font-size: 13.9200000762939px; line-height: 16.7040004730225px;">　　　　　　　2.在目的页面的代码使用Application变量取出传递的值。Result = Application["Nmae"]</p><p style="margin: 10px auto; padding: 0px; font-size: 13.9200000762939px; line-height: 16.7040004730225px;">　　<span style="margin: 0px; padding: 0px; color: rgb(255, 0, 0);">注意：</span>常用lock和unlock方法用来锁定和解锁，为了防止并发修改。</p><p style="margin: 10px auto; padding: 0px; font-size: 13.9200000762939px; line-height: 16.7040004730225px;">　　<span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255);">例子：</span>(1)a.aspx</p><div class="cnblogs_code" style="margin: 5px 0px; padding: 5px; border: 1px solid rgb(204, 204, 204); overflow: auto; background-color: rgb(245, 245, 245); font-family: 'Courier New' !important; font-size: 12px !important;"><pre style="margin-top: 0px; margin-bottom: 0px; padding: 0px; white-space: pre-wrap; word-wrap: break-word; font-family: 'Courier New' !important;"><span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); line-height: 1.5 !important;">private</span> <span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); line-height: 1.5 !important;">void</span> Button1_Click(<span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); line-height: 1.5 !important;">object</span><span style="margin: 0px; padding: 0px; line-height: 1.5 !important;"> sender, System.EventArgs e) 
{ 
　　Application[</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); line-height: 1.5 !important;">"</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); line-height: 1.5 !important;">name</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); line-height: 1.5 !important;">"</span>] =<span style="margin: 0px; padding: 0px; line-height: 1.5 !important;"> Label1.Text; </span><span style="margin: 0px; padding: 0px; line-height: 1.5 !important;">
}</span></pre></div><p style="margin: 10px auto; padding: 0px; font-size: 13.9200000762939px; line-height: 16.7040004730225px;">　　(2)b.aspx</p><div class="cnblogs_code" style="margin: 5px 0px; padding: 5px; border: 1px solid rgb(204, 204, 204); overflow: auto; background-color: rgb(245, 245, 245); font-family: 'Courier New' !important; font-size: 12px !important;"><div class="cnblogs_code_toolbar" style="margin: 5px 0px 0px; padding: 0px;"><span class="cnblogs_code_copy" style="margin: 0px; padding: 0px 5px 0px 0px; line-height: 1.5 !important;"><a href="" title="复制代码" style="margin: 0px; padding: 1px 3px; color: green; text-decoration: none; border: none !important;"><img src="[基础知识] ASP.NET页面之间传递值的几种方式--[49-100][7-15][54-135]_files/6834ec00-569e-47a1-b156-e28519753e87.gif" alt="复制代码" style="margin: 0px; padding: 0px; border-style: none !important;"></a></span></div><pre style="margin-top: 0px; margin-bottom: 0px; padding: 0px; white-space: pre-wrap; word-wrap: break-word; font-family: 'Courier New' !important;"><span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); line-height: 1.5 !important;">private</span> <span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); line-height: 1.5 !important;">void</span> Page_Load(<span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); line-height: 1.5 !important;">object</span><span style="margin: 0px; padding: 0px; line-height: 1.5 !important;"> sender, EventArgs e) 
{ 
　　</span><span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); line-height: 1.5 !important;">string</span><span style="margin: 0px; padding: 0px; line-height: 1.5 !important;"> name; 
　　Application.Lock(); 
　　name </span>= Application[<span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); line-height: 1.5 !important;">"</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); line-height: 1.5 !important;">name</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); line-height: 1.5 !important;">"</span><span style="margin: 0px; padding: 0px; line-height: 1.5 !important;">].ToString(); 
　　Application.UnLock(); 
}</span></pre><div class="cnblogs_code_toolbar" style="margin: 5px 0px 0px; padding: 0px;"><span class="cnblogs_code_copy" style="margin: 0px; padding: 0px 5px 0px 0px; line-height: 1.5 !important;"><a href="" title="复制代码" style="margin: 0px; padding: 1px 3px; color: green; text-decoration: none; border: none !important;"><img src="[基础知识] ASP.NET页面之间传递值的几种方式--[49-100][7-15][54-135]_files/6834ec00-569e-47a1-b156-e28519753e87.gif" alt="复制代码" style="margin: 0px; padding: 0px; border-style: none !important;"></a></span></div></div><p style="margin: 10px auto; padding: 0px; font-size: 13.9200000762939px; line-height: 16.7040004730225px;">&nbsp;</p><p style="margin: 10px auto; padding: 0px; font-size: 13.9200000762939px; line-height: 16.7040004730225px;">　　<strong style="margin: 0px; padding: 0px;">五、Server.Transfer</strong></p><p style="margin: 10px auto; padding: 0px; font-size: 13.9200000762939px; line-height: 16.7040004730225px;"><strong style="margin: 0px; padding: 0px;">　　</strong>这个才可以说是面象对象开发所使用的方法，其使用Server.Transfer方法把流程从当前页面引导到另一个页面中，新的页面使用前一个页面的应答流，所以这个方法是完全面象对象的，简洁有效。</p><p style="margin: 10px auto; padding: 0px; font-size: 13.9200000762939px; line-height: 16.7040004730225px;">　　Server.Transfer是从当前的ASPX页面转到新的ASPX页面，服务器端执行新页并输出,在新页面中通过Context.Handler来获得前一个页面传递的各种数据类型的值、表单数据、QueryString.由于重定向完全在服务器端完成，所以客户端浏览器中的URL地址是不会改变的。调用Server.Transfer时，当前的ASPX页面终止执行，执行流程转入另一个ASPX页面，但新的ASPX页面仍使用前一ASPX页面创建的应答流。</p><p style="margin: 10px auto; padding: 0px; font-size: 13.9200000762939px; line-height: 16.7040004730225px;">　　<span style="margin: 0px; padding: 0px; color: rgb(255, 0, 0);">ps：比较Server.Transfer和Response.Redirect的区别。</span><br style="margin: 0px; padding: 0px;">　　　　(1)Server.Transfer在服务器端完成，所以客户端浏览器中的URL地址是不会改变的；Response.Redirect是客户端完成，向服务器端提出新的页面处理请求，所以客户端浏览器中的URL地址是会改变的。<br style="margin: 0px; padding: 0px;">　　　　(2)Server.Transfer在服务器端完成,不需要客户端提出请求，减少了客户端对服务器端提出请求。[2]<br style="margin: 0px; padding: 0px;">　　　　(3)Server.Transfer只能够转跳到本地虚拟目录指定的页面,也就是工程项目中的页面，而Response.Redirect则十分灵活,可以跳转到任何URL地址。<br style="margin: 0px; padding: 0px;">　　　　(4)Server.Transfer可以将前一个页面的各种类型的值传到新的页面；Response.Redirect则只能借助URL中带参数或是结合上面四种办法把各种类型的值传到新的页面。</p><p style="margin: 10px auto; padding: 0px; font-size: 13.9200000762939px; line-height: 16.7040004730225px;">　　<span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255);">优点：</span>1.直接在服务器端重定向，使用简单方便，减少了客户端对服务器端提出请求。</p><p style="margin: 10px auto; padding: 0px; font-size: 13.9200000762939px; line-height: 16.7040004730225px;">　　　　　2.可以传递各种数据类型的值和控件的值。</p><p style="margin: 10px auto; padding: 0px; font-size: 13.9200000762939px; line-height: 16.7040004730225px;">　　<span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255);">缺点：</span>1.客户端浏览器中的URL地址是不改变，会导致在新的页面可能出现一些意想不到的问题。比如如果源页面和目的页面不在同一个虚拟目录或其子目录下，那么使用相对路径的图片、超链接都会导致错误的指向。</p><p style="margin: 10px auto; padding: 0px; font-size: 13.9200000762939px; line-height: 16.7040004730225px;">　　<span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255);">使用方法：</span>1.在源页面的代码中，使用Page类的Server.Transfer跳到另一个页面传递页面数据：Server.Transfer("b.aspx","false")。</p><p style="margin: 10px auto; padding: 0px; font-size: 13.9200000762939px; line-height: 16.7040004730225px;">　　　　　　　2.在目的页面中，使用Context.Handler来接收数据：FormerPage formerPage = (FormerPage)Context.Handler;&nbsp;然后用formerPage的属性和方法来获取前一个页面的值，或者直接用Context.Items["myParameter "]</p><p style="margin: 10px auto; padding: 0px; font-size: 13.9200000762939px; line-height: 16.7040004730225px;">　　<span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255);">例子：</span>(1)a.aspx</p><div class="cnblogs_code" style="margin: 5px 0px; padding: 5px; border: 1px solid rgb(204, 204, 204); overflow: auto; background-color: rgb(245, 245, 245); font-family: 'Courier New' !important; font-size: 12px !important;"><div class="cnblogs_code_toolbar" style="margin: 5px 0px 0px; padding: 0px;"><span class="cnblogs_code_copy" style="margin: 0px; padding: 0px 5px 0px 0px; line-height: 1.5 !important;"><a href="" title="复制代码" style="margin: 0px; padding: 1px 3px; color: green; text-decoration: none; border: none !important;"><img src="[基础知识] ASP.NET页面之间传递值的几种方式--[49-100][7-15][54-135]_files/6834ec00-569e-47a1-b156-e28519753e87.gif" alt="复制代码" style="margin: 0px; padding: 0px; border-style: none !important;"></a></span></div><pre style="margin-top: 0px; margin-bottom: 0px; padding: 0px; white-space: pre-wrap; word-wrap: break-word; font-family: 'Courier New' !important;"><span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); line-height: 1.5 !important;">public</span> <span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); line-height: 1.5 !important;">string</span><span style="margin: 0px; padding: 0px; line-height: 1.5 !important;"> Name 
{ 
　　</span><span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); line-height: 1.5 !important;">get</span>{ <span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); line-height: 1.5 !important;">return</span><span style="margin: 0px; padding: 0px; line-height: 1.5 !important;"> Label1.Text;} 
} 
</span><span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); line-height: 1.5 !important;">private</span> <span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); line-height: 1.5 !important;">void</span> Button1_Click(<span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); line-height: 1.5 !important;">object</span><span style="margin: 0px; padding: 0px; line-height: 1.5 !important;"> sender, System.EventArgs e) 
{ 
　　Server.Transfer(</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); line-height: 1.5 !important;">"</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); line-height: 1.5 !important;">b.aspx</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); line-height: 1.5 !important;">"</span><span style="margin: 0px; padding: 0px; line-height: 1.5 !important;">); 
}</span></pre><div class="cnblogs_code_toolbar" style="margin: 5px 0px 0px; padding: 0px;"><span class="cnblogs_code_copy" style="margin: 0px; padding: 0px 5px 0px 0px; line-height: 1.5 !important;"><a href="" title="复制代码" style="margin: 0px; padding: 1px 3px; color: green; text-decoration: none; border: none !important;"><img src="[基础知识] ASP.NET页面之间传递值的几种方式--[49-100][7-15][54-135]_files/6834ec00-569e-47a1-b156-e28519753e87.gif" alt="复制代码" style="margin: 0px; padding: 0px; border-style: none !important;"></a></span></div></div><p style="margin: 10px auto; padding: 0px; font-size: 13.9200000762939px; line-height: 16.7040004730225px;">　　　　(2)b.aspx</p><div class="cnblogs_code" style="margin: 5px 0px; padding: 5px; border: 1px solid rgb(204, 204, 204); overflow: auto; background-color: rgb(245, 245, 245); font-family: 'Courier New' !important; font-size: 12px !important;"><div class="cnblogs_code_toolbar" style="margin: 5px 0px 0px; padding: 0px;"><span class="cnblogs_code_copy" style="margin: 0px; padding: 0px 5px 0px 0px; line-height: 1.5 !important;"><a href="" title="复制代码" style="margin: 0px; padding: 1px 3px; color: green; text-decoration: none; border: none !important;"><img src="[基础知识] ASP.NET页面之间传递值的几种方式--[49-100][7-15][54-135]_files/6834ec00-569e-47a1-b156-e28519753e87.gif" alt="复制代码" style="margin: 0px; padding: 0px; border-style: none !important;"></a></span></div><pre style="margin-top: 0px; margin-bottom: 0px; padding: 0px; white-space: pre-wrap; word-wrap: break-word; font-family: 'Courier New' !important;"><span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); line-height: 1.5 !important;">private</span> <span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); line-height: 1.5 !important;">void</span> Page_Load(<span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); line-height: 1.5 !important;">object</span><span style="margin: 0px; padding: 0px; line-height: 1.5 !important;"> sender, EventArgs e) 
{ 
　　a newWeb; </span><span style="margin: 0px; padding: 0px; color: rgb(0, 128, 0); line-height: 1.5 !important;">//</span><span style="margin: 0px; padding: 0px; color: rgb(0, 128, 0); line-height: 1.5 !important;">实例a窗体 </span>
　　newWeb =<span style="margin: 0px; padding: 0px; line-height: 1.5 !important;"> (source)Context.Handler; 
　　</span><span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); line-height: 1.5 !important;">string</span><span style="margin: 0px; padding: 0px; line-height: 1.5 !important;"> name; 
　　name </span>=<span style="margin: 0px; padding: 0px; line-height: 1.5 !important;"> newWeb.Name; 
}</span></pre><div class="cnblogs_code_toolbar" style="margin: 5px 0px 0px; padding: 0px;"><span class="cnblogs_code_copy" style="margin: 0px; padding: 0px 5px 0px 0px; line-height: 1.5 !important;"><a href="" title="复制代码" style="margin: 0px; padding: 1px 3px; color: green; text-decoration: none; border: none !important;"><img src="[基础知识] ASP.NET页面之间传递值的几种方式--[49-100][7-15][54-135]_files/6834ec00-569e-47a1-b156-e28519753e87.gif" alt="复制代码" style="margin: 0px; padding: 0px; border-style: none !important;"></a></span></div></div><p style="margin: 10px auto; padding: 0px; font-size: 13.9200000762939px; line-height: 16.7040004730225px;">&nbsp;</p><p style="margin: 10px auto; padding: 0px; font-size: 13.9200000762939px; line-height: 16.7040004730225px;">　　以上就是常用的几种页面间传值的方法，我一般使用session和querystring来传值，少数情况会使用到cookie。本篇文章仅仅是介绍这几种方法的使用方法，内部原理没有过多的解释，关于session的存储方式请参见：<a href="http://www.cnblogs.com/zhangkai2237/archive/2012/03/22/2410890.html" target="_blank" style="margin: 0px; padding: 1px 3px; color: green; text-decoration: none;">session的存储方式和配置</a></p><br><div style="color:gray"><small>来源：&nbsp;&lt;<a href="http://www.cnblogs.com/zhangkai2237/archive/2012/05/06/2486462.html">http://www.cnblogs.com/zhangkai2237/archive/2012/05/06/2486462.html</a><small>&gt;</small></small></div><small><small>&nbsp;</small></small></p></body></html>