<!DOCTYPE HTML><html><head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">

<!--defaultCSS-->
<title>周旭龙 webForm 基础笔记</title>





<style type="text/css" id="wiz_todo_style_id" wiz_link_version="01.00.09">.wiz-todo, .wiz-todo-img {width: 16px; height: 16px; cursor: default; padding: 0 10px 0 2px; vertical-align: -10%;-webkit-user-select: none;} .wiz-todo-label { display: inline-block; padding-top: 7px; padding-bottom: 6px; line-height: 1.5;} .wiz-todo-label-checked {  color: #666;} .wiz-todo-label-unchecked {text-decoration: initial;} .wiz-todo-completed-info {padding-left: 44px; display: inline-block; } .wiz-todo-avatar { width:20px; height: 20px; vertical-align: -20%; margin-right:10px; border-radius: 2px;} .wiz-todo-account, .wiz-todo-dt { color: #666; }</style>



<style id="wiz_custom_css">        html, body {            font-size: 15px;        }        body {            font-family: Helvetica, 'Hiragino Sans GB', '微软雅黑', 'Microsoft YaHei UI', SimSun, SimHei, arial, sans-serif;            line-height: 1.6;            margin: 0;            padding: 20px 36px;            padding: 1.33rem 2.4rem;        }        h1, h2, h3, h4, h5, h6 {            margin: 20px 0 10px;            margin: 1.33rem 0 0.667rem;            padding: 0;            font-weight: bold;        }        h1 {            font-size: 21px;            font-size: 1.4rem;        }        h2 {            font-size: 20px;            font-size: 1.33rem;        }        h3 {            font-size: 18px;            font-size: 1.2rem;        }        h4 {            font-size: 17px;            font-size: 1.13rem;        }        h5 {            font-size: 15px;            font-size: 1rem;        }        h6 {            font-size: 15px;            font-size: 1rem;            color: #777777;            margin: 1rem 0;        }        div, p, ul, ol, dl, li {            margin: 0;        }        blockquote, table, pre, code {            margin: 8px 0;        }        ul, ol {            padding-left: 32px;            padding-left: 2.13rem;        }        blockquote {            padding: 0 12px;            padding: 0 0.8rem;        }        blockquote > :first-child {            margin-top: 0;        }        blockquote > :last-child {            margin-bottom: 0;        }        img {            border: 0;            max-width: 100%;            height: auto !important;            margin: 2px 0;        }        table {            border-collapse: collapse;            border: 1px solid #bbbbbb;        }        td {            padding: 4px 8px;            border-collapse: collapse;            border: 1px solid #bbbbbb;        }        @media screen and (max-width: 660px) {            body {                padding: 20px 18px;                padding: 1.33rem 1.2rem;            }        }        @media only screen and (-webkit-max-device-width: 1024px), only screen and (-o-max-device-width: 1024px), only screen and (max-device-width: 1024px), only screen and (-webkit-min-device-pixel-ratio: 3), only screen and (-o-min-device-pixel-ratio: 3), only screen and (min-device-pixel-ratio: 3) {            html, body {                font-size: 17px;            }            body {                line-height: 1.7;                padding: 0.75rem 0.9375rem;                color: #353c47;            }            h1 {                font-size: 2.125rem;            }            h2 {                font-size: 1.875rem;            }            h3 {                font-size: 1.625rem;            }            h4 {                font-size: 1.375rem;            }            h5 {                font-size: 1.125rem;            }            h6 {                color: inherit;            }            ul, ol {                padding-left: 2.5rem;            }            blockquote {                padding: 0 0.9375rem;            }        }</style></head>

<body style="" ><h2><hr style="font-size: 15.555556297302246px; font-weight: normal; line-height: 26.666667938232422px;"><h2>ASP.Net WebForm控件总结--[44/100][7/15][49/135][C#](4/30) (2015-07-27 14:57:22)</h2><span style="font-size: 15.555556297302246px; font-weight: normal; line-height: 26.666667938232422px;">引用文章:&nbsp;</span><a href="http://www.cnblogs.com/edisonchou/p/3899123.html" style="font-size: 15.555556297302246px; font-weight: normal; line-height: 26.666667938232422px;">http://www.cnblogs.com/edisonchou/p/3899123.html</a><span style="font-size: 15.555556297302246px; font-weight: normal; line-height: 26.666667938232422px;">&nbsp;</span><div style="font-size: 15.555556297302246px; font-weight: normal; line-height: 26.666667938232422px;"><br></div><div style="font-size: 15.555556297302246px; font-weight: normal; line-height: 26.666667938232422px;"><p style="margin: 10px auto; padding: 0px; font-family: 微软雅黑; font-size: 13.9200000762939px; line-height: 16.7040004730225px; widows: 1; background-color: rgb(255, 255, 255);"><span style="margin: 0px; padding: 0px; font-family: 仿宋;"><strong style="margin: 0px; padding: 0px;"><span style="margin: 0px; padding: 0px; font-family: 'Microsoft YaHei';">开篇：</span>毫无疑问，<span style="margin: 0px; padding: 0px; font-family: verdana, geneva;">ASP.Net WebForm</span>是微软推出的一个跨时代的<span style="margin: 0px; padding: 0px; font-family: verdana, geneva;">Web</span>开发模式，它将<span style="margin: 0px; padding: 0px; font-family: verdana, geneva;">WinForm</span>开发模式的快捷便利的优点移植到了<span style="margin: 0px; padding: 0px; font-family: verdana, geneva;">Web</span>开发上，我们只要学会三步：拖控件→设属性<strong style="margin: 0px; padding: 0px;">→绑事件，</strong>便可以行走于天下。但这样真的就可以走一辈子吗？实际上，<span style="margin: 0px; padding: 0px; font-family: verdana, geneva;">ASP.Net</span>经常被喷的诟病就在于<span style="margin: 0px; padding: 0px; font-family: verdana, geneva;">WebForm</span>以及只会拖控件的<span style="margin: 0px; padding: 0px; font-family: verdana, geneva;">ASP.Net</span>程序员，往往大型互联网系统也没有采用<span style="margin: 0px; padding: 0px; font-family: verdana, geneva;">WebForm</span>的模式进行开发。但是，<span style="margin: 0px; padding: 0px; font-family: verdana, geneva;">WebForm</span>并不是一无是处，而是我们没有用好，还有很多东西我们知其然不知其所以然，现在我们就来对这些平时所不注意但又十分关键的东西一探究竟。</strong></span></p><h1 style="padding-top: 5px; padding-bottom: 5px; padding-left: 20px; font-size: 17px; border-top-left-radius: 6px; border-top-right-radius: 6px; border-bottom-right-radius: 6px; border-bottom-left-radius: 6px; box-shadow: rgb(95, 90, 75) 0px 0px 0px 1px, rgba(10, 10, 0, 0.498039) 1px 1px 6px 1px; color: white; font-family: 微软雅黑, 宋体, 黑体, Arial; height: 25px; line-height: 25px; text-shadow: rgb(34, 34, 34) 2px 2px 3px; width: 601.400024414063px; widows: 1; background-color: rgb(43, 102, 149); margin-top: 15px !important; margin-bottom: 15px !important;">一、神秘不神秘—aspx探秘</h1><h2 style="margin: 15px auto 2px; font-size: 21px; font-family: 微软雅黑; widows: 1; background-color: rgb(255, 255, 255);"><strong style="margin: 0px; padding: 0px;">1.1 WebForm时代的请求对象</strong></h2><p style="margin: 10px auto; padding: 0px; font-family: 微软雅黑; font-size: 13.9200000762939px; line-height: 16.7040004730225px; widows: 1; background-color: rgb(255, 255, 255);"><img src="周旭龙 webForm 基础笔记_files/b9c8b735-ad73-4a8d-bc61-40c5359dcf0c.png" alt="aspx" width="622" height="259" style="margin: 0px auto; padding: 0px; display: block; width: 620px;"></p><p style="margin: 10px auto; padding: 0px; font-family: 微软雅黑; font-size: 13.9200000762939px; line-height: 16.7040004730225px; widows: 1; background-color: rgb(255, 255, 255);">　　在WebForm中，所有的页面请求都是以aspx文件作为请求对象（静态化和伪静态的除外）。例如上图中，访问者在浏览器端通过输入URL：blog/index.aspx向服务器端发送请求，服务器端首先找到这个index.aspx，然后创建页面对象（index.aspx.cs文件中的类对象），调用这个页面对象中的ProcessRequest方法和Page_Load方法（在此过程中，有可能需要访问数据库）来生成aspx页面的所有html内容，最后将生成好的html返回给浏览器端。</p><p style="margin: 10px auto; padding: 0px; font-family: 微软雅黑; font-size: 13.9200000762939px; line-height: 16.7040004730225px; widows: 1; background-color: rgb(255, 255, 255);">　　因此，我们可以知道，服务器端对aspx的处理过程其实就是一个<strong style="margin: 0px; padding: 0px;">渲染生成html的过程</strong>。</p><h2 style="margin: 15px auto 2px; font-size: 21px; font-family: 微软雅黑; widows: 1; background-color: rgb(255, 255, 255);">1.2&nbsp;<strong style="margin: 0px; padding: 0px;">神奇的&lt;%%&gt;</strong></h2><p style="margin: 10px auto; padding: 0px; font-family: 微软雅黑; font-size: 13.9200000762939px; line-height: 16.7040004730225px; widows: 1; background-color: rgb(255, 255, 255);">　　通过实践可知，在aspx中除了&lt;%%&gt;的内容和runat="server"的内容，其他都是原样输出。这是因为我们在aspx中可以借助&lt;%%&gt;写入C#代码，就跟ASP、PHP一样的风格。但是，在实际开发中并不建议这么来做，因为它违反了CodeBehind的原则，不利于职责的分离。</p><p style="margin: 10px auto; padding: 0px; font-family: 微软雅黑; font-size: 13.9200000762939px; line-height: 16.7040004730225px; widows: 1; background-color: rgb(255, 255, 255);">　　①直接写入C#业务逻辑代码</p><div class="cnblogs_code" style="margin-top: 5px; margin-bottom: 5px; padding: 5px; border: 1px solid rgb(204, 204, 204); overflow: auto; widows: 1; background-color: rgb(245, 245, 245); font-family: 'Courier New' !important; font-size: 12px !important;"><pre style="margin-top: 0px; margin-bottom: 0px; padding: 0px; white-space: pre-wrap; word-wrap: break-word; font-family: 'Courier New' !important;"><span style="margin: 0px; padding: 0px; color: rgb(0, 128, 128); line-height: 1.5 !important;">1</span>         &lt;%
<span style="margin: 0px; padding: 0px; color: rgb(0, 128, 128); line-height: 1.5 !important;">2</span>             <span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); line-height: 1.5 !important;">for</span> (<span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); line-height: 1.5 !important;">int</span> i = <span style="margin: 0px; padding: 0px; color: rgb(128, 0, 128); line-height: 1.5 !important;">0</span>; i &lt; <span style="margin: 0px; padding: 0px; color: rgb(128, 0, 128); line-height: 1.5 !important;">5</span>; i++<span style="margin: 0px; padding: 0px; line-height: 1.5 !important;">)
</span><span style="margin: 0px; padding: 0px; color: rgb(0, 128, 128); line-height: 1.5 !important;">3</span> <span style="margin: 0px; padding: 0px; line-height: 1.5 !important;">            {
</span><span style="margin: 0px; padding: 0px; color: rgb(0, 128, 128); line-height: 1.5 !important;">4</span>                 Response.Write(<span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); line-height: 1.5 !important;">"</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); line-height: 1.5 !important;">I am a webform page.&lt;br/&gt;</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); line-height: 1.5 !important;">"</span><span style="margin: 0px; padding: 0px; line-height: 1.5 !important;">);
</span><span style="margin: 0px; padding: 0px; color: rgb(0, 128, 128); line-height: 1.5 !important;">5</span> <span style="margin: 0px; padding: 0px; line-height: 1.5 !important;">            }
</span><span style="margin: 0px; padding: 0px; color: rgb(0, 128, 128); line-height: 1.5 !important;">6</span>         %&gt;</pre></div><p style="margin: 10px auto; padding: 0px; font-family: 微软雅黑; font-size: 13.9200000762939px; line-height: 16.7040004730225px; widows: 1; background-color: rgb(255, 255, 255);">　　②获取C#方法的返回值</p><p style="margin: 10px auto; padding: 0px; font-family: 微软雅黑; font-size: 13.9200000762939px; line-height: 16.7040004730225px; widows: 1; background-color: rgb(255, 255, 255);">　　假设页面后端代码中有一个GetServerTime的方法，它只有一句代码：return DateTime.Now.ToString();。页面中只需要通过&lt;%= 方法名() %&gt;即可获取该方法的返回值。</p><div class="cnblogs_code" style="margin-top: 5px; margin-bottom: 5px; padding: 5px; border: 1px solid rgb(204, 204, 204); overflow: auto; widows: 1; background-color: rgb(245, 245, 245); font-family: 'Courier New' !important; font-size: 12px !important;"><pre style="margin-top: 0px; margin-bottom: 0px; padding: 0px; white-space: pre-wrap; word-wrap: break-word; font-family: 'Courier New' !important;">&lt;%= GetServerTime() %&gt;</pre></div><p style="margin: 10px auto; padding: 0px; font-family: 微软雅黑; font-size: 13.9200000762939px; line-height: 16.7040004730225px; widows: 1; background-color: rgb(255, 255, 255);">　　③aspx中能够访问的方法的访问修饰符只能为<strong style="margin: 0px; padding: 0px;">public和protected</strong>：这是因为aspx和aspx.cs之间的关系是编译生成后aspx和aspx.cs会创建两个类，并且aspx继承自aspx.cs中的类，在面向对象中子类要访问父类的方法，那么方法的访问修饰符必须为public或protected。（后面会讲到aspx和aspx.cs的关系，不要急）</p><h2 style="margin: 15px auto 2px; font-size: 21px; font-family: 微软雅黑; widows: 1; background-color: rgb(255, 255, 255);"><strong style="margin: 0px; padding: 0px;">1.3 aspx与ashx的关系</strong></h2><p style="margin: 10px auto; padding: 0px; font-family: 微软雅黑; font-size: 13.9200000762939px; line-height: 16.7040004730225px; widows: 1; background-color: rgb(255, 255, 255);">　　ashx是一般处理程序，它是一个实现了IHttpHandler的轻量级处理程序，处理操作都在ProcessRequest方法中完成。</p><p style="margin: 10px auto; padding: 0px; font-family: 微软雅黑; font-size: 13.9200000762939px; line-height: 16.7040004730225px; widows: 1; background-color: rgb(255, 255, 255);"><img src="周旭龙 webForm 基础笔记_files/894efeb3-d7c1-4c8f-a27c-db8ddd538ea2.jpg" alt="" style="margin: 0px auto; padding: 0px; display: block;"></p><p style="margin: 10px auto; padding: 0px; font-family: 微软雅黑; font-size: 13.9200000762939px; line-height: 16.7040004730225px; widows: 1; background-color: rgb(255, 255, 255);">　　而aspx则相当于一个<strong style="margin: 0px; padding: 0px;">特殊的、高级的ashx</strong>，aspx所对应的父类是System.Web.UI.Page这个类，通过查看Page类的定义，我们可以看到Page也实现了IHttpHandler的这个接口。另外之所以说它是高级的ashx，是因为<strong style="margin: 0px; padding: 0px;">aspx帮我们封装了许多底层的操作</strong>，使得我们可以进行傻瓜式的开发操作。</p><p style="margin: 10px auto; padding: 0px; font-family: 微软雅黑; font-size: 13.9200000762939px; line-height: 16.7040004730225px; widows: 1; background-color: rgb(255, 255, 255);"><img src="周旭龙 webForm 基础笔记_files/88dd3cd5-df00-4d47-a8fa-50735b256586.jpg" alt="" style="margin: 0px auto; padding: 0px; display: block;"></p><p style="margin: 10px auto; padding: 0px; font-family: 微软雅黑; font-size: 13.9200000762939px; line-height: 16.7040004730225px; widows: 1; background-color: rgb(255, 255, 255);">　　看到这里，我们不禁要问：<strong style="margin: 0px; padding: 0px;">既然有了ashx为何还要aspx？</strong>大家都知道ashx中的ProcessRequest方法需要向请求响应报文中输出html，而每个html页内容有很多，如果每次响应都往里边输出html开发起来会很痛苦（这里主要是指在如果不借助模板引擎的情况下），而aspx则起到了类似于于一个模板引擎的作用，帮我们把html的大体框架定义好了，我们在开发中就只需要操作每次响应需要更改的内容即可。</p><h2 style="margin: 15px auto 2px; font-size: 21px; font-family: 微软雅黑; widows: 1; background-color: rgb(255, 255, 255);">1.4&nbsp;<strong style="margin: 0px; padding: 0px;">aspx与aspx.cs的关系</strong></h2><p style="margin: 10px auto; padding: 0px; font-family: 微软雅黑; font-size: 13.9200000762939px; line-height: 16.7040004730225px; widows: 1; background-color: rgb(255, 255, 255);"><strong style="margin: 0px; padding: 0px;">　　</strong>（0）假如我们有以下的名为FirstPage的一个aspx页面：</p><div class="cnblogs_code" style="margin-top: 5px; margin-bottom: 5px; padding: 5px; border: 1px solid rgb(204, 204, 204); overflow: auto; widows: 1; background-color: rgb(245, 245, 245); font-family: 'Courier New' !important; font-size: 12px !important;"><img id="code_img_opened_51f84ebd-1244-4215-9227-309b34d2e1f6" class="code_img_opened" src="周旭龙 webForm 基础笔记_files/529ccb29-b6b1-4263-88a3-1dc46336a5d1.gif" alt="" style="margin-top: 0px; margin-bottom: 0px; padding: 0px 5px 0px 0px; vertical-align: middle;"><div id="cnblogs_code_open_51f84ebd-1244-4215-9227-309b34d2e1f6" class="cnblogs_code_hide" style="padding: 0px;"><div class="cnblogs_code_toolbar" style="margin-top: 5px; padding: 0px;"><span class="cnblogs_code_copy" style="margin: 0px; padding: 0px 5px 0px 0px; line-height: 1.5 !important;"><a href="" title="复制代码" style="margin: 0px; padding: 1px 3px; color: green; text-decoration: none; border: none !important;"><img src="周旭龙 webForm 基础笔记_files/a24c1b97-8842-4874-a71b-7b061c8268e4.gif" alt="复制代码" style="border-style: none; margin-top: 0px; margin-bottom: 0px; padding: 0px;"></a></span></div><pre style="margin-top: 0px; margin-bottom: 0px; padding: 0px; white-space: pre-wrap; word-wrap: break-word; font-family: 'Courier New' !important;">&lt;html xmlns=<span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); line-height: 1.5 !important;">"</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); line-height: 1.5 !important;">http://www.w3.org/1999/xhtml</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); line-height: 1.5 !important;">"</span>&gt;
&lt;head runat=<span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); line-height: 1.5 !important;">"</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); line-height: 1.5 !important;">server</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); line-height: 1.5 !important;">"</span>&gt;
    &lt;title&gt;第一个WebForm页&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
    &lt;form id=<span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); line-height: 1.5 !important;">"</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); line-height: 1.5 !important;">form1</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); line-height: 1.5 !important;">"</span> runat=<span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); line-height: 1.5 !important;">"</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); line-height: 1.5 !important;">server</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); line-height: 1.5 !important;">"</span>&gt;
    &lt;div&gt;<span style="margin: 0px; padding: 0px; line-height: 1.5 !important;">
        哈哈，我是ASP.Net WebForm，下面看我的表演。
        </span>&lt;br /&gt;
        &lt;%
            <span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); line-height: 1.5 !important;">for</span> (<span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); line-height: 1.5 !important;">int</span> i = <span style="margin: 0px; padding: 0px; color: rgb(128, 0, 128); line-height: 1.5 !important;">0</span>; i &lt; <span style="margin: 0px; padding: 0px; color: rgb(128, 0, 128); line-height: 1.5 !important;">5</span>; i++<span style="margin: 0px; padding: 0px; line-height: 1.5 !important;">)
            {
                Response.Write(</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); line-height: 1.5 !important;">"</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); line-height: 1.5 !important;">I am a webform page.&lt;br/&gt;</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); line-height: 1.5 !important;">"</span><span style="margin: 0px; padding: 0px; line-height: 1.5 !important;">);
            }
        </span>%&gt;
        &lt;br /&gt;
        &lt;%= GetServerTime() %&gt;
        &lt;br /&gt;
        &lt;asp:TextBox ID=<span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); line-height: 1.5 !important;">"</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); line-height: 1.5 !important;">txtDateTime</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); line-height: 1.5 !important;">"</span> runat=<span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); line-height: 1.5 !important;">"</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); line-height: 1.5 !important;">server</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); line-height: 1.5 !important;">"</span>&gt;&lt;/asp:TextBox&gt;
        &lt;asp:Button ID=<span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); line-height: 1.5 !important;">"</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); line-height: 1.5 !important;">btnGetTime</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); line-height: 1.5 !important;">"</span><span style="margin: 0px; padding: 0px; line-height: 1.5 !important;">
            runat</span>=<span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); line-height: 1.5 !important;">"</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); line-height: 1.5 !important;">server</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); line-height: 1.5 !important;">"</span> Text=<span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); line-height: 1.5 !important;">"</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); line-height: 1.5 !important;">获取时间</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); line-height: 1.5 !important;">"</span> onclick=<span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); line-height: 1.5 !important;">"</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); line-height: 1.5 !important;">btnGetTime_Click</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); line-height: 1.5 !important;">"</span> /&gt;
        &lt;br /&gt;
        &lt;% GetDllInfo(); %&gt;
    &lt;/div&gt;
    &lt;/form&gt;
&lt;/body&gt;
&lt;/html&gt;</pre><div class="cnblogs_code_toolbar" style="margin-top: 5px; padding: 0px;"><span class="cnblogs_code_copy" style="margin: 0px; padding: 0px 5px 0px 0px; line-height: 1.5 !important;"><a href="" title="复制代码" style="margin: 0px; padding: 1px 3px; color: green; text-decoration: none; border: none !important;"><img src="周旭龙 webForm 基础笔记_files/a24c1b97-8842-4874-a71b-7b061c8268e4.gif" alt="复制代码" style="border-style: none; margin-top: 0px; margin-bottom: 0px; padding: 0px;"></a></span></div></div></div><p style="margin: 10px auto; padding: 0px; font-family: 微软雅黑; font-size: 13.9200000762939px; line-height: 16.7040004730225px; widows: 1; background-color: rgb(255, 255, 255);">　　其后台代码.cs文件代码如下：</p><div class="cnblogs_code" style="margin-top: 5px; margin-bottom: 5px; padding: 5px; border: 1px solid rgb(204, 204, 204); overflow: auto; widows: 1; background-color: rgb(245, 245, 245); font-family: 'Courier New' !important; font-size: 12px !important;"><img id="code_img_opened_b25f69b4-2749-4402-b48b-8700c3a836a4" class="code_img_opened" src="周旭龙 webForm 基础笔记_files/529ccb29-b6b1-4263-88a3-1dc46336a5d1.gif" alt="" style="margin-top: 0px; margin-bottom: 0px; padding: 0px 5px 0px 0px; vertical-align: middle;"><div id="cnblogs_code_open_b25f69b4-2749-4402-b48b-8700c3a836a4" class="cnblogs_code_hide" style="padding: 0px;"><div class="cnblogs_code_toolbar" style="margin-top: 5px; padding: 0px;"><span class="cnblogs_code_copy" style="margin: 0px; padding: 0px 5px 0px 0px; line-height: 1.5 !important;"><a href="" title="复制代码" style="margin: 0px; padding: 1px 3px; color: green; text-decoration: none; border: none !important;"><img src="周旭龙 webForm 基础笔记_files/a24c1b97-8842-4874-a71b-7b061c8268e4.gif" alt="复制代码" style="border-style: none; margin-top: 0px; margin-bottom: 0px; padding: 0px;"></a></span></div><pre style="margin-top: 0px; margin-bottom: 0px; padding: 0px; white-space: pre-wrap; word-wrap: break-word; font-family: 'Courier New' !important;"><span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); line-height: 1.5 !important;">namespace</span><span style="margin: 0px; padding: 0px; line-height: 1.5 !important;"> WebFormDemo
{
    </span><span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); line-height: 1.5 !important;">public</span> <span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); line-height: 1.5 !important;">partial</span> <span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); line-height: 1.5 !important;">class</span><span style="margin: 0px; padding: 0px; line-height: 1.5 !important;"> FirstPage : System.Web.UI.Page
    {
        </span><span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); line-height: 1.5 !important;">protected</span> <span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); line-height: 1.5 !important;">void</span> Page_Load(<span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); line-height: 1.5 !important;">object</span><span style="margin: 0px; padding: 0px; line-height: 1.5 !important;"> sender, EventArgs e)
        {

        }

        </span><span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); line-height: 1.5 !important;">protected</span> <span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); line-height: 1.5 !important;">string</span><span style="margin: 0px; padding: 0px; line-height: 1.5 !important;"> GetServerTime()
        {
            </span><span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); line-height: 1.5 !important;">string</span> result = <span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); line-height: 1.5 !important;">"</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); line-height: 1.5 !important;">服务器时间：</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); line-height: 1.5 !important;">"</span> +<span style="margin: 0px; padding: 0px; line-height: 1.5 !important;"> DateTime.Now.ToString();
            </span><span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); line-height: 1.5 !important;">return</span><span style="margin: 0px; padding: 0px; line-height: 1.5 !important;"> result;
        }

        </span><span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); line-height: 1.5 !important;">protected</span> <span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); line-height: 1.5 !important;">void</span><span style="margin: 0px; padding: 0px; line-height: 1.5 !important;"> GetDllInfo()
        {
            Response.Write(</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); line-height: 1.5 !important;">"</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); line-height: 1.5 !important;">页面类名称：</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); line-height: 1.5 !important;">"</span>+<span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); line-height: 1.5 !important;">this</span>.GetType() + <span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); line-height: 1.5 !important;">"</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); line-height: 1.5 !important;">&lt;br/&gt;</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); line-height: 1.5 !important;">"</span><span style="margin: 0px; padding: 0px; line-height: 1.5 !important;">);
            Response.Write(</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); line-height: 1.5 !important;">"</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); line-height: 1.5 !important;">程序集地址：</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); line-height: 1.5 !important;">"</span>+<span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); line-height: 1.5 !important;">this</span>.GetType().Assembly.Location + <span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); line-height: 1.5 !important;">"</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); line-height: 1.5 !important;">&lt;br/&gt;</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); line-height: 1.5 !important;">"</span><span style="margin: 0px; padding: 0px; line-height: 1.5 !important;">);
            Response.Write(</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); line-height: 1.5 !important;">"</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); line-height: 1.5 !important;">父类的名称：</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); line-height: 1.5 !important;">"</span>+<span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); line-height: 1.5 !important;">this</span>.GetType().BaseType + <span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); line-height: 1.5 !important;">"</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); line-height: 1.5 !important;">&lt;br/&gt;</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); line-height: 1.5 !important;">"</span><span style="margin: 0px; padding: 0px; line-height: 1.5 !important;">);
            Response.Write(</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); line-height: 1.5 !important;">"</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); line-height: 1.5 !important;">程序集地址：</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); line-height: 1.5 !important;">"</span>+<span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); line-height: 1.5 !important;">this</span>.GetType().BaseType.Assembly.Location + <span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); line-height: 1.5 !important;">"</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); line-height: 1.5 !important;">&lt;br/&gt;</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); line-height: 1.5 !important;">"</span><span style="margin: 0px; padding: 0px; line-height: 1.5 !important;">);
        }

        </span><span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); line-height: 1.5 !important;">protected</span> <span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); line-height: 1.5 !important;">void</span> btnGetTime_Click(<span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); line-height: 1.5 !important;">object</span><span style="margin: 0px; padding: 0px; line-height: 1.5 !important;"> sender, EventArgs e)
        {
            txtDateTime.Text </span>=<span style="margin: 0px; padding: 0px; line-height: 1.5 !important;"> DateTime.Now.ToString();
        }
    }
}</span></pre><div class="cnblogs_code_toolbar" style="margin-top: 5px; padding: 0px;"><span class="cnblogs_code_copy" style="margin: 0px; padding: 0px 5px 0px 0px; line-height: 1.5 !important;"><a href="" title="复制代码" style="margin: 0px; padding: 1px 3px; color: green; text-decoration: none; border: none !important;"><img src="周旭龙 webForm 基础笔记_files/a24c1b97-8842-4874-a71b-7b061c8268e4.gif" alt="复制代码" style="border-style: none; margin-top: 0px; margin-bottom: 0px; padding: 0px;"></a></span></div></div></div><p style="margin: 10px auto; padding: 0px; font-family: 微软雅黑; font-size: 13.9200000762939px; line-height: 16.7040004730225px; widows: 1; background-color: rgb(255, 255, 255);">　　（1）<strong style="margin: 0px; padding: 0px;">CodeBehind</strong>：在每个aspx文件中的头部，我们都会看到以下的一句代码</p><div class="cnblogs_code" style="margin-top: 5px; margin-bottom: 5px; padding: 5px; border: 1px solid rgb(204, 204, 204); overflow: auto; widows: 1; background-color: rgb(245, 245, 245); font-family: 'Courier New' !important; font-size: 12px !important;"><pre style="margin-top: 0px; margin-bottom: 0px; padding: 0px; white-space: pre-wrap; word-wrap: break-word; font-family: 'Courier New' !important;">&lt;%@ Page Language=<span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); line-height: 1.5 !important;">"</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); line-height: 1.5 !important;">C#</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); line-height: 1.5 !important;">"</span> AutoEventWireup=<span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); line-height: 1.5 !important;">"</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); line-height: 1.5 !important;">true</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); line-height: 1.5 !important;">"</span> CodeBehind=<span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); line-height: 1.5 !important;">"</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); line-height: 1.5 !important;">FirstPage.aspx.cs</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); line-height: 1.5 !important;">"</span> Inherits=<span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); line-height: 1.5 !important;">"</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); line-height: 1.5 !important;">WebFormDemo.FirstPage</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); line-height: 1.5 !important;">"</span> %&gt;</pre></div><p style="margin: 10px auto; padding: 0px; font-family: 微软雅黑; font-size: 13.9200000762939px; line-height: 16.7040004730225px; widows: 1; background-color: rgb(255, 255, 255);">　　其中CodeBehind这个属性定义了此aspx页面的专属后台代码文件的名称，而Inherits这个属性则定义了此aspx页面所要继承的父类的名称（这也可以简单地说明，aspx页面会单独生成一个类，与后台代码类不重合在一起）。因此，aspx.cs就是aspx的后置处理代码，负责处理aspx中&lt;%%&gt;和runat="server"的内容。</p><p style="margin: 10px auto; padding: 0px; font-family: 微软雅黑; font-size: 13.9200000762939px; line-height: 16.7040004730225px; widows: 1; background-color: rgb(255, 255, 255);">　　（2）<strong style="margin: 0px; padding: 0px;">子类与父类</strong>：我们使用ASP.NET写的网站在运行时候都会被编译生成为一个一个的程序集（.dll），而我们的aspx页面也会被生成为一个一个的类。那么，我们如何来证明aspx会生成一个类，而且还是aspx.cs中的类的子类呢？那么，我们需要<strong style="margin: 0px; padding: 0px;">反编译</strong>系统所生成的程序集（.dll）文件。</p><p style="margin: 10px auto; padding: 0px; font-family: 微软雅黑; font-size: 13.9200000762939px; line-height: 16.7040004730225px; widows: 1; background-color: rgb(255, 255, 255);">　　第一步：找到网站所生成的程序集</p><p style="margin: 10px auto; padding: 0px; font-family: 微软雅黑; font-size: 13.9200000762939px; line-height: 16.7040004730225px; widows: 1; background-color: rgb(255, 255, 255);">　　我们可以通过写入以下代码，然后在aspx中&lt;% GetDllInfo(); %&gt;调用；</p><div class="cnblogs_code" style="margin-top: 5px; margin-bottom: 5px; padding: 5px; border: 1px solid rgb(204, 204, 204); overflow: auto; widows: 1; background-color: rgb(245, 245, 245); font-family: 'Courier New' !important; font-size: 12px !important;"><div class="cnblogs_code_toolbar" style="margin-top: 5px; padding: 0px;"><span class="cnblogs_code_copy" style="margin: 0px; padding: 0px 5px 0px 0px; line-height: 1.5 !important;"><a href="" title="复制代码" style="margin: 0px; padding: 1px 3px; color: green; text-decoration: none; border: none !important;"><img src="周旭龙 webForm 基础笔记_files/a24c1b97-8842-4874-a71b-7b061c8268e4.gif" alt="复制代码" style="border-style: none; margin-top: 0px; margin-bottom: 0px; padding: 0px;"></a></span></div><pre style="margin-top: 0px; margin-bottom: 0px; padding: 0px; white-space: pre-wrap; word-wrap: break-word; font-family: 'Courier New' !important;"><span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); line-height: 1.5 !important;">protected</span> <span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); line-height: 1.5 !important;">void</span><span style="margin: 0px; padding: 0px; line-height: 1.5 !important;"> GetDllInfo()
{
    Response.Write(</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); line-height: 1.5 !important;">"</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); line-height: 1.5 !important;">页面类名称：</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); line-height: 1.5 !important;">"</span>+<span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); line-height: 1.5 !important;">this</span>.GetType() + <span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); line-height: 1.5 !important;">"</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); line-height: 1.5 !important;">&lt;br/&gt;</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); line-height: 1.5 !important;">"</span><span style="margin: 0px; padding: 0px; line-height: 1.5 !important;">);
    Response.Write(</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); line-height: 1.5 !important;">"</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); line-height: 1.5 !important;">程序集地址：</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); line-height: 1.5 !important;">"</span>+<span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); line-height: 1.5 !important;">this</span>.GetType().Assembly.Location + <span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); line-height: 1.5 !important;">"</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); line-height: 1.5 !important;">&lt;br/&gt;</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); line-height: 1.5 !important;">"</span><span style="margin: 0px; padding: 0px; line-height: 1.5 !important;">);
    Response.Write(</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); line-height: 1.5 !important;">"</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); line-height: 1.5 !important;">父类的名称：</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); line-height: 1.5 !important;">"</span>+<span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); line-height: 1.5 !important;">this</span>.GetType().BaseType + <span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); line-height: 1.5 !important;">"</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); line-height: 1.5 !important;">&lt;br/&gt;</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); line-height: 1.5 !important;">"</span><span style="margin: 0px; padding: 0px; line-height: 1.5 !important;">);
    Response.Write(</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); line-height: 1.5 !important;">"</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); line-height: 1.5 !important;">程序集地址：</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); line-height: 1.5 !important;">"</span>+<span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); line-height: 1.5 !important;">this</span>.GetType().BaseType.Assembly.Location + <span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); line-height: 1.5 !important;">"</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); line-height: 1.5 !important;">&lt;br/&gt;</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); line-height: 1.5 !important;">"</span><span style="margin: 0px; padding: 0px; line-height: 1.5 !important;">);
}</span></pre><div class="cnblogs_code_toolbar" style="margin-top: 5px; padding: 0px;"><span class="cnblogs_code_copy" style="margin: 0px; padding: 0px 5px 0px 0px; line-height: 1.5 !important;"><a href="" title="复制代码" style="margin: 0px; padding: 1px 3px; color: green; text-decoration: none; border: none !important;"><img src="周旭龙 webForm 基础笔记_files/a24c1b97-8842-4874-a71b-7b061c8268e4.gif" alt="复制代码" style="border-style: none; margin-top: 0px; margin-bottom: 0px; padding: 0px;"></a></span></div></div><p style="margin: 10px auto; padding: 0px; font-family: 微软雅黑; font-size: 13.9200000762939px; line-height: 16.7040004730225px; widows: 1; background-color: rgb(255, 255, 255);">　　浏览页面，会显示以下结果：通过下图可以看到，我们的FirstPage这个页面会生成一个ASP.firstpage_asx的类，其父类是FirstPage。</p><p style="margin: 10px auto; padding: 0px; font-family: 微软雅黑; font-size: 13.9200000762939px; line-height: 16.7040004730225px; widows: 1; background-color: rgb(255, 255, 255);"><img src="周旭龙 webForm 基础笔记_files/e59074c2-b3a4-4827-9d5f-9c894f42befc.jpg" alt="" style="margin: 0px auto; padding: 0px; display: block; width: 620px;"></p><blockquote style="margin-top: 20px; margin-bottom: 20px; padding: 15px 20px 15px 60px; border-width: 2px; border-top-style: solid; border-right-style: solid; border-bottom-style: solid; border-color: rgb(239, 239, 239); color: rgb(51, 51, 51); border-top-left-radius: 10px; border-top-right-radius: 10px; border-bottom-right-radius: 10px; border-bottom-left-radius: 10px; min-height: 35px; line-height: 1.6em; font-size: 15px; font-family: 'Microsoft Yahei'; box-shadow: rgb(170, 170, 170) 0px 0px 8px; clear: both; widows: 1; background-image: url(&quot;周旭龙 webForm 基础笔记_files/ea96c2b9-5444-4d19-8766-763b9d9d8e23_128.htm&quot;); background-color: rgb(255, 255, 163); background-position: 9px 0px; background-repeat: no-repeat no-repeat;"><p style="margin: 10px auto; padding: 0px;"><strong style="margin: 0px; padding: 0px;">PS：</strong>当某个页面第一次被访问的时候，CLR就会使用一个代码生成器去解析aspx文件并生成源代码并编译，然后以后的访问就直接调用编译后的dll，这也是为什么aspx第一次访问的时候非常慢的原因。 &nbsp;</p></blockquote><p style="margin: 10px auto; padding: 0px; font-family: 微软雅黑; font-size: 13.9200000762939px; line-height: 16.7040004730225px; widows: 1; background-color: rgb(255, 255, 255);">　　第二步：反编译临时程序集文件</p><p style="margin: 10px auto; padding: 0px; font-family: 微软雅黑; font-size: 13.9200000762939px; line-height: 16.7040004730225px; widows: 1; background-color: rgb(255, 255, 255);">　　①通过上面显示的路径找到dll，并拖到反编译工具（ILSpy或者Reflector，前者开源免费，后者已经收费，但天朝，你懂的。）进行查看。通过下图可以看出，页面类aspx是后台代码类所绑定的子类，它的名称是aspx文件名加上“_aspx”后缀。因此，<strong style="margin: 0px; padding: 0px;">这里也就解释了为什么在aspx中要访问的方法必须是public和protected的访问修饰符才可以。</strong></p><p style="margin: 10px auto; padding: 0px; font-family: 微软雅黑; font-size: 13.9200000762939px; line-height: 16.7040004730225px; widows: 1; background-color: rgb(255, 255, 255);"><img src="周旭龙 webForm 基础笔记_files/2b5ccef5-4b55-4252-947a-8b1a86cc5906.jpg" alt="" style="margin: 0px auto; padding: 0px; display: block; width: 620px;"></p><p style="margin: 10px auto; padding: 0px; font-family: 微软雅黑; font-size: 13.9200000762939px; line-height: 16.7040004730225px; widows: 1; background-color: rgb(255, 255, 255);">　　②下图则展示了对页面后置代码类所在的程序集进行反编译的情况：</p><p style="margin: 10px auto; padding: 0px; font-family: 微软雅黑; font-size: 13.9200000762939px; line-height: 16.7040004730225px; widows: 1; background-color: rgb(255, 255, 255);"><img src="周旭龙 webForm 基础笔记_files/111ba797-60f0-4317-b2a3-d44678769da5.jpg" alt="" style="margin: 0px auto; padding: 0px; display: block; width: 620px;"></p><p style="margin: 10px auto; padding: 0px; font-family: 微软雅黑; font-size: 13.9200000762939px; line-height: 16.7040004730225px; widows: 1; background-color: rgb(255, 255, 255);">　　第三步：我们在刚刚时就说了，服务器端对aspx处理的过程是一个渲染生成html的过程，如何来深入理解这句话，我们可以在此借助反编译工具来一探究竟。通过对aspx类的反编译，我们可以看到在它的方法列表中有如下几个命名格式一样的方法：</p><p style="margin: 10px auto; padding: 0px; font-family: 微软雅黑; font-size: 13.9200000762939px; line-height: 16.7040004730225px; widows: 1; background-color: rgb(255, 255, 255);">　　①_BuildControl_controlX(); X代表数字</p><p style="margin: 10px auto; padding: 0px; font-family: 微软雅黑; font-size: 13.9200000762939px; line-height: 16.7040004730225px; widows: 1; background-color: rgb(255, 255, 255);"><img src="周旭龙 webForm 基础笔记_files/6d6a2e72-66ea-4835-97e5-a62ce5572352.jpg" alt="" style="margin: 0px auto; padding: 0px; display: block;"></p><p style="margin: 10px auto; padding: 0px; font-family: 微软雅黑; font-size: 13.9200000762939px; line-height: 16.7040004730225px; widows: 1; background-color: rgb(255, 255, 255);"><img src="周旭龙 webForm 基础笔记_files/ba0ee33a-bbbe-4530-87da-b29fc2676b90.jpg" alt="" style="margin: 0px auto; padding: 0px; display: block; width: 620px;"></p><p style="margin: 10px auto; padding: 0px; font-family: 微软雅黑; font-size: 13.9200000762939px; line-height: 16.7040004730225px; widows: 1; background-color: rgb(255, 255, 255);">　　通过对这几个方法的源码分析，我们可以知道，这些方法都在做一件事件：<strong style="margin: 0px; padding: 0px;">拼接生成aspx页面的html内容</strong>。每个方法都会返回一个控件类型的对象，有LiteralControl类型，也有HtmlHead类型（在aspx中只要给head加了runat="server"就会有此类型的生成方法）等等，那么这些数字又代表了什么？难道是生成html的执行顺序么？这些生成方法又是在哪个方法中被一一调用的呢？别急，下面我们就来看看。</p><p style="margin: 10px auto; padding: 0px; font-family: 微软雅黑; font-size: 13.9200000762939px; line-height: 16.7040004730225px; widows: 1; background-color: rgb(255, 255, 255);">　　②通过后面几个方法源码的查看，我们发现原来上面的几个生成控件的方法都在一个叫做<strong style="margin: 0px; padding: 0px;">BuildControlTree</strong>的方法（生成控件树）中被依次调用。</p><p style="margin: 10px auto; padding: 0px; font-family: 微软雅黑; font-size: 13.9200000762939px; line-height: 16.7040004730225px; widows: 1; background-color: rgb(255, 255, 255);"><img src="周旭龙 webForm 基础笔记_files/d60429ba-7c8c-4ae4-9018-08460ba3dd56.jpg" alt="" style="margin: 0px auto; padding: 0px; display: block; width: 620px;"></p><p style="margin: 10px auto; padding: 0px; font-family: 微软雅黑; font-size: 13.9200000762939px; line-height: 16.7040004730225px; widows: 1; background-color: rgb(255, 255, 255);">　　这里几乎是按照数字序号的顺序来依次调用具体的BuildControl_controlX()方法，并将每次返回的控件添加到页面中去。这里可以看到，BuildControlTree方法的参数是其本身，它实现了IParserAccessor的接口。这里暂且将这个接口其理解为一个大的控件容器，可以往这个容器里边添加子控件（这里看到不同类型的控件都可以往里边加，那么肯定初步断定方法参数应该是object类型），这里将每次调用BuildControl_controlX()方法所返回的控件类型添加到了这个容器中。</p><p style="margin: 10px auto; padding: 0px; font-family: 微软雅黑; font-size: 13.9200000762939px; line-height: 16.7040004730225px; widows: 1; background-color: rgb(255, 255, 255);">　　③刚刚分析了BuildControlTree方法，知道了控件的生成过程。但是，页面主体内容又在哪里呢？服务器端要返回的内容可不止是那些控件的HTML代码啊。别急，通过查看反编译的方法，我们看到原来<strong style="margin: 0px; padding: 0px;">Renderform1</strong>这个方法里边。<strong style="margin: 0px; padding: 0px;">PS：</strong>这里方法名为什么是form1呢？那是因为我们在aspx中给form表单设置的ID就为form1。</p><p style="margin: 10px auto; padding: 0px; font-family: 微软雅黑; font-size: 13.9200000762939px; line-height: 16.7040004730225px; widows: 1; background-color: rgb(255, 255, 255);"><img src="周旭龙 webForm 基础笔记_files/d957735e-ef38-40ab-b410-7d3a01250985.jpg" alt="" style="margin-top: 0px; margin-bottom: 0px; padding: 0px; width: 620px;"></p><p style="margin: 10px auto; padding: 0px; font-family: 微软雅黑; font-size: 13.9200000762939px; line-height: 16.7040004730225px; widows: 1; background-color: rgb(255, 255, 255);">　　④这里我们就分析到这儿，而WebForm具体的页面生命周期留到后面的ASP.Net页面生命周期探索的文章中详细介绍。这里我们只需要知道，<strong style="margin: 0px; padding: 0px;">aspx这个类是其后置代码类的子类，它要做的工作就是帮我们生成要返回浏览器端的html内容即可。</strong>其中，RenderForm将渲染生成整个form表单，而BuildControlTree则会生成服务器控件树，以便在后面的方法中方便地调用每个控件的RenderControl方法生成html字符串。</p><h1 style="padding-top: 5px; padding-bottom: 5px; padding-left: 20px; font-size: 17px; border-top-left-radius: 6px; border-top-right-radius: 6px; border-bottom-right-radius: 6px; border-bottom-left-radius: 6px; box-shadow: rgb(95, 90, 75) 0px 0px 0px 1px, rgba(10, 10, 0, 0.498039) 1px 1px 6px 1px; color: white; font-family: 微软雅黑, 宋体, 黑体, Arial; height: 25px; line-height: 25px; text-shadow: rgb(34, 34, 34) 2px 2px 3px; width: 601.400024414063px; widows: 1; background-color: rgb(43, 102, 149); margin-top: 15px !important; margin-bottom: 15px !important;">二、好用不好用—服务器控件探秘</h1><h2 style="margin: 15px auto 2px; font-size: 21px; font-family: 微软雅黑; widows: 1; background-color: rgb(255, 255, 255);">2.1 企业中到底在用哪些控件？</h2><p style="margin: 10px auto; padding: 0px; font-family: 微软雅黑; font-size: 13.9200000762939px; line-height: 16.7040004730225px; widows: 1; background-color: rgb(255, 255, 255);">　　企业项目中经常使用到的最多还是一些“<strong style="margin: 0px; padding: 0px;">轻量级</strong>”的控件，例如：Button、TextBox、CheckBox、RadioButton、DropDownList、Repeater、ListView等；就我所实习的单位来说，这一年做WebForm的项目以来，用的最多也就是这些控件，数据控件除了<strong style="margin: 0px; padding: 0px;">Repeater</strong>就没用过其他的。我觉得数据控件的话，好好学习下Repeater就够了，因为Repeater已经足够强大了。至于什么***DataSource、Validator、Wizard、Login还有什么ASP.Net AJAX ToolKit就根本没杂用，这些控件既复杂又不实用，而且还比较重量级。</p><blockquote style="margin-top: 20px; margin-bottom: 20px; padding: 15px 20px 15px 60px; border-width: 2px; border-top-style: solid; border-right-style: solid; border-bottom-style: solid; border-color: rgb(239, 239, 239); color: rgb(51, 51, 51); border-top-left-radius: 10px; border-top-right-radius: 10px; border-bottom-right-radius: 10px; border-bottom-left-radius: 10px; min-height: 35px; line-height: 1.6em; font-size: 15px; font-family: 'Microsoft Yahei'; box-shadow: rgb(170, 170, 170) 0px 0px 8px; clear: both; widows: 1; background-image: url(&quot;周旭龙 webForm 基础笔记_files/ea96c2b9-5444-4d19-8766-763b9d9d8e23_128.htm&quot;); background-color: rgb(255, 255, 163); background-position: 9px 0px; background-repeat: no-repeat no-repeat;"><p style="margin: 10px auto; padding: 0px;"><strong style="margin: 0px; padding: 0px;">PS：</strong>有关Repeater控件的详细学习，可以参考w3school的教程：<a href="http://www.w3school.com.cn/aspnet/aspnet_repeater.asp" target="_blank" style="margin: 0px; padding: 1px 3px; color: green; text-decoration: none;">http://www.w3school.com.cn/aspnet/aspnet_repeater.asp</a></p></blockquote><h2 style="margin: 15px auto 2px; font-size: 21px; font-family: 微软雅黑; widows: 1; background-color: rgb(255, 255, 255);">2.2 需要注意的基本控件用法</h2><p style="margin: 10px auto; padding: 0px; font-family: 微软雅黑; font-size: 13.9200000762939px; line-height: 16.7040004730225px; widows: 1; background-color: rgb(255, 255, 255);">　　（1）Button控件中的<strong style="margin: 0px; padding: 0px;">OnClientClick</strong>属性</p><p style="margin: 10px auto; padding: 0px; font-family: 微软雅黑; font-size: 13.9200000762939px; line-height: 16.7040004730225px; widows: 1; background-color: rgb(255, 255, 255);">　　①在WebForm中，Button控件有两个Click事件：一个是OnClick的服务端事件，另一个是OnClientClick的客户端事件；OnClick事件写在后置代码类中，每次点击Button首先会触发OnClientClick事件（OnClientClick会返回一个bool值，为true则继续执行OnClick，为false则不继续）。</p><p style="margin: 10px auto; padding: 0px; font-family: 微软雅黑; font-size: 13.9200000762939px; line-height: 16.7040004730225px; widows: 1; background-color: rgb(255, 255, 255);">　　②通过分析这个属性，可以知道OnClientClick是一个<strong style="margin: 0px; padding: 0px;">字符串属性</strong>，写的代码是JavaScript代码，在上面所说的BuildControl方法中会渲染成input的onclick方法，它会运行在浏览器端。</p><div class="cnblogs_code" style="margin-top: 5px; margin-bottom: 5px; padding: 5px; border: 1px solid rgb(204, 204, 204); overflow: auto; widows: 1; background-color: rgb(245, 245, 245); font-family: 'Courier New' !important; font-size: 12px !important;"><img id="code_img_opened_f53d029d-f71e-4484-8933-d8dc541433e6" class="code_img_opened" src="周旭龙 webForm 基础笔记_files/529ccb29-b6b1-4263-88a3-1dc46336a5d1.gif" alt="" style="margin-top: 0px; margin-bottom: 0px; padding: 0px 5px 0px 0px; vertical-align: middle;"><div id="cnblogs_code_open_f53d029d-f71e-4484-8933-d8dc541433e6" class="cnblogs_code_hide" style="padding: 0px;"><div class="cnblogs_code_toolbar" style="margin-top: 5px; padding: 0px;"><span class="cnblogs_code_copy" style="margin: 0px; padding: 0px 5px 0px 0px; line-height: 1.5 !important;"><a href="" title="复制代码" style="margin: 0px; padding: 1px 3px; color: green; text-decoration: none; border: none !important;"><img src="周旭龙 webForm 基础笔记_files/a24c1b97-8842-4874-a71b-7b061c8268e4.gif" alt="复制代码" style="border-style: none; margin-top: 0px; margin-bottom: 0px; padding: 0px;"></a></span></div><pre style="margin-top: 0px; margin-bottom: 0px; padding: 0px; white-space: pre-wrap; word-wrap: break-word; font-family: 'Courier New' !important;"><span style="margin: 0px; padding: 0px; color: rgb(0, 128, 128); line-height: 1.5 !important;"> 1</span> &lt;%@ Page Language=<span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); line-height: 1.5 !important;">"</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); line-height: 1.5 !important;">C#</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); line-height: 1.5 !important;">"</span> AutoEventWireup=<span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); line-height: 1.5 !important;">"</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); line-height: 1.5 !important;">true</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); line-height: 1.5 !important;">"</span> CodeBehind=<span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); line-height: 1.5 !important;">"</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); line-height: 1.5 !important;">ClientClickPage.aspx.cs</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); line-height: 1.5 !important;">"</span><span style="margin: 0px; padding: 0px; color: rgb(0, 128, 128); line-height: 1.5 !important;"> 2</span>     Inherits=<span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); line-height: 1.5 !important;">"</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); line-height: 1.5 !important;">WebFormDemo.ClientClickPage</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); line-height: 1.5 !important;">"</span> %&gt;
<span style="margin: 0px; padding: 0px; color: rgb(0, 128, 128); line-height: 1.5 !important;"> 3</span><span style="margin: 0px; padding: 0px; color: rgb(0, 128, 128); line-height: 1.5 !important;"> 4</span> &lt;!DOCTYPE html PUBLIC <span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); line-height: 1.5 !important;">"</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); line-height: 1.5 !important;">-//W3C//DTD XHTML 1.0 Transitional//EN</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); line-height: 1.5 !important;">"</span> <span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); line-height: 1.5 !important;">"</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); line-height: 1.5 !important;">http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); line-height: 1.5 !important;">"</span>&gt;
<span style="margin: 0px; padding: 0px; color: rgb(0, 128, 128); line-height: 1.5 !important;"> 5</span> &lt;html xmlns=<span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); line-height: 1.5 !important;">"</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); line-height: 1.5 !important;">http://www.w3.org/1999/xhtml</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); line-height: 1.5 !important;">"</span>&gt;
<span style="margin: 0px; padding: 0px; color: rgb(0, 128, 128); line-height: 1.5 !important;"> 6</span> &lt;head runat=<span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); line-height: 1.5 !important;">"</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); line-height: 1.5 !important;">server</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); line-height: 1.5 !important;">"</span>&gt;
<span style="margin: 0px; padding: 0px; color: rgb(0, 128, 128); line-height: 1.5 !important;"> 7</span>     &lt;title&gt;OnClientClick&lt;/title&gt;
<span style="margin: 0px; padding: 0px; color: rgb(0, 128, 128); line-height: 1.5 !important;"> 8</span>     &lt;script type=<span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); line-height: 1.5 !important;">"</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); line-height: 1.5 !important;">text/javascript</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); line-height: 1.5 !important;">"</span>&gt;
<span style="margin: 0px; padding: 0px; color: rgb(0, 128, 128); line-height: 1.5 !important;"> 9</span> <span style="margin: 0px; padding: 0px; line-height: 1.5 !important;">        function checkConfirm() {
</span><span style="margin: 0px; padding: 0px; color: rgb(0, 128, 128); line-height: 1.5 !important;">10</span>             <span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); line-height: 1.5 !important;">var</span> flag = confirm(<span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); line-height: 1.5 !important;">"</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); line-height: 1.5 !important;">您确定要删除此内容？</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); line-height: 1.5 !important;">"</span><span style="margin: 0px; padding: 0px; line-height: 1.5 !important;">);
</span><span style="margin: 0px; padding: 0px; color: rgb(0, 128, 128); line-height: 1.5 !important;">11</span>             <span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); line-height: 1.5 !important;">return</span><span style="margin: 0px; padding: 0px; line-height: 1.5 !important;"> flag;
</span><span style="margin: 0px; padding: 0px; color: rgb(0, 128, 128); line-height: 1.5 !important;">12</span> <span style="margin: 0px; padding: 0px; line-height: 1.5 !important;">        }
</span><span style="margin: 0px; padding: 0px; color: rgb(0, 128, 128); line-height: 1.5 !important;">13</span>     &lt;/script&gt;
<span style="margin: 0px; padding: 0px; color: rgb(0, 128, 128); line-height: 1.5 !important;">14</span> &lt;/head&gt;
<span style="margin: 0px; padding: 0px; color: rgb(0, 128, 128); line-height: 1.5 !important;">15</span> &lt;body&gt;
<span style="margin: 0px; padding: 0px; color: rgb(0, 128, 128); line-height: 1.5 !important;">16</span>     &lt;form id=<span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); line-height: 1.5 !important;">"</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); line-height: 1.5 !important;">form1</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); line-height: 1.5 !important;">"</span> runat=<span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); line-height: 1.5 !important;">"</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); line-height: 1.5 !important;">server</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); line-height: 1.5 !important;">"</span>&gt;
<span style="margin: 0px; padding: 0px; color: rgb(0, 128, 128); line-height: 1.5 !important;">17</span>     &lt;div&gt;
<span style="margin: 0px; padding: 0px; color: rgb(0, 128, 128); line-height: 1.5 !important;">18</span>         &lt;asp:Label ID=<span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); line-height: 1.5 !important;">"</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); line-height: 1.5 !important;">lblFlag</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); line-height: 1.5 !important;">"</span> runat=<span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); line-height: 1.5 !important;">"</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); line-height: 1.5 !important;">server</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); line-height: 1.5 !important;">"</span> Text=<span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); line-height: 1.5 !important;">"</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); line-height: 1.5 !important;">This is a label control text.</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); line-height: 1.5 !important;">"</span>&gt;&lt;/asp:Label&gt;
<span style="margin: 0px; padding: 0px; color: rgb(0, 128, 128); line-height: 1.5 !important;">19</span>         &lt;asp:Button ID=<span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); line-height: 1.5 !important;">"</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); line-height: 1.5 !important;">btnDelete</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); line-height: 1.5 !important;">"</span> runat=<span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); line-height: 1.5 !important;">"</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); line-height: 1.5 !important;">server</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); line-height: 1.5 !important;">"</span> Text=<span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); line-height: 1.5 !important;">"</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); line-height: 1.5 !important;">Delete</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); line-height: 1.5 !important;">"</span><span style="margin: 0px; padding: 0px; color: rgb(0, 128, 128); line-height: 1.5 !important;">20</span>             OnClientClick=<span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); line-height: 1.5 !important;">"</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); line-height: 1.5 !important;">return checkConfirm()</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); line-height: 1.5 !important;">"</span> onclick=<span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); line-height: 1.5 !important;">"</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); line-height: 1.5 !important;">btnDelete_Click</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); line-height: 1.5 !important;">"</span> /&gt;
<span style="margin: 0px; padding: 0px; color: rgb(0, 128, 128); line-height: 1.5 !important;">21</span>     &lt;/div&gt;
<span style="margin: 0px; padding: 0px; color: rgb(0, 128, 128); line-height: 1.5 !important;">22</span>     &lt;/form&gt;
<span style="margin: 0px; padding: 0px; color: rgb(0, 128, 128); line-height: 1.5 !important;">23</span> &lt;/body&gt;
<span style="margin: 0px; padding: 0px; color: rgb(0, 128, 128); line-height: 1.5 !important;">24</span> &lt;/html&gt;</pre><div class="cnblogs_code_toolbar" style="margin-top: 5px; padding: 0px;"><span class="cnblogs_code_copy" style="margin: 0px; padding: 0px 5px 0px 0px; line-height: 1.5 !important;"><a href="" title="复制代码" style="margin: 0px; padding: 1px 3px; color: green; text-decoration: none; border: none !important;"><img src="周旭龙 webForm 基础笔记_files/a24c1b97-8842-4874-a71b-7b061c8268e4.gif" alt="复制代码" style="border-style: none; margin-top: 0px; margin-bottom: 0px; padding: 0px;"></a></span></div></div></div><p style="margin: 10px auto; padding: 0px; font-family: 微软雅黑; font-size: 13.9200000762939px; line-height: 16.7040004730225px; widows: 1; background-color: rgb(255, 255, 255);">　　在上面的Button控件中，既设置了OnClientClick也设置了OnClick服务端事件，浏览生成的页面源代码，可以看到在生成的html中，OnClientClick确实是渲染成了input的onclick这个浏览器端的事件：在Button每次以POST方式向服务器提交请求之前，都会先进行checkConfrim这个方法的判断，如果返回值为true才会将请求提交到服务器端；</p><p style="margin: 10px auto; padding: 0px; font-family: 微软雅黑; font-size: 13.9200000762939px; line-height: 16.7040004730225px; widows: 1; background-color: rgb(255, 255, 255);"><img src="周旭龙 webForm 基础笔记_files/33b4dbe8-0f7e-429d-833c-d136159188c4.jpg" alt="" style="margin: 0px auto; padding: 0px; display: block; width: 620px;"></p><p style="margin: 10px auto; padding: 0px; font-family: 微软雅黑; font-size: 13.9200000762939px; line-height: 16.7040004730225px; widows: 1; background-color: rgb(255, 255, 255);">　　（2）被某些人滥用的<strong style="margin: 0px; padding: 0px;">LinkButton</strong></p><p style="margin: 10px auto; padding: 0px; font-family: 微软雅黑; font-size: 13.9200000762939px; line-height: 16.7040004730225px; widows: 1; background-color: rgb(255, 255, 255);"><strong style="margin: 0px; padding: 0px;">　　</strong>①LinkButton用法跟Button差不多，区别就只在于LinkButton渲染成超链接（&lt;a&gt;&lt;/a&gt;），而Button渲染生成input标签（&lt;input type="button"&gt;&lt;/input&gt;）。</p><p style="margin: 10px auto; padding: 0px; font-family: 微软雅黑; font-size: 13.9200000762939px; line-height: 16.7040004730225px; widows: 1; background-color: rgb(255, 255, 255);">　　②不要用LinkButton来实现普通的超链接，在实际开发中，我还真见过有些人用LinkButton来实现超链接的：他们在LinkButton的OnClick事件中写Response.Redirect("xxx.aspx");这种页面跳转代码，完全是<strong style="margin: 0px; padding: 0px;">作死</strong>的节奏啊。能在浏览器端进行的事儿为啥要弄到服务器端来进行呢？而且就只是一个页面跳转的小事。</p><h2 style="margin: 15px auto 2px; font-size: 21px; font-family: 微软雅黑; widows: 1; background-color: rgb(255, 255, 255);">2.3 AutoPostBack的那点事</h2><p style="margin: 10px auto; padding: 0px; font-family: 微软雅黑; font-size: 13.9200000762939px; line-height: 16.7040004730225px; widows: 1; background-color: rgb(255, 255, 255);">　　（1）什么是<strong style="margin: 0px; padding: 0px;">PostBack</strong></p><p style="margin: 10px auto; padding: 0px; font-family: 微软雅黑; font-size: 13.9200000762939px; line-height: 16.7040004730225px; widows: 1; background-color: rgb(255, 255, 255);">　　比如现在正在访问a.aspx这个页面上，点击页面上的某个submit按钮把数据提交到a.asx.cs进行处理，这个过程则可以看作是：“从客户端浏览器把之前的状态数据<span style="margin: 0px; padding: 0px; font-family: 'Microsoft YaHei';"><strong style="margin: 0px; padding: 0px;">提交</strong></span>回来（PostBack）”。</p><blockquote style="margin-top: 20px; margin-bottom: 20px; padding: 15px 20px 15px 60px; border-width: 2px; border-top-style: solid; border-right-style: solid; border-bottom-style: solid; border-color: rgb(239, 239, 239); color: rgb(51, 51, 51); border-top-left-radius: 10px; border-top-right-radius: 10px; border-bottom-right-radius: 10px; border-bottom-left-radius: 10px; min-height: 35px; line-height: 1.6em; font-size: 15px; font-family: 'Microsoft Yahei'; box-shadow: rgb(170, 170, 170) 0px 0px 8px; clear: both; widows: 1; background-image: url(&quot;周旭龙 webForm 基础笔记_files/ea96c2b9-5444-4d19-8766-763b9d9d8e23_128.htm&quot;); background-color: rgb(255, 255, 163); background-position: 9px 0px; background-repeat: no-repeat no-repeat;"><p style="margin: 10px auto; padding: 0px;"><strong style="margin: 0px; padding: 0px;">PS：</strong>设置了runat="server"的Button或者input控件都会渲染生成type="submit"的按钮</p></blockquote><p style="margin: 10px auto; padding: 0px; font-family: 微软雅黑; font-size: 13.9200000762939px; line-height: 16.7040004730225px; widows: 1; background-color: rgb(255, 255, 255);">　　（2）刚刚提到只有点击submit类型的按钮才会提交请求到服务器，那么在以下这种场景如何破呢？</p><div class="cnblogs_code" style="margin-top: 5px; margin-bottom: 5px; padding: 5px; border: 1px solid rgb(204, 204, 204); overflow: auto; widows: 1; background-color: rgb(245, 245, 245); font-family: 'Courier New' !important; font-size: 12px !important;"><img id="code_img_opened_631f8385-8525-4d34-9f0e-af45fccab119" class="code_img_opened" src="周旭龙 webForm 基础笔记_files/529ccb29-b6b1-4263-88a3-1dc46336a5d1.gif" alt="" style="margin-top: 0px; margin-bottom: 0px; padding: 0px 5px 0px 0px; vertical-align: middle;"><div id="cnblogs_code_open_631f8385-8525-4d34-9f0e-af45fccab119" class="cnblogs_code_hide" style="padding: 0px;"><div class="cnblogs_code_toolbar" style="margin-top: 5px; padding: 0px;"><span class="cnblogs_code_copy" style="margin: 0px; padding: 0px 5px 0px 0px; line-height: 1.5 !important;"><a href="" title="复制代码" style="margin: 0px; padding: 1px 3px; color: green; text-decoration: none; border: none !important;"><img src="周旭龙 webForm 基础笔记_files/a24c1b97-8842-4874-a71b-7b061c8268e4.gif" alt="复制代码" style="border-style: none; margin-top: 0px; margin-bottom: 0px; padding: 0px;"></a></span></div><pre style="margin-top: 0px; margin-bottom: 0px; padding: 0px; white-space: pre-wrap; word-wrap: break-word; font-family: 'Courier New' !important;"><span style="margin: 0px; padding: 0px; color: rgb(0, 128, 128); line-height: 1.5 !important;"> 1</span> &lt;form id=<span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); line-height: 1.5 !important;">"</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); line-height: 1.5 !important;">form1</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); line-height: 1.5 !important;">"</span> runat=<span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); line-height: 1.5 !important;">"</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); line-height: 1.5 !important;">server</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); line-height: 1.5 !important;">"</span>&gt;
<span style="margin: 0px; padding: 0px; color: rgb(0, 128, 128); line-height: 1.5 !important;"> 2</span>     &lt;div&gt;
<span style="margin: 0px; padding: 0px; color: rgb(0, 128, 128); line-height: 1.5 !important;"> 3</span>         &lt;asp:DropDownList ID=<span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); line-height: 1.5 !important;">"</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); line-height: 1.5 !important;">ddlProvince</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); line-height: 1.5 !important;">"</span> runat=<span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); line-height: 1.5 !important;">"</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); line-height: 1.5 !important;">server</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); line-height: 1.5 !important;">"</span><span style="margin: 0px; padding: 0px; color: rgb(0, 128, 128); line-height: 1.5 !important;"> 4</span>         onselectedindexchanged=<span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); line-height: 1.5 !important;">"</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); line-height: 1.5 !important;">ddlProvince_SelectedIndexChanged</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); line-height: 1.5 !important;">"</span>&gt;
<span style="margin: 0px; padding: 0px; color: rgb(0, 128, 128); line-height: 1.5 !important;"> 5</span>             &lt;asp:ListItem Value=<span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); line-height: 1.5 !important;">"</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); line-height: 1.5 !important;">BJ</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); line-height: 1.5 !important;">"</span>&gt;北京市&lt;/asp:ListItem&gt;
<span style="margin: 0px; padding: 0px; color: rgb(0, 128, 128); line-height: 1.5 !important;"> 6</span>             &lt;asp:ListItem Value=<span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); line-height: 1.5 !important;">"</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); line-height: 1.5 !important;">CQ</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); line-height: 1.5 !important;">"</span>&gt;重庆市&lt;/asp:ListItem&gt;
<span style="margin: 0px; padding: 0px; color: rgb(0, 128, 128); line-height: 1.5 !important;"> 7</span>             &lt;asp:ListItem Value=<span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); line-height: 1.5 !important;">"</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); line-height: 1.5 !important;">SC</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); line-height: 1.5 !important;">"</span>&gt;四川省&lt;/asp:ListItem&gt;
<span style="margin: 0px; padding: 0px; color: rgb(0, 128, 128); line-height: 1.5 !important;"> 8</span>         &lt;/asp:DropDownList&gt;
<span style="margin: 0px; padding: 0px; color: rgb(0, 128, 128); line-height: 1.5 !important;"> 9</span>         &lt;asp:DropDownList ID=<span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); line-height: 1.5 !important;">"</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); line-height: 1.5 !important;">ddlCity</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); line-height: 1.5 !important;">"</span> runat=<span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); line-height: 1.5 !important;">"</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); line-height: 1.5 !important;">server</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); line-height: 1.5 !important;">"</span>&gt;
<span style="margin: 0px; padding: 0px; color: rgb(0, 128, 128); line-height: 1.5 !important;">10</span>             &lt;asp:ListItem Value=<span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); line-height: 1.5 !important;">"</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); line-height: 1.5 !important;">-1</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); line-height: 1.5 !important;">"</span>&gt;请先选择省份&lt;/asp:ListItem&gt;
<span style="margin: 0px; padding: 0px; color: rgb(0, 128, 128); line-height: 1.5 !important;">11</span>         &lt;/asp:DropDownList&gt;
<span style="margin: 0px; padding: 0px; color: rgb(0, 128, 128); line-height: 1.5 !important;">12</span>     &lt;/div&gt;
<span style="margin: 0px; padding: 0px; color: rgb(0, 128, 128); line-height: 1.5 !important;">13</span> &lt;/form&gt;</pre><div class="cnblogs_code_toolbar" style="margin-top: 5px; padding: 0px;"><span class="cnblogs_code_copy" style="margin: 0px; padding: 0px 5px 0px 0px; line-height: 1.5 !important;"><a href="" title="复制代码" style="margin: 0px; padding: 1px 3px; color: green; text-decoration: none; border: none !important;"><img src="周旭龙 webForm 基础笔记_files/a24c1b97-8842-4874-a71b-7b061c8268e4.gif" alt="复制代码" style="border-style: none; margin-top: 0px; margin-bottom: 0px; padding: 0px;"></a></span></div></div></div><p style="margin: 10px auto; padding: 0px; font-family: 微软雅黑; font-size: 13.9200000762939px; line-height: 16.7040004730225px; widows: 1; background-color: rgb(255, 255, 255);">　　有一个省市两级联动的下拉列表场景，在用户选择一个省份后，自动从服务器获取属于该省份的市名下拉列表。这里使用了DropDownList控件，该控件提供了一个叫做SelectIndexChanged的事件，它会帮我们渲染生成select的onchange的浏览器事件。但是在页面的浏览过程中，我们怎么选择不同的省份，市名称的下拉列表就是不动，因为没有向服务器提交数据请求。</p><p style="margin: 10px auto; padding: 0px; font-family: 微软雅黑; font-size: 13.9200000762939px; line-height: 16.7040004730225px; widows: 1; background-color: rgb(255, 255, 255);">　　①这时候，一位名叫MSDN的大神会告诉你，需要给这个DropDownList控件设置一个AutoPostBack="true"的属性，经调试后果然可行了。但是，作为一个学习者，我们会想知道到底这个AutoPostBack帮我们做了什么事儿？这时，我们可以通过查看浏览器的源代码一探究竟。</p><p style="margin: 10px auto; padding: 0px; font-family: 微软雅黑; font-size: 13.9200000762939px; line-height: 16.7040004730225px; widows: 1; background-color: rgb(255, 255, 255);"><img src="周旭龙 webForm 基础笔记_files/23bed04b-bc7e-4b4a-8f70-134f50b0fd95.jpg" alt="" style="margin-top: 0px; margin-bottom: 0px; padding: 0px; width: 620px;"></p><p style="margin: 10px auto; padding: 0px; font-family: 微软雅黑; font-size: 13.9200000762939px; line-height: 16.7040004730225px; widows: 1; background-color: rgb(255, 255, 255);">　　②通过浏览器提供的开发人员工具查看数据请求报文，可以看到除了提交form中的input外，还提交了ASP.Net WebForm预置的一些隐藏字段，而这些隐藏字段则是WebForm为我们提供便利的基础。比如EventTarget则记录刚刚提交给服务器的是哪个服务器控件。</p><p style="margin: 10px auto; padding: 0px; font-family: 微软雅黑; font-size: 13.9200000762939px; line-height: 16.7040004730225px; widows: 1; background-color: rgb(255, 255, 255);"><img src="周旭龙 webForm 基础笔记_files/aeaf0376-6961-41f8-9fbb-f16c9eeb6f78.jpg" alt="" style="margin: 0px auto; padding: 0px; display: block; width: 620px;"></p><h2 style="margin: 15px auto 2px; font-size: 21px; font-family: 微软雅黑; widows: 1; background-color: rgb(255, 255, 255);">2.4 为什么需要IsPostBack</h2><p style="margin: 10px auto; padding: 0px; font-family: 微软雅黑; font-size: 13.9200000762939px; line-height: 16.7040004730225px; widows: 1; background-color: rgb(255, 255, 255);">　　<span style="margin: 0px; padding: 0px; font-family: 'Microsoft YaHei';"><strong style="margin: 0px; padding: 0px;">注：WebForm页面中如果有一个runat="server"的form，那么必定会涉及到IsPostBack。</strong></span></p><p style="margin: 10px auto; padding: 0px; font-family: 微软雅黑; font-size: 13.9200000762939px; line-height: 16.7040004730225px; widows: 1; background-color: rgb(255, 255, 255);">　　（1）Http的无状态：因为Http是无状态的，所以这次会话结束下次再给我提交请求我也不记得你是谁，即使你是李刚的儿子，老子也不认识。那么，为了解决这种问题，我们可以使用一些方法来解决，例如设置一个隐藏字段来判断，如果是PostBack那么肯定请求报文中会带上这个字段，如果不是那么请求报文中肯定没有这个字段。比如，下面我们使用隐藏字段来作为判断PostBack的标志。</p><div class="cnblogs_code" style="margin-top: 5px; margin-bottom: 5px; padding: 5px; border: 1px solid rgb(204, 204, 204); overflow: auto; widows: 1; background-color: rgb(245, 245, 245); font-family: 'Courier New' !important; font-size: 12px !important;"><pre style="margin-top: 0px; margin-bottom: 0px; padding: 0px; white-space: pre-wrap; word-wrap: break-word; font-family: 'Courier New' !important;"> &lt;input name=<span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); line-height: 1.5 !important;">"</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); line-height: 1.5 !important;">IsPostBack</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); line-height: 1.5 !important;">"</span> type=<span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); line-height: 1.5 !important;">"</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); line-height: 1.5 !important;">hidden</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); line-height: 1.5 !important;">"</span> value=<span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); line-height: 1.5 !important;">"</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); line-height: 1.5 !important;">true</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); line-height: 1.5 !important;">"</span> /&gt;</pre></div><p style="margin: 10px auto; padding: 0px; font-family: 微软雅黑; font-size: 13.9200000762939px; line-height: 16.7040004730225px; widows: 1; background-color: rgb(255, 255, 255);">　　（2）ASP.Net WebForm中内置了一个IsPostBack属性（bool类型），我们可以在Page_Load事件中判断IsPostBack是否为true，如果不为true则可以知道是第一次访问或者是请求页面的操作，而如果为true则代表是PostBack操作，我们可以分别进行不同的业务逻辑处理。例如：有的代码只会在页面第一次加载时才执行（比如从数据库中读取数据并显示），这时就应该使用IsPostBack进行判断。</p><div class="cnblogs_code" style="margin-top: 5px; margin-bottom: 5px; padding: 5px; border: 1px solid rgb(204, 204, 204); overflow: auto; widows: 1; background-color: rgb(245, 245, 245); font-family: 'Courier New' !important; font-size: 12px !important;"><div class="cnblogs_code_toolbar" style="margin-top: 5px; padding: 0px;"><span class="cnblogs_code_copy" style="margin: 0px; padding: 0px 5px 0px 0px; line-height: 1.5 !important;"><a href="" title="复制代码" style="margin: 0px; padding: 1px 3px; color: green; text-decoration: none; border: none !important;"><img src="周旭龙 webForm 基础笔记_files/a24c1b97-8842-4874-a71b-7b061c8268e4.gif" alt="复制代码" style="border-style: none; margin-top: 0px; margin-bottom: 0px; padding: 0px;"></a></span></div><pre style="margin-top: 0px; margin-bottom: 0px; padding: 0px; white-space: pre-wrap; word-wrap: break-word; font-family: 'Courier New' !important;"><span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); line-height: 1.5 !important;">if</span> (!<span style="margin: 0px; padding: 0px; line-height: 1.5 !important;">IsPostBack)
{
    </span><span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); line-height: 1.5 !important;">this</span>.lblInfo.Text = <span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); line-height: 1.5 !important;">"</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); line-height: 1.5 !important;">第一次来，不是PostBack</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); line-height: 1.5 !important;">"</span><span style="margin: 0px; padding: 0px; line-height: 1.5 !important;">;
}
</span><span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); line-height: 1.5 !important;">else</span><span style="margin: 0px; padding: 0px; line-height: 1.5 !important;">
{
    </span><span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); line-height: 1.5 !important;">this</span>.lblInfo.Text = <span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); line-height: 1.5 !important;">"</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); line-height: 1.5 !important;">非第一次来，是PostBack</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); line-height: 1.5 !important;">"</span><span style="margin: 0px; padding: 0px; line-height: 1.5 !important;">;
}</span></pre><div class="cnblogs_code_toolbar" style="margin-top: 5px; padding: 0px;"><span class="cnblogs_code_copy" style="margin: 0px; padding: 0px 5px 0px 0px; line-height: 1.5 !important;"><a href="" title="复制代码" style="margin: 0px; padding: 1px 3px; color: green; text-decoration: none; border: none !important;"><img src="周旭龙 webForm 基础笔记_files/a24c1b97-8842-4874-a71b-7b061c8268e4.gif" alt="复制代码" style="border-style: none; margin-top: 0px; margin-bottom: 0px; padding: 0px;"></a></span></div></div><p style="margin: 10px auto; padding: 0px; font-family: 微软雅黑; font-size: 13.9200000762939px; line-height: 16.7040004730225px; widows: 1; background-color: rgb(255, 255, 255);">　　（3）通过查看生成的页面html代码，我们没有发现页面中有IsPostBack的这个隐藏字段。那么，它是存储在哪个位置又是根据什么来判断的呢？实际上，IsPostBack属性是根据ViewState中的一些特殊的键值对来判断赋值的（因为：每次提交请求后，服务器端都会返回不同的ViewState隐藏域给浏览器端；同样，浏览器每次也会将ViewState提交给服务器端，服务器端会解析ViewState还原上次状态）。对于ViewState，可以通过一些软件例如ViewStateDecoder进行解析查看，例如下图：</p><p style="margin: 10px auto; padding: 0px; font-family: 微软雅黑; font-size: 13.9200000762939px; line-height: 16.7040004730225px; widows: 1; background-color: rgb(255, 255, 255);"><img src="周旭龙 webForm 基础笔记_files/b51f613b-b27a-4f91-93e7-dde483a79e3b.jpg" alt="" style="margin: 0px auto; padding: 0px; display: block; width: 620px;"></p><p style="margin: 10px auto; padding: 0px; font-family: 微软雅黑; font-size: 13.9200000762939px; line-height: 16.7040004730225px; widows: 1; background-color: rgb(255, 255, 255);">　　如果我们禁用了ViewState，那么也就无法正常使用IsPostBack属性了，也无法正常使用PostBack了。那么对于ViewState，我会在下一篇进行简单探秘，本篇就到此为止。</p><p style="margin: 10px auto; padding: 0px; font-family: 微软雅黑; font-size: 13.9200000762939px; line-height: 16.7040004730225px; widows: 1; background-color: rgb(255, 255, 255);">　　<span style="margin: 0px; padding: 0px; font-family: 'Microsoft YaHei';"><strong style="margin: 0px; padding: 0px;">如果你觉得本文对你有用，那就麻烦点个“推荐”吧，也能让我更有动力写下去，谢谢！</strong></span></p><h1 style="padding-top: 5px; padding-bottom: 5px; padding-left: 20px; font-size: 17px; border-top-left-radius: 6px; border-top-right-radius: 6px; border-bottom-right-radius: 6px; border-bottom-left-radius: 6px; box-shadow: rgb(95, 90, 75) 0px 0px 0px 1px, rgba(10, 10, 0, 0.498039) 1px 1px 6px 1px; color: white; font-family: 微软雅黑, 宋体, 黑体, Arial; height: 25px; line-height: 25px; text-shadow: rgb(34, 34, 34) 2px 2px 3px; width: 601.400024414063px; widows: 1; background-color: rgb(43, 102, 149); margin-top: 15px !important; margin-bottom: 15px !important;">附件下载</h1><p style="margin: 10px auto; padding: 0px; font-family: 微软雅黑; font-size: 13.9200000762939px; line-height: 16.7040004730225px; widows: 1; background-color: rgb(255, 255, 255);">　　（1）反编译利器ILSpy：<a href="https://github.com/icsharpcode/ILSpy/releases/download/2.2/ILSpy_2.2.0.1706_Binaries.zip" target="_blank" style="margin: 0px; padding: 1px 3px; color: green; text-decoration: none;">https://github.com/icsharpcode/ILSpy/releases/download/2.2/ILSpy_2.2.0.1706_Binaries.zip</a></p><p style="margin: 10px auto; padding: 0px; font-family: 微软雅黑; font-size: 13.9200000762939px; line-height: 16.7040004730225px; widows: 1; background-color: rgb(255, 255, 255);">　　（2）aspx揭秘的WebFormDemo：<a href="http://pan.baidu.com/s/1ntqOl4H" target="_blank" style="margin: 0px; padding: 1px 3px; color: green; text-decoration: none;">http://pan.baidu.com/s/1ntqOl4H</a></p><p style="margin: 10px auto; padding: 0px; font-family: 微软雅黑; font-size: 13.9200000762939px; line-height: 16.7040004730225px; widows: 1; background-color: rgb(255, 255, 255);">　　（3）服务器控件揭秘WebFormDemo：<a href="http://pan.baidu.com/s/1qWFK8cW" target="_blank" style="margin: 0px; padding: 1px 3px; color: green; text-decoration: none;">http://pan.baidu.com/s/1qWFK8cW</a></p><p style="margin: 10px auto; padding: 0px; font-family: 微软雅黑; font-size: 13.9200000762939px; line-height: 16.7040004730225px; widows: 1; background-color: rgb(255, 255, 255);"><br></p><p style="margin: 10px auto; padding: 0px; font-family: 微软雅黑; font-size: 13.9200000762939px; line-height: 16.7040004730225px; widows: 1; background-color: rgb(255, 255, 255);">----------------------------------------------------------------------------------------------------------------------------------</p></div></h2><h1 class="postTitle" style="margin: 0px 0px 10px; padding: 0px 15px; font-size: 12.17391300201416px; font-weight: normal; background-image: url(&quot;&quot;); width: 660px; font-family: 微软雅黑; line-height: 15.65217399597168px; background-color: rgb(255, 255, 255); background-position: -10px 0px; background-repeat: no-repeat repeat;"><a id="cb_post_title_url" class="postTitle2" href="http://www.cnblogs.com/edisonchou/p/3901559.html" style="margin: 0px; padding: 0px; font-size: 24.34782600402832px; color: rgb(0, 0, 0); text-decoration: none; width: 660px;">ASP.Net WebForm温故知新学习笔记：二、ViewState与UpdatePanel探秘</a></h1><div class="clear" style="margin: 0px; padding: 0px; clear: both; font-family: 微软雅黑; font-size: 12.17391300201416px; line-height: 15.65217399597168px; background-color: rgb(255, 255, 255);"></div><div class="postBody" style="margin: 0px 0px 5px; padding: 0px 15px; font-family: 微软雅黑; background-color: rgb(255, 255, 255);"><div id="cnblogs_post_body" style="margin: 0px 0px 30px; padding: 0px; word-break: break-word; overflow: auto; width: 660px;"><p style="margin: 10px auto; padding: 0px;"><span style="margin: 0px; padding: 0px; font-family: 仿宋;"><strong style="margin: 0px; padding: 0px;">开篇：经历了上一篇<span style="margin: 0px; padding: 0px; font-family: verdana, geneva;">《<a href="http://www.cnblogs.com/edisonchou/p/3899123.html" target="_blank" style="margin: 0px; padding: 1px 3px; color: green; text-decoration: none;">aspx<span style="margin: 0px; padding: 0px; font-family: 仿宋;">与服务器控件探秘</span></a>》</span>后，我们了解了<span style="margin: 0px; padding: 0px; font-family: verdana, geneva;">aspx</span>和服务器控件背后的故事。这篇我们开始走进<span style="margin: 0px; padding: 0px; font-family: verdana, geneva;">WebForm</span>状态保持的一大法宝—<span style="margin: 0px; padding: 0px; font-family: verdana, geneva;">ViewState</span>，对其刨根究底一下。然后，再对曾经很流行的<span style="margin: 0px; padding: 0px; font-family: verdana, geneva;">ASP.Net AJAX</span>方案中的利器—<span style="margin: 0px; padding: 0px; font-family: verdana, geneva;">UpdatePanel</span>这个神奇的区域一探究竟。</strong></span></p><h1 style="padding: 5px 0px 5px 20px; font-size: 17px; background-color: rgb(43, 102, 149); border-top-left-radius: 6px; border-top-right-radius: 6px; border-bottom-right-radius: 6px; border-bottom-left-radius: 6px; box-shadow: rgb(95, 90, 75) 0px 0px 0px 1px, rgba(10, 10, 0, 0.498039) 1px 1px 6px 1px; color: white; font-family: 微软雅黑, 宋体, 黑体, Arial; height: 25px; line-height: 25px; text-shadow: rgb(34, 34, 34) 2px 2px 3px; width: 640.1902465820313px; margin: 15px 0px !important;">一、隐藏的状态—ViewState探秘</h1><h2 style="margin: 15px auto 2px; padding: 0px; font-size: 21px;">1.1 从Http的无状态说起</h2><p style="margin: 10px auto; padding: 0px;">　　Http是一个无状态协议，同一个会话的连续两个请求互相不了解，它们由最新实例化的环境进行解析，除了应用本身可能已经存储在全局对象中的所有信息外，该环境<strong style="margin: 0px; padding: 0px;">不保存与会话有关的任何信息</strong>。另外，因为，浏览器和服务器之间是<strong style="margin: 0px; padding: 0px;">通过Socket进行通信</strong>，Http请求通常请求完毕就会关闭Socket连接，因此Http协议<strong style="margin: 0px; padding: 0px;">不会保持连接</strong>。如果保持连接会降低客户端并发处理请求数，不保持连接又会降低处理速度（建立连接所需的时间会长一点）；</p><blockquote style="margin: 20px 0px; padding: 15px 20px 15px 60px; background-image: url(&quot;&quot;); background-color: rgb(255, 255, 163); border: 2px solid rgb(239, 239, 239); color: rgb(51, 51, 51); border-top-left-radius: 10px; border-top-right-radius: 10px; border-bottom-right-radius: 10px; border-bottom-left-radius: 10px; min-height: 35px; line-height: 1.6em; font-size: 15px; font-family: 'Microsoft Yahei'; box-shadow: rgb(170, 170, 170) 0px 0px 8px; clear: both; background-position: 9px 0px; background-repeat: no-repeat no-repeat;"><p style="margin: 10px auto; padding: 0px;"><strong style="margin: 0px; padding: 0px;">PS：</strong>这里我们可以这样来理解：假如我们去一个大型商场购物购买某个产品，第一次去的时候是A销售员接待了我们，带领我们来到XX产品的柜台并为我们推荐了XX产品；等我们回去使用XX产品后，觉得XX产品真心不错。第二次我们又去，但是这次却找不到上次那个A销售员了，相反商场分配了另一个B销售员来接待我们，他不知道我们上次选择了XX产品，相反它却一个劲地向我们推荐YY产品并把我们带向YY产品的柜台；这个时候，我们一般会说：<span style="margin: 0px; padding: 0px; color: rgb(255, 0, 0);"><strong style="margin: 0px; padding: 0px;">我擦，把上次那个妹子给我叫来！</strong></span></p></blockquote><p style="margin: 10px auto; padding: 0px;">　　基于Http协议的无状态特性，我们在ASP.Net的开发中也会经常碰到这种情况：用户上一次提交的东西，下次再提交时服务器就不记得了。很多时候，我们感到很不解？后来，我们发现原来每一次的请求服务器都开启了不同的线程来处理，也就是说每次都会new一个XXX.aspx.cs中的类对象实例来进行处理（上一次new出来为我们处理的page对象也许早就被服务器销毁了）。比如，我们在xxx.aspx.cs代码中写入了一个int类型的number成员（初始为0），每次请求我们都想让这个number自增一下，然后重新返回给浏览器。但就是这么一个简单的梦想，我们却无法轻易的实现。</p><p style="margin: 10px auto; padding: 0px;"><img src="周旭龙 webForm 基础笔记_files/25bb8dc7-13d0-4084-8850-59d5e762f9a8.jpg" alt="" style="margin: 0px auto; padding: 0px; display: block;"></p><p style="margin: 10px auto; padding: 0px;">　　那么，到底怎么来破呢？大神们已经为我们想好了策略，我们可以使用隐藏域字段、Cookie、Session等来保存状态。而伟大的Microsoft还在ASP.Net中帮我们封装了<strong style="margin: 0px; padding: 0px;">ViewState</strong>，以至于我们在WebForm中进行PostBack操作时，都感觉不到服务器是无状态的。</p><h2 style="margin: 15px auto 2px; padding: 0px; font-size: 21px;">1.2 青春四处绽放—无处不在的ViewState</h2><p style="margin: 10px auto; padding: 0px;">　　（1）类似于Dictionary的一种数据结构</p><p style="margin: 10px auto; padding: 0px;">　　如果你曾经使用过Dictionary或者Session的话，那么你应该了解这种Key/Value的数据结构。这里并没有什么高深的理论，ViewState通过String类型的数据作为索引。ViewState对应项中的值可以存储任何类型的值（参数是Object类型），实施上任何类型的值存储到ViewState中都会被装箱为Object类型。</p><p style="margin: 10px auto; padding: 0px;">　　例如，这里我们可以改写上面那个按钮事件中的代码：</p><div class="cnblogs_code" style="margin: 5px 0px; padding: 5px; background-color: rgb(245, 245, 245); border: 1px solid rgb(204, 204, 204); overflow: auto; font-family: 'Courier New' !important; font-size: 12px !important;"><img id="code_img_opened_e9f7fb7d-2bde-4376-8e2d-a4462069cfac" class="code_img_opened" src="周旭龙 webForm 基础笔记_files/7a8e2ef3-0a6e-4377-baf6-62331a3798c0.gif" alt="" style="margin: 0px; padding: 0px 5px 0px 0px; vertical-align: middle;"><div id="cnblogs_code_open_e9f7fb7d-2bde-4376-8e2d-a4462069cfac" class="cnblogs_code_hide" style="margin: 0px; padding: 0px;"><div class="cnblogs_code_toolbar" style="margin: 5px 0px 0px; padding: 0px;"><span class="cnblogs_code_copy" style="margin: 0px; padding: 0px 5px 0px 0px; font-size: 12px !important; line-height: 1.5 !important;"><a href="" title="复制代码" style="margin: 0px; padding: 1px 3px; color: green; text-decoration: none; border: none !important;"><img src="周旭龙 webForm 基础笔记_files/36677de3-436f-49a4-bd1e-4b1d88de499f.gif" alt="复制代码" style="margin: 0px; padding: 0px; border-style: none !important;"></a></span></div><pre style="margin-top: 0px; margin-bottom: 0px; padding: 0px; white-space: pre-wrap; word-wrap: break-word; font-family: 'Courier New' !important; font-size: 12px !important;"><span style="margin: 0px; padding: 0px; color: rgb(0, 128, 128); font-size: 12px !important; line-height: 1.5 !important;"> 1</span> <span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">protected</span> <span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">void</span> btnGetNumber_Click(<span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">object</span><span style="margin: 0px; padding: 0px; font-size: 12px !important; line-height: 1.5 !important;"> sender, EventArgs e)
</span><span style="margin: 0px; padding: 0px; color: rgb(0, 128, 128); font-size: 12px !important; line-height: 1.5 !important;"> 2</span> <span style="margin: 0px; padding: 0px; font-size: 12px !important; line-height: 1.5 !important;">{
</span><span style="margin: 0px; padding: 0px; color: rgb(0, 128, 128); font-size: 12px !important; line-height: 1.5 !important;"> 3</span>     <span style="margin: 0px; padding: 0px; color: rgb(0, 128, 0); font-size: 12px !important; line-height: 1.5 !important;">//</span><span style="margin: 0px; padding: 0px; color: rgb(0, 128, 0); font-size: 12px !important; line-height: 1.5 !important;">number++;
</span><span style="margin: 0px; padding: 0px; color: rgb(0, 128, 128); font-size: 12px !important; line-height: 1.5 !important;"> 4</span>     <span style="margin: 0px; padding: 0px; color: rgb(0, 128, 0); font-size: 12px !important; line-height: 1.5 !important;">//</span><span style="margin: 0px; padding: 0px; color: rgb(0, 128, 0); font-size: 12px !important; line-height: 1.5 !important;">this.lblNumber.Text = number.ToString();</span><span style="margin: 0px; padding: 0px; color: rgb(0, 128, 128); font-size: 12px !important; line-height: 1.5 !important;"> 5</span><span style="margin: 0px; padding: 0px; color: rgb(0, 128, 128); font-size: 12px !important; line-height: 1.5 !important;"> 6</span>     <span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">object</span> age = <span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">this</span>.ViewState[<span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); font-size: 12px !important; line-height: 1.5 !important;">"</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); font-size: 12px !important; line-height: 1.5 !important;">age</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); font-size: 12px !important; line-height: 1.5 !important;">"</span><span style="margin: 0px; padding: 0px; font-size: 12px !important; line-height: 1.5 !important;">];
</span><span style="margin: 0px; padding: 0px; color: rgb(0, 128, 128); font-size: 12px !important; line-height: 1.5 !important;"> 7</span>     <span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">if</span> (age == <span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">null</span><span style="margin: 0px; padding: 0px; font-size: 12px !important; line-height: 1.5 !important;">)
</span><span style="margin: 0px; padding: 0px; color: rgb(0, 128, 128); font-size: 12px !important; line-height: 1.5 !important;"> 8</span> <span style="margin: 0px; padding: 0px; font-size: 12px !important; line-height: 1.5 !important;">    {
</span><span style="margin: 0px; padding: 0px; color: rgb(0, 128, 128); font-size: 12px !important; line-height: 1.5 !important;"> 9</span>         age = <span style="margin: 0px; padding: 0px; color: rgb(128, 0, 128); font-size: 12px !important; line-height: 1.5 !important;">1</span><span style="margin: 0px; padding: 0px; font-size: 12px !important; line-height: 1.5 !important;">;
</span><span style="margin: 0px; padding: 0px; color: rgb(0, 128, 128); font-size: 12px !important; line-height: 1.5 !important;">10</span> <span style="margin: 0px; padding: 0px; font-size: 12px !important; line-height: 1.5 !important;">    }
</span><span style="margin: 0px; padding: 0px; color: rgb(0, 128, 128); font-size: 12px !important; line-height: 1.5 !important;">11</span>     <span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">else</span><span style="margin: 0px; padding: 0px; color: rgb(0, 128, 128); font-size: 12px !important; line-height: 1.5 !important;">12</span> <span style="margin: 0px; padding: 0px; font-size: 12px !important; line-height: 1.5 !important;">    {
</span><span style="margin: 0px; padding: 0px; color: rgb(0, 128, 128); font-size: 12px !important; line-height: 1.5 !important;">13</span>         age = Convert.ToInt32(age) + <span style="margin: 0px; padding: 0px; color: rgb(128, 0, 128); font-size: 12px !important; line-height: 1.5 !important;">1</span><span style="margin: 0px; padding: 0px; font-size: 12px !important; line-height: 1.5 !important;">;
</span><span style="margin: 0px; padding: 0px; color: rgb(0, 128, 128); font-size: 12px !important; line-height: 1.5 !important;">14</span> <span style="margin: 0px; padding: 0px; font-size: 12px !important; line-height: 1.5 !important;">    }
</span><span style="margin: 0px; padding: 0px; color: rgb(0, 128, 128); font-size: 12px !important; line-height: 1.5 !important;">15</span>     <span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">this</span>.ViewState[<span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); font-size: 12px !important; line-height: 1.5 !important;">"</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); font-size: 12px !important; line-height: 1.5 !important;">age</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); font-size: 12px !important; line-height: 1.5 !important;">"</span>] =<span style="margin: 0px; padding: 0px; font-size: 12px !important; line-height: 1.5 !important;"> age;
</span><span style="margin: 0px; padding: 0px; color: rgb(0, 128, 128); font-size: 12px !important; line-height: 1.5 !important;">16</span>     <span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">this</span>.lblNumber.Text =<span style="margin: 0px; padding: 0px; font-size: 12px !important; line-height: 1.5 !important;"> age.ToString();
</span><span style="margin: 0px; padding: 0px; color: rgb(0, 128, 128); font-size: 12px !important; line-height: 1.5 !important;">17</span> }</pre><div class="cnblogs_code_toolbar" style="margin: 5px 0px 0px; padding: 0px;"><span class="cnblogs_code_copy" style="margin: 0px; padding: 0px 5px 0px 0px; font-size: 12px !important; line-height: 1.5 !important;"><a href="" title="复制代码" style="margin: 0px; padding: 1px 3px; color: green; text-decoration: none; border: none !important;"><img src="周旭龙 webForm 基础笔记_files/36677de3-436f-49a4-bd1e-4b1d88de499f.gif" alt="复制代码" style="margin: 0px; padding: 0px; border-style: none !important;"></a></span></div></div></div><p style="margin: 10px auto; padding: 0px;">&nbsp;　　这里，我们借助ViewState存储了age的状态值，第一次来我给你返回1，后面再来我就加1再返回给你。于是，在上一节我们所提到的那个问题（无法记住上次的number值，每次都返回1）就解决了。</p><blockquote style="margin: 20px 0px; padding: 15px 20px 15px 60px; background-image: url(&quot;&quot;); background-color: rgb(255, 255, 163); border: 2px solid rgb(239, 239, 239); color: rgb(51, 51, 51); border-top-left-radius: 10px; border-top-right-radius: 10px; border-bottom-right-radius: 10px; border-bottom-left-radius: 10px; min-height: 35px; line-height: 1.6em; font-size: 15px; font-family: 'Microsoft Yahei'; box-shadow: rgb(170, 170, 170) 0px 0px 8px; clear: both; background-position: 9px 0px; background-repeat: no-repeat no-repeat;"><p style="margin: 10px auto; padding: 0px;"><strong style="margin: 0px; padding: 0px;">PS：</strong>ViewState不能存储所有的数据类型，仅支持以下的这几种：<br style="margin: 0px; padding: 0px;">String、Integer、Boolean、Array、ArrayList、Hashtable以及一些自定义类型</p></blockquote><p style="margin: 10px auto; padding: 0px;">　　我们都知道，Dictionary和Session都是存储在服务器端的。那么，我们不禁要问，既然我们在服务器端给ViewState增加了一个Key/Value对，并返回给浏览器端，<strong style="margin: 0px; padding: 0px;">ViewState又是存储在什么位置的呢？</strong></p><p style="margin: 10px auto; padding: 0px;">　　（2）大隐隐于市的“<strong style="margin: 0px; padding: 0px;">页面级</strong>”隐藏字段</p><p style="margin: 10px auto; padding: 0px;">　　跟Session和Dictionary的存储位置不同，<strong style="margin: 0px; padding: 0px;">ViewState的作用域是<span style="margin: 0px; padding: 0px; text-decoration: underline;">页面</span></strong>，也就是说<strong style="margin: 0px; padding: 0px;">ViewState是存储在浏览器的页面之中的</strong>（这里相比Session等，耗费的服务器资源较少，也算是ViewState的优点之一吧），当你关闭某个aspx文件后，那么属于这个aspx的ViewState也就不存在了。或许，这么说来，我们还不是很了解，现在我们来实地看看。</p><p style="margin: 10px auto; padding: 0px;"><img src="周旭龙 webForm 基础笔记_files/d70f55db-c28b-4ad3-8f15-3f8bb0cd4da7.jpg" alt="" style="margin: 0px auto; padding: 0px; display: block; width: 660px;"></p><p style="margin: 10px auto; padding: 0px;">　　①首先，<strong style="margin: 0px; padding: 0px;">如果页面上有一个runat="server"的form</strong>，当用户请求这个页面时，服务器会自动添加一个_ViewState的隐藏域返回给浏览器。但是，我们发现这个ViewState的value看起来像一串乱码？这是为什么呢？这是因为服务器在向浏览器返回html之前，对ViewState中的内容进行了<strong style="margin: 0px; padding: 0px;">Base64的加密编码</strong>；</p><p style="margin: 10px auto; padding: 0px;">　　②其次，当用户点击页面中的某个按钮提交表单时，浏览器会将这个_VIEWSTATE的隐藏域也一起提交到服务端；服务器端在解析请求时，会将浏览器提交过来的ViewState进行反序列化后填充到ViewState属性中（比如下图中，我们可以通过一个软件将_VIEWSTATE解码得到一个如下图所示的树形结构）；再根据业务处理需要，从这个属性中根据索引找到具体的Value值并对其进行操作；操作完成后，再将ViewState进行Base64编码再次返回给浏览器端；</p><p style="margin: 10px auto; padding: 0px;"><img src="周旭龙 webForm 基础笔记_files/0c504f11-98da-46f5-ab58-db5431f230ac.jpg" alt="" style="margin: 0px auto; padding: 0px; display: block; width: 660px;"></p><p style="margin: 10px auto; padding: 0px;">　　③因此，我们可以得出一个结论：<strong style="margin: 0px; padding: 0px;">VIEWSTATE适用于同一个页面在不关闭的情况下多次与服务器交互</strong>（PostBack）。这里我们也可以通过下图来温习一下ViewState的流程，<strong style="margin: 0px; padding: 0px;">ViewState存放着“事故现场”，下次可以方便地“还原现场”，将无状态的Http模拟成了有状态的</strong>，也让广大的初学者了解不到无状态的这个特性。</p><p style="margin: 10px auto; padding: 0px;"><img src="周旭龙 webForm 基础笔记_files/9bbef78b-1310-4387-b580-798e7124aead.jpg" alt="" style="margin: 0px auto; padding: 0px; display: block;"></p><h2 style="margin: 15px auto 2px; padding: 0px; font-size: 21px;">1.3 喜欢就会放肆—又爱又恨的ViewState！</h2><p style="margin: 10px auto; padding: 0px;">　　事实上，除了我们手动在服务器端向ViewState属性中添加的K/V对数据，我们在aspx.cs代码中为<strong style="margin: 0px; padding: 0px;">某些服务器控件</strong>设置的值（例如：为Repeater设置DataSource中存入的数据集、为Label所设置的Text内容等，<strong style="margin: 0px; padding: 0px;">但不包括：TextBox、CheckBox、CheckboxList、RadioButtonList</strong>）都存入了ViewState中。这样做的话，我们下次再向服务器提交请求时，现有表单中所有的服务器控件状态都会记录在ViewState中提交到服务器，在服务器端可以方便地对这些服务器控件进行有状态的操作并返回，这无疑是让我们欢喜的，因为方便了我们的开发过程，提高了我们的开发效率；</p><p style="margin: 10px auto; padding: 0px;">　　<strong style="margin: 0px; padding: 0px;">但有人说：“喜欢就会放肆”，ViewState让人又爱又恨啊</strong>。例如，在我们使用Repeater的过程中，WebForm会自动将DataSource（数据源，你可以理解为一个集合）存储到ViewState中并返回给浏览器。可以参考下面的例子来实地理解一下：</p><p style="margin: 10px auto; padding: 0px;">　　①含有Repeater的aspx页面：</p><div class="cnblogs_code" style="margin: 5px 0px; padding: 5px; background-color: rgb(245, 245, 245); border: 1px solid rgb(204, 204, 204); overflow: auto; font-family: 'Courier New' !important; font-size: 12px !important;"><img id="code_img_opened_80ba05a7-cb65-46b9-a35e-8d9cd0d968a6" class="code_img_opened" src="周旭龙 webForm 基础笔记_files/7a8e2ef3-0a6e-4377-baf6-62331a3798c0.gif" alt="" style="margin: 0px; padding: 0px 5px 0px 0px; vertical-align: middle;"><div id="cnblogs_code_open_80ba05a7-cb65-46b9-a35e-8d9cd0d968a6" class="cnblogs_code_hide" style="margin: 0px; padding: 0px;"><div class="cnblogs_code_toolbar" style="margin: 5px 0px 0px; padding: 0px;"><span class="cnblogs_code_copy" style="margin: 0px; padding: 0px 5px 0px 0px; font-size: 12px !important; line-height: 1.5 !important;"><a href="" title="复制代码" style="margin: 0px; padding: 1px 3px; color: green; text-decoration: none; border: none !important;"><img src="周旭龙 webForm 基础笔记_files/36677de3-436f-49a4-bd1e-4b1d88de499f.gif" alt="复制代码" style="margin: 0px; padding: 0px; border-style: none !important;"></a></span></div><pre style="margin-top: 0px; margin-bottom: 0px; padding: 0px; white-space: pre-wrap; word-wrap: break-word; font-family: 'Courier New' !important; font-size: 12px !important;"><span style="margin: 0px; padding: 0px; color: rgb(0, 128, 128); font-size: 12px !important; line-height: 1.5 !important;"> 1</span>     <span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">&lt;</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); font-size: 12px !important; line-height: 1.5 !important;">form </span><span style="margin: 0px; padding: 0px; color: rgb(255, 0, 0); font-size: 12px !important; line-height: 1.5 !important;">id</span><span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">="form1"</span><span style="margin: 0px; padding: 0px; color: rgb(255, 0, 0); font-size: 12px !important; line-height: 1.5 !important;"> runat</span><span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">="server"</span><span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">&gt;</span><span style="margin: 0px; padding: 0px; color: rgb(0, 128, 128); font-size: 12px !important; line-height: 1.5 !important;"> 2</span>         <span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">&lt;</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); font-size: 12px !important; line-height: 1.5 !important;">div </span><span style="margin: 0px; padding: 0px; color: rgb(255, 0, 0); font-size: 12px !important; line-height: 1.5 !important;">align</span><span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">="center"</span><span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">&gt;</span><span style="margin: 0px; padding: 0px; color: rgb(0, 128, 128); font-size: 12px !important; line-height: 1.5 !important;"> 3</span>             <span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">&lt;</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); font-size: 12px !important; line-height: 1.5 !important;">table </span><span style="margin: 0px; padding: 0px; color: rgb(255, 0, 0); font-size: 12px !important; line-height: 1.5 !important;">class</span><span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">="test"</span><span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">&gt;</span><span style="margin: 0px; padding: 0px; color: rgb(0, 128, 128); font-size: 12px !important; line-height: 1.5 !important;"> 4</span>                 <span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">&lt;</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); font-size: 12px !important; line-height: 1.5 !important;">tr </span><span style="margin: 0px; padding: 0px; color: rgb(255, 0, 0); font-size: 12px !important; line-height: 1.5 !important;">class</span><span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">="first"</span><span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">&gt;</span><span style="margin: 0px; padding: 0px; color: rgb(0, 128, 128); font-size: 12px !important; line-height: 1.5 !important;"> 5</span>                     <span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">&lt;</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); font-size: 12px !important; line-height: 1.5 !important;">td</span><span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">&gt;</span><span style="margin: 0px; padding: 0px; color: rgb(0, 128, 128); font-size: 12px !important; line-height: 1.5 !important;"> 6</span> <span style="margin: 0px; padding: 0px; font-size: 12px !important; line-height: 1.5 !important;">                        ID
</span><span style="margin: 0px; padding: 0px; color: rgb(0, 128, 128); font-size: 12px !important; line-height: 1.5 !important;"> 7</span>                     <span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">&lt;/</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); font-size: 12px !important; line-height: 1.5 !important;">td</span><span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">&gt;</span><span style="margin: 0px; padding: 0px; color: rgb(0, 128, 128); font-size: 12px !important; line-height: 1.5 !important;"> 8</span>                     <span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">&lt;</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); font-size: 12px !important; line-height: 1.5 !important;">td</span><span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">&gt;</span><span style="margin: 0px; padding: 0px; color: rgb(0, 128, 128); font-size: 12px !important; line-height: 1.5 !important;"> 9</span> <span style="margin: 0px; padding: 0px; font-size: 12px !important; line-height: 1.5 !important;">                        产品名称
</span><span style="margin: 0px; padding: 0px; color: rgb(0, 128, 128); font-size: 12px !important; line-height: 1.5 !important;">10</span>                     <span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">&lt;/</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); font-size: 12px !important; line-height: 1.5 !important;">td</span><span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">&gt;</span><span style="margin: 0px; padding: 0px; color: rgb(0, 128, 128); font-size: 12px !important; line-height: 1.5 !important;">11</span>                     <span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">&lt;</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); font-size: 12px !important; line-height: 1.5 !important;">td</span><span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">&gt;</span><span style="margin: 0px; padding: 0px; color: rgb(0, 128, 128); font-size: 12px !important; line-height: 1.5 !important;">12</span> <span style="margin: 0px; padding: 0px; font-size: 12px !important; line-height: 1.5 !important;">                        产品描述
</span><span style="margin: 0px; padding: 0px; color: rgb(0, 128, 128); font-size: 12px !important; line-height: 1.5 !important;">13</span>                     <span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">&lt;/</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); font-size: 12px !important; line-height: 1.5 !important;">td</span><span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">&gt;</span><span style="margin: 0px; padding: 0px; color: rgb(0, 128, 128); font-size: 12px !important; line-height: 1.5 !important;">14</span>                     <span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">&lt;</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); font-size: 12px !important; line-height: 1.5 !important;">td</span><span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">&gt;</span><span style="margin: 0px; padding: 0px; color: rgb(0, 128, 128); font-size: 12px !important; line-height: 1.5 !important;">15</span> <span style="margin: 0px; padding: 0px; font-size: 12px !important; line-height: 1.5 !important;">                        删除
</span><span style="margin: 0px; padding: 0px; color: rgb(0, 128, 128); font-size: 12px !important; line-height: 1.5 !important;">16</span>                     <span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">&lt;/</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); font-size: 12px !important; line-height: 1.5 !important;">td</span><span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">&gt;</span><span style="margin: 0px; padding: 0px; color: rgb(0, 128, 128); font-size: 12px !important; line-height: 1.5 !important;">17</span>                 <span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">&lt;/</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); font-size: 12px !important; line-height: 1.5 !important;">tr</span><span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">&gt;</span><span style="margin: 0px; padding: 0px; color: rgb(0, 128, 128); font-size: 12px !important; line-height: 1.5 !important;">18</span>                 <span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">&lt;</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); font-size: 12px !important; line-height: 1.5 !important;">asp:Repeater </span><span style="margin: 0px; padding: 0px; color: rgb(255, 0, 0); font-size: 12px !important; line-height: 1.5 !important;">ID</span><span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">="repeaterProducts"</span><span style="margin: 0px; padding: 0px; color: rgb(255, 0, 0); font-size: 12px !important; line-height: 1.5 !important;"> runat</span><span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">="server"</span><span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">&gt;</span><span style="margin: 0px; padding: 0px; color: rgb(0, 128, 128); font-size: 12px !important; line-height: 1.5 !important;">19</span>                     <span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">&lt;</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); font-size: 12px !important; line-height: 1.5 !important;">ItemTemplate</span><span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">&gt;</span><span style="margin: 0px; padding: 0px; color: rgb(0, 128, 128); font-size: 12px !important; line-height: 1.5 !important;">20</span>                         <span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">&lt;</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); font-size: 12px !important; line-height: 1.5 !important;">tr</span><span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">&gt;</span><span style="margin: 0px; padding: 0px; color: rgb(0, 128, 128); font-size: 12px !important; line-height: 1.5 !important;">21</span>                             <span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">&lt;</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); font-size: 12px !important; line-height: 1.5 !important;">td</span><span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">&gt;</span><span style="margin: 0px; padding: 0px; color: rgb(0, 128, 128); font-size: 12px !important; line-height: 1.5 !important;">22</span>                                 <span style="margin: 0px; padding: 0px; background-color: rgb(255, 255, 0); font-size: 12px !important; line-height: 1.5 !important;">&lt;%</span><span style="margin: 0px; padding: 0px; font-size: 12px !important; line-height: 1.5 !important;">#</span><span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">Eval</span><span style="margin: 0px; padding: 0px; font-size: 12px !important; line-height: 1.5 !important;">(</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); font-size: 12px !important; line-height: 1.5 !important;">"</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); font-size: 12px !important; line-height: 1.5 !important;">Id</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); font-size: 12px !important; line-height: 1.5 !important;">"</span><span style="margin: 0px; padding: 0px; font-size: 12px !important; line-height: 1.5 !important;">) </span><span style="margin: 0px; padding: 0px; background-color: rgb(255, 255, 0); font-size: 12px !important; line-height: 1.5 !important;">%&gt;</span><span style="margin: 0px; padding: 0px; color: rgb(0, 128, 128); font-size: 12px !important; line-height: 1.5 !important;">23</span>                             <span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">&lt;/</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); font-size: 12px !important; line-height: 1.5 !important;">td</span><span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">&gt;</span><span style="margin: 0px; padding: 0px; color: rgb(0, 128, 128); font-size: 12px !important; line-height: 1.5 !important;">24</span>                             <span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">&lt;</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); font-size: 12px !important; line-height: 1.5 !important;">td</span><span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">&gt;</span><span style="margin: 0px; padding: 0px; color: rgb(0, 128, 128); font-size: 12px !important; line-height: 1.5 !important;">25</span>                                 <span style="margin: 0px; padding: 0px; background-color: rgb(255, 255, 0); font-size: 12px !important; line-height: 1.5 !important;">&lt;%</span><span style="margin: 0px; padding: 0px; font-size: 12px !important; line-height: 1.5 !important;">#</span><span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">Eval</span><span style="margin: 0px; padding: 0px; font-size: 12px !important; line-height: 1.5 !important;">(</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); font-size: 12px !important; line-height: 1.5 !important;">"</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); font-size: 12px !important; line-height: 1.5 !important;">Name</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); font-size: 12px !important; line-height: 1.5 !important;">"</span><span style="margin: 0px; padding: 0px; font-size: 12px !important; line-height: 1.5 !important;">) </span><span style="margin: 0px; padding: 0px; background-color: rgb(255, 255, 0); font-size: 12px !important; line-height: 1.5 !important;">%&gt;</span><span style="margin: 0px; padding: 0px; color: rgb(0, 128, 128); font-size: 12px !important; line-height: 1.5 !important;">26</span>                             <span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">&lt;/</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); font-size: 12px !important; line-height: 1.5 !important;">td</span><span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">&gt;</span><span style="margin: 0px; padding: 0px; color: rgb(0, 128, 128); font-size: 12px !important; line-height: 1.5 !important;">27</span>                             <span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">&lt;</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); font-size: 12px !important; line-height: 1.5 !important;">td</span><span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">&gt;</span><span style="margin: 0px; padding: 0px; color: rgb(0, 128, 128); font-size: 12px !important; line-height: 1.5 !important;">28</span>                                 <span style="margin: 0px; padding: 0px; background-color: rgb(255, 255, 0); font-size: 12px !important; line-height: 1.5 !important;">&lt;%</span><span style="margin: 0px; padding: 0px; font-size: 12px !important; line-height: 1.5 !important;">#</span><span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">Eval</span><span style="margin: 0px; padding: 0px; font-size: 12px !important; line-height: 1.5 !important;">(</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); font-size: 12px !important; line-height: 1.5 !important;">"</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); font-size: 12px !important; line-height: 1.5 !important;">Msg</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); font-size: 12px !important; line-height: 1.5 !important;">"</span><span style="margin: 0px; padding: 0px; font-size: 12px !important; line-height: 1.5 !important;">) </span><span style="margin: 0px; padding: 0px; background-color: rgb(255, 255, 0); font-size: 12px !important; line-height: 1.5 !important;">%&gt;</span><span style="margin: 0px; padding: 0px; color: rgb(0, 128, 128); font-size: 12px !important; line-height: 1.5 !important;">29</span>                             <span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">&lt;/</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); font-size: 12px !important; line-height: 1.5 !important;">td</span><span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">&gt;</span><span style="margin: 0px; padding: 0px; color: rgb(0, 128, 128); font-size: 12px !important; line-height: 1.5 !important;">30</span>                             <span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">&lt;</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); font-size: 12px !important; line-height: 1.5 !important;">td</span><span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">&gt;</span><span style="margin: 0px; padding: 0px; color: rgb(0, 128, 128); font-size: 12px !important; line-height: 1.5 !important;">31</span>                                 <span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">&lt;</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); font-size: 12px !important; line-height: 1.5 !important;">a </span><span style="margin: 0px; padding: 0px; color: rgb(255, 0, 0); font-size: 12px !important; line-height: 1.5 !important;">href</span><span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">='Product.ashx?Action=Delete&amp;Id=&lt;%#Eval("Id") </span><span style="margin: 0px; padding: 0px; color: rgb(255, 0, 0); font-size: 12px !important; line-height: 1.5 !important;">%</span><span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">&gt;</span>'&gt;删除<span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">&lt;/</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); font-size: 12px !important; line-height: 1.5 !important;">a</span><span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">&gt;</span><span style="margin: 0px; padding: 0px; color: rgb(0, 128, 128); font-size: 12px !important; line-height: 1.5 !important;">32</span>                             <span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">&lt;/</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); font-size: 12px !important; line-height: 1.5 !important;">td</span><span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">&gt;</span><span style="margin: 0px; padding: 0px; color: rgb(0, 128, 128); font-size: 12px !important; line-height: 1.5 !important;">33</span>                         <span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">&lt;/</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); font-size: 12px !important; line-height: 1.5 !important;">tr</span><span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">&gt;</span><span style="margin: 0px; padding: 0px; color: rgb(0, 128, 128); font-size: 12px !important; line-height: 1.5 !important;">34</span>                     <span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">&lt;/</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); font-size: 12px !important; line-height: 1.5 !important;">ItemTemplate</span><span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">&gt;</span><span style="margin: 0px; padding: 0px; color: rgb(0, 128, 128); font-size: 12px !important; line-height: 1.5 !important;">35</span>                 <span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">&lt;/</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); font-size: 12px !important; line-height: 1.5 !important;">asp:Repeater</span><span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">&gt;</span><span style="margin: 0px; padding: 0px; color: rgb(0, 128, 128); font-size: 12px !important; line-height: 1.5 !important;">36</span>             <span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">&lt;/</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); font-size: 12px !important; line-height: 1.5 !important;">table</span><span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">&gt;</span><span style="margin: 0px; padding: 0px; color: rgb(0, 128, 128); font-size: 12px !important; line-height: 1.5 !important;">37</span>         <span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">&lt;/</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); font-size: 12px !important; line-height: 1.5 !important;">div</span><span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">&gt;</span><span style="margin: 0px; padding: 0px; color: rgb(0, 128, 128); font-size: 12px !important; line-height: 1.5 !important;">38</span>     <span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">&lt;/</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); font-size: 12px !important; line-height: 1.5 !important;">form</span><span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">&gt;</span></pre><div class="cnblogs_code_toolbar" style="margin: 5px 0px 0px; padding: 0px;"><span class="cnblogs_code_copy" style="margin: 0px; padding: 0px 5px 0px 0px; font-size: 12px !important; line-height: 1.5 !important;"><a href="" title="复制代码" style="margin: 0px; padding: 1px 3px; color: green; text-decoration: none; border: none !important;"><img src="周旭龙 webForm 基础笔记_files/36677de3-436f-49a4-bd1e-4b1d88de499f.gif" alt="复制代码" style="margin: 0px; padding: 0px; border-style: none !important;"></a></span></div></div></div><p style="margin: 10px auto; padding: 0px;">　　②后台代码模拟从数据库中取得数据集合并绑定到Repeater中：</p><div class="cnblogs_code" style="margin: 5px 0px; padding: 5px; background-color: rgb(245, 245, 245); border: 1px solid rgb(204, 204, 204); overflow: auto; font-family: 'Courier New' !important; font-size: 12px !important;"><img id="code_img_opened_cf9c8cbb-31d1-43dc-9d86-832e4f9c7bbe" class="code_img_opened" src="周旭龙 webForm 基础笔记_files/7a8e2ef3-0a6e-4377-baf6-62331a3798c0.gif" alt="" style="margin: 0px; padding: 0px 5px 0px 0px; vertical-align: middle;"><div id="cnblogs_code_open_cf9c8cbb-31d1-43dc-9d86-832e4f9c7bbe" class="cnblogs_code_hide" style="margin: 0px; padding: 0px;"><div class="cnblogs_code_toolbar" style="margin: 5px 0px 0px; padding: 0px;"><span class="cnblogs_code_copy" style="margin: 0px; padding: 0px 5px 0px 0px; font-size: 12px !important; line-height: 1.5 !important;"><a href="" title="复制代码" style="margin: 0px; padding: 1px 3px; color: green; text-decoration: none; border: none !important;"><img src="周旭龙 webForm 基础笔记_files/36677de3-436f-49a4-bd1e-4b1d88de499f.gif" alt="复制代码" style="margin: 0px; padding: 0px; border-style: none !important;"></a></span></div><pre style="margin-top: 0px; margin-bottom: 0px; padding: 0px; white-space: pre-wrap; word-wrap: break-word; font-family: 'Courier New' !important; font-size: 12px !important;"><span style="margin: 0px; padding: 0px; color: rgb(0, 128, 128); font-size: 12px !important; line-height: 1.5 !important;"> 1</span> <span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">protected</span> <span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">void</span> Page_Load(<span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">object</span><span style="margin: 0px; padding: 0px; font-size: 12px !important; line-height: 1.5 !important;"> sender, EventArgs e)
</span><span style="margin: 0px; padding: 0px; color: rgb(0, 128, 128); font-size: 12px !important; line-height: 1.5 !important;"> 2</span> <span style="margin: 0px; padding: 0px; font-size: 12px !important; line-height: 1.5 !important;">{
</span><span style="margin: 0px; padding: 0px; color: rgb(0, 128, 128); font-size: 12px !important; line-height: 1.5 !important;"> 3</span>     <span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">if</span> (!<span style="margin: 0px; padding: 0px; font-size: 12px !important; line-height: 1.5 !important;">IsPostBack)
</span><span style="margin: 0px; padding: 0px; color: rgb(0, 128, 128); font-size: 12px !important; line-height: 1.5 !important;"> 4</span> <span style="margin: 0px; padding: 0px; font-size: 12px !important; line-height: 1.5 !important;">    {
</span><span style="margin: 0px; padding: 0px; color: rgb(0, 128, 128); font-size: 12px !important; line-height: 1.5 !important;"> 5</span>         <span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">this</span>.repeaterProducts.DataSource = <span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">this</span><span style="margin: 0px; padding: 0px; font-size: 12px !important; line-height: 1.5 !important;">.GetProductList();
</span><span style="margin: 0px; padding: 0px; color: rgb(0, 128, 128); font-size: 12px !important; line-height: 1.5 !important;"> 6</span>         <span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">this</span><span style="margin: 0px; padding: 0px; font-size: 12px !important; line-height: 1.5 !important;">.repeaterProducts.DataBind();
</span><span style="margin: 0px; padding: 0px; color: rgb(0, 128, 128); font-size: 12px !important; line-height: 1.5 !important;"> 7</span> <span style="margin: 0px; padding: 0px; font-size: 12px !important; line-height: 1.5 !important;">    }
</span><span style="margin: 0px; padding: 0px; color: rgb(0, 128, 128); font-size: 12px !important; line-height: 1.5 !important;"> 8</span> <span style="margin: 0px; padding: 0px; font-size: 12px !important; line-height: 1.5 !important;">}
</span><span style="margin: 0px; padding: 0px; color: rgb(0, 128, 128); font-size: 12px !important; line-height: 1.5 !important;"> 9</span><span style="margin: 0px; padding: 0px; color: rgb(0, 128, 128); font-size: 12px !important; line-height: 1.5 !important;">10</span> <span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">private</span> IList&lt;Product&gt;<span style="margin: 0px; padding: 0px; font-size: 12px !important; line-height: 1.5 !important;"> GetProductList()
</span><span style="margin: 0px; padding: 0px; color: rgb(0, 128, 128); font-size: 12px !important; line-height: 1.5 !important;">11</span> <span style="margin: 0px; padding: 0px; font-size: 12px !important; line-height: 1.5 !important;">{
</span><span style="margin: 0px; padding: 0px; color: rgb(0, 128, 128); font-size: 12px !important; line-height: 1.5 !important;">12</span>     IList&lt;Product&gt; productList = <span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">new</span> List&lt;Product&gt;<span style="margin: 0px; padding: 0px; font-size: 12px !important; line-height: 1.5 !important;">();
</span><span style="margin: 0px; padding: 0px; color: rgb(0, 128, 128); font-size: 12px !important; line-height: 1.5 !important;">13</span>     productList.Add(<span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">new</span> Product() { Id = <span style="margin: 0px; padding: 0px; color: rgb(128, 0, 128); font-size: 12px !important; line-height: 1.5 !important;">1</span>, Name = <span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); font-size: 12px !important; line-height: 1.5 !important;">"</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); font-size: 12px !important; line-height: 1.5 !important;">康师傅方便面</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); font-size: 12px !important; line-height: 1.5 !important;">"</span>, Msg = <span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); font-size: 12px !important; line-height: 1.5 !important;">"</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); font-size: 12px !important; line-height: 1.5 !important;">就是这个味儿！</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); font-size: 12px !important; line-height: 1.5 !important;">"</span><span style="margin: 0px; padding: 0px; font-size: 12px !important; line-height: 1.5 !important;"> });
</span><span style="margin: 0px; padding: 0px; color: rgb(0, 128, 128); font-size: 12px !important; line-height: 1.5 !important;">14</span>     productList.Add(<span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">new</span> Product() { Id = <span style="margin: 0px; padding: 0px; color: rgb(128, 0, 128); font-size: 12px !important; line-height: 1.5 !important;">2</span>, Name = <span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); font-size: 12px !important; line-height: 1.5 !important;">"</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); font-size: 12px !important; line-height: 1.5 !important;">统一方便面</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); font-size: 12px !important; line-height: 1.5 !important;">"</span>, Msg = <span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); font-size: 12px !important; line-height: 1.5 !important;">"</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); font-size: 12px !important; line-height: 1.5 !important;">还是那个味儿！</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); font-size: 12px !important; line-height: 1.5 !important;">"</span><span style="margin: 0px; padding: 0px; font-size: 12px !important; line-height: 1.5 !important;"> });
</span><span style="margin: 0px; padding: 0px; color: rgb(0, 128, 128); font-size: 12px !important; line-height: 1.5 !important;">15</span>     productList.Add(<span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">new</span> Product() { Id = <span style="margin: 0px; padding: 0px; color: rgb(128, 0, 128); font-size: 12px !important; line-height: 1.5 !important;">3</span>, Name = <span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); font-size: 12px !important; line-height: 1.5 !important;">"</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); font-size: 12px !important; line-height: 1.5 !important;">白象方便面</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); font-size: 12px !important; line-height: 1.5 !important;">"</span>, Msg = <span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); font-size: 12px !important; line-height: 1.5 !important;">"</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); font-size: 12px !important; line-height: 1.5 !important;">大骨浓汤啊！</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); font-size: 12px !important; line-height: 1.5 !important;">"</span><span style="margin: 0px; padding: 0px; font-size: 12px !important; line-height: 1.5 !important;"> });
</span><span style="margin: 0px; padding: 0px; color: rgb(0, 128, 128); font-size: 12px !important; line-height: 1.5 !important;">16</span>     productList.Add(<span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">new</span> Product() { Id = <span style="margin: 0px; padding: 0px; color: rgb(128, 0, 128); font-size: 12px !important; line-height: 1.5 !important;">4</span>, Name = <span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); font-size: 12px !important; line-height: 1.5 !important;">"</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); font-size: 12px !important; line-height: 1.5 !important;">日本方便面</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); font-size: 12px !important; line-height: 1.5 !important;">"</span>, Msg = <span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); font-size: 12px !important; line-height: 1.5 !important;">"</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); font-size: 12px !important; line-height: 1.5 !important;">不只是爱情动作片！</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); font-size: 12px !important; line-height: 1.5 !important;">"</span><span style="margin: 0px; padding: 0px; font-size: 12px !important; line-height: 1.5 !important;"> });
</span><span style="margin: 0px; padding: 0px; color: rgb(0, 128, 128); font-size: 12px !important; line-height: 1.5 !important;">17</span>     productList.Add(<span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">new</span> Product() { Id = <span style="margin: 0px; padding: 0px; color: rgb(128, 0, 128); font-size: 12px !important; line-height: 1.5 !important;">5</span>, Name = <span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); font-size: 12px !important; line-height: 1.5 !important;">"</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); font-size: 12px !important; line-height: 1.5 !important;">台湾方便面</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); font-size: 12px !important; line-height: 1.5 !important;">"</span>, Msg = <span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); font-size: 12px !important; line-height: 1.5 !important;">"</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); font-size: 12px !important; line-height: 1.5 !important;">马英九夸我好吃！</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); font-size: 12px !important; line-height: 1.5 !important;">"</span><span style="margin: 0px; padding: 0px; font-size: 12px !important; line-height: 1.5 !important;"> });
</span><span style="margin: 0px; padding: 0px; color: rgb(0, 128, 128); font-size: 12px !important; line-height: 1.5 !important;">18</span><span style="margin: 0px; padding: 0px; color: rgb(0, 128, 128); font-size: 12px !important; line-height: 1.5 !important;">19</span>     <span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">return</span><span style="margin: 0px; padding: 0px; font-size: 12px !important; line-height: 1.5 !important;"> productList;
</span><span style="margin: 0px; padding: 0px; color: rgb(0, 128, 128); font-size: 12px !important; line-height: 1.5 !important;">20</span> }    </pre><div class="cnblogs_code_toolbar" style="margin: 5px 0px 0px; padding: 0px;"><span class="cnblogs_code_copy" style="margin: 0px; padding: 0px 5px 0px 0px; font-size: 12px !important; line-height: 1.5 !important;"><a href="" title="复制代码" style="margin: 0px; padding: 1px 3px; color: green; text-decoration: none; border: none !important;"><img src="周旭龙 webForm 基础笔记_files/36677de3-436f-49a4-bd1e-4b1d88de499f.gif" alt="复制代码" style="margin: 0px; padding: 0px; border-style: none !important;"></a></span></div></div></div><p style="margin: 10px auto; padding: 0px;">　　编译生成后，通过查看此页面的html代码，可以明显看到一长串的_VIEWSTATE隐藏域。将此_VIEWSTATE复制到ViewStateDecoder中进行反编码，可以发现它确实存储了Repeater中的数据集合。这里我们不禁要问：<strong style="margin: 0px; padding: 0px;">展示数据既然已经渲染成了html，为何还要存储在ViewState隐藏域中？</strong>如果我们的数据集合是一百行、一千行数据的话，那ViewState隐藏域岂不很大（100k?200k?）？但不幸的是，这是ViewState的设计机制，要想依靠它来保持状态，它就会将服务器控件的状态包括数据集合都存储到其中，在浏览器和服务器之间来回传递保持状态。</p><p style="margin: 10px auto; padding: 0px;"><img src="周旭龙 webForm 基础笔记_files/3acce01a-3030-44e1-940a-f33b2e0892a1.jpg" alt="" style="margin: 0px; padding: 0px; width: 660px;"></p><p style="margin: 10px auto; padding: 0px;"><img src="周旭龙 webForm 基础笔记_files/c3b093d7-ab59-46ff-80b4-0ff56292478a.jpg" alt="" style="margin: 0px auto; padding: 0px; display: block; width: 660px;"></p><p style="margin: 10px auto; padding: 0px;">　　这里就涉及到网站的性能问题的探讨了：由于ViewState存储在页本身，<strong style="margin: 0px; padding: 0px;">因此如果存储较大的值，用户请求显示页面的速度会减慢</strong>（这对于互联网系统来说，就是一个噩梦。<strong style="margin: 0px; padding: 0px;">你会选择一个1秒内响应的网站浏览还是5秒内响应的网站？</strong>）。又因为ViewState会随同Form表单一同回传给服务器，如果ViewState很大的话，Http报文也会很大，网站流量消耗也会增大。</p><p style="margin: 10px auto; padding: 0px;">　　那么，有没有一种方法可以让ViewState克制一下呢？别急，请看下面的介绍。</p><h2 style="margin: 15px auto 2px; padding: 0px; font-size: 21px;">1.4 但爱就是克制—禁用还是不禁用ViewState？</h2><p style="margin: 10px auto; padding: 0px;">　　刚刚说到，因为ViewState会一定程度上影响性能，所以<strong style="margin: 0px; padding: 0px;">我们可以在不需要的时候禁用 ViewState</strong>。默认情况下 ViewState 将被启用，并且是由每个控件（而非页面开发人员）来决定存储在 ViewState 中的内容。有时，这一信息对应用程序并没有什么用处（例如上面提到的Repeater的数据集合，已经渲染生成了html显示，还存储了一份副本在ViewState里边）。尽管也没什么害处，但却会明显增加发送到浏览器的页面的大小。因此<strong style="margin: 0px; padding: 0px;">如果不需要用ViewState，最好还是将它关闭，特别是当 ViewState 很大的时候</strong>。当然，ViewState帮我们实现了<strong style="margin: 0px; padding: 0px;">某些服务器</strong>控件状态保持，因此在非必需的情况下，还是可以适度使用的，特别是在开发企业内部信息系统的场景。</p><p style="margin: 10px auto; padding: 0px;">　　那么，怎样来禁用ViewState呢？禁用ViewState又有什么策略呢？下面我们一一来探讨。</p><p style="margin: 10px auto; padding: 0px;">　　①页面级禁用ViewState：在aspx的首部的Page指令集中添加<strong style="margin: 0px; padding: 0px;">EnableViewState="false"</strong>，该页面中所有控件的状态都不会存入ViewState的，页面一下就会清爽许多；</p><div class="cnblogs_code" style="margin: 5px 0px; padding: 5px; background-color: rgb(245, 245, 245); border: 1px solid rgb(204, 204, 204); overflow: auto; font-family: 'Courier New' !important; font-size: 12px !important;"><pre style="margin-top: 0px; margin-bottom: 0px; padding: 0px; white-space: pre-wrap; word-wrap: break-word; font-family: 'Courier New' !important; font-size: 12px !important;">&lt;%@ Page Language=<span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); font-size: 12px !important; line-height: 1.5 !important;">"</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); font-size: 12px !important; line-height: 1.5 !important;">C#</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); font-size: 12px !important; line-height: 1.5 !important;">"</span> AutoEventWireup=<span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); font-size: 12px !important; line-height: 1.5 !important;">"</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); font-size: 12px !important; line-height: 1.5 !important;">true</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); font-size: 12px !important; line-height: 1.5 !important;">"</span> CodeBehind=<span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); font-size: 12px !important; line-height: 1.5 !important;">"</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); font-size: 12px !important; line-height: 1.5 !important;">RepeaterViewState.aspx.cs</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); font-size: 12px !important; line-height: 1.5 !important;">"</span><span style="margin: 0px; padding: 0px; font-size: 12px !important; line-height: 1.5 !important;">
    Inherits</span>=<span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); font-size: 12px !important; line-height: 1.5 !important;">"</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); font-size: 12px !important; line-height: 1.5 !important;">WebFormDemo.RepeaterViewState</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); font-size: 12px !important; line-height: 1.5 !important;">"</span> EnableViewState=<span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); font-size: 12px !important; line-height: 1.5 !important;">"</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); font-size: 12px !important; line-height: 1.5 !important;">false</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); font-size: 12px !important; line-height: 1.5 !important;">"</span> %&gt;</pre></div><p style="margin: 10px auto; padding: 0px;">　　禁用后，再次查看生成的html代码，我们会发现：咦，<strong style="margin: 0px; padding: 0px;">_VIEWSTATE还在那儿，但是明显比先前的体积小了不少</strong>！</p><p style="margin: 10px auto; padding: 0px;"><img src="周旭龙 webForm 基础笔记_files/bfa13adc-2393-4f40-b44e-ca6cc475b276.jpg" alt="" style="margin: 0px auto; padding: 0px; display: block; width: 660px;"></p><p style="margin: 10px auto; padding: 0px;">　　再将这个瘦身后的_VIEWSTATE复制到ViewStateDecoder中进行反编码查看，我们会发现，只保存了一个最基本的信息，Repeater的那些数据集合没有存入进去了。</p><p style="margin: 10px auto; padding: 0px;"><img src="周旭龙 webForm 基础笔记_files/c5c3bd98-de7a-4f7b-9eb9-b581eaad0ca0.jpg" alt="" style="margin: 0px auto; padding: 0px; display: block;"></p><blockquote style="margin: 20px 0px; padding: 15px 20px 15px 60px; background-image: url(&quot;&quot;); background-color: rgb(255, 255, 163); border: 2px solid rgb(239, 239, 239); color: rgb(51, 51, 51); border-top-left-radius: 10px; border-top-right-radius: 10px; border-bottom-right-radius: 10px; border-bottom-left-radius: 10px; min-height: 35px; line-height: 1.6em; font-size: 15px; font-family: 'Microsoft Yahei'; box-shadow: rgb(170, 170, 170) 0px 0px 8px; clear: both; background-position: 9px 0px; background-repeat: no-repeat no-repeat;"><p style="margin: 10px auto; padding: 0px;"><strong style="margin: 0px; padding: 0px;">PS：为什么禁用ViewState之后，页面源代码中仍然有<strong style="margin: 0px; padding: 0px;">_VIEWSTATE的隐藏域</strong>？</strong></p><p style="margin: 10px auto; padding: 0px;">这是因为就算禁用了viewstate，aspx页面中还是会有一个服务器控件在那里使用，这就是<strong style="margin: 0px; padding: 0px;">&lt;form runat="server"&gt;</strong>。这时，如果你将form去掉runat="server"，将其变为普通html标签，那么页面就干净了，从此_VIEWSTATE这个隐藏域彻底消失在你的页面中。 &nbsp;</p></blockquote><p style="margin: 10px auto; padding: 0px;">　　②控件级禁用ViewState：在某些场景中，我们只希望禁用某个控件（例如Repater）的ViewState，其他控件仍然通过ViewState保持状态。这时，我们可以给指定的控件设置一个属性<strong style="margin: 0px; padding: 0px;">EnableViewState="false"</strong>即可；</p><div class="cnblogs_code" style="margin: 5px 0px; padding: 5px; background-color: rgb(245, 245, 245); border: 1px solid rgb(204, 204, 204); overflow: auto; font-family: 'Courier New' !important; font-size: 12px !important;"><pre style="margin-top: 0px; margin-bottom: 0px; padding: 0px; white-space: pre-wrap; word-wrap: break-word; font-family: 'Courier New' !important; font-size: 12px !important;">&lt;asp:Repeater ID=<span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); font-size: 12px !important; line-height: 1.5 !important;">"</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); font-size: 12px !important; line-height: 1.5 !important;">repeaterProducts</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); font-size: 12px !important; line-height: 1.5 !important;">"</span> runat=<span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); font-size: 12px !important; line-height: 1.5 !important;">"</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); font-size: 12px !important; line-height: 1.5 !important;">server</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); font-size: 12px !important; line-height: 1.5 !important;">"</span> EnableViewState=<span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); font-size: 12px !important; line-height: 1.5 !important;">"</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); font-size: 12px !important; line-height: 1.5 !important;">false</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); font-size: 12px !important; line-height: 1.5 !important;">"</span>&gt;
&lt;/asp:Repeater&gt;</pre></div><p style="margin: 10px auto; padding: 0px;">　　③全局级禁用ViewState：园子里的大神老赵（<a href="http://jeffreyzhao.cnblogs.com/" target="_blank" style="margin: 0px; padding: 1px 3px; color: green; text-decoration: none;">Jeffrey Zhao</a>）曾经说过，“我如果新建一个WebForm项目，做的第一件事情就是去Web.config中将enableViewState设置为false从而将ViewState全局关闭”。那么，我们如果希望将网站中所有页面的ViewState都禁用，总不可能去一个一个页面得修改Page指令吧？ASP.Net为我们提供了一个配置，我们只需要在Web.config的system.web中增加一句配置即可：</p><div class="cnblogs_code" style="margin: 5px 0px; padding: 5px; background-color: rgb(245, 245, 245); border: 1px solid rgb(204, 204, 204); overflow: auto; font-family: 'Courier New' !important; font-size: 12px !important;"><pre style="margin-top: 0px; margin-bottom: 0px; padding: 0px; white-space: pre-wrap; word-wrap: break-word; font-family: 'Courier New' !important; font-size: 12px !important;">&lt;pages enableViewState=<span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); font-size: 12px !important; line-height: 1.5 !important;">"</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); font-size: 12px !important; line-height: 1.5 !important;">false</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); font-size: 12px !important; line-height: 1.5 !important;">"</span> /&gt;</pre></div><blockquote style="margin: 20px 0px; padding: 15px 20px 15px 60px; background-image: url(&quot;&quot;); background-color: rgb(255, 255, 163); border: 2px solid rgb(239, 239, 239); color: rgb(51, 51, 51); border-top-left-radius: 10px; border-top-right-radius: 10px; border-bottom-right-radius: 10px; border-bottom-left-radius: 10px; min-height: 35px; line-height: 1.6em; font-size: 15px; font-family: 'Microsoft Yahei'; box-shadow: rgb(170, 170, 170) 0px 0px 8px; clear: both; background-position: 9px 0px; background-repeat: no-repeat no-repeat;"><p style="margin: 10px auto; padding: 0px;"><strong style="margin: 0px; padding: 0px;">PS：</strong>开发中也可以采用大神老赵的做法，先禁用，再选择性启用，毕竟没有非要ViewState才能干成的事儿！</p></blockquote><p style="margin: 10px auto; padding: 0px;">　　④真正的禁用ViewState：刚刚我们的三种方法实践后，在页面还是出现_VIEWSTATE的隐藏域，尽管它保留了最基本的信息。那么，我们可能会问？怎样才能彻底地真正地禁用ViewState，根本就别给我生成_VIEWSTATE的隐藏域。答案是有的，将&lt;form runat="server"/&gt;的runat="server"去掉，就不会出现了，但那样又会偏离WebForm的开发模式，大部分的服务器控件都无法正常使用，开发效率又会有所损失。</p><p style="margin: 10px auto; padding: 0px;">　　综上所述，在实际开发中应该权衡利弊，特殊情况特殊分析（到底这个场景该不该禁用ViewState），选择是否禁用ViewState，采用何种方式禁用ViewState。对于ViewState的探秘本篇就到此为止，由于我本人理解的也不是很深刻，所以希望各位园友如果有理解，可以回复出来大家探讨共同进步。</p><h1 style="padding: 5px 0px 5px 20px; font-size: 17px; background-color: rgb(43, 102, 149); border-top-left-radius: 6px; border-top-right-radius: 6px; border-bottom-right-radius: 6px; border-bottom-left-radius: 6px; box-shadow: rgb(95, 90, 75) 0px 0px 0px 1px, rgba(10, 10, 0, 0.498039) 1px 1px 6px 1px; color: white; font-family: 微软雅黑, 宋体, 黑体, Arial; height: 25px; line-height: 25px; text-shadow: rgb(34, 34, 34) 2px 2px 3px; width: 640.1902465820313px; margin: 15px 0px !important;">二、飞来的利器—UpdatePanel探秘</h1><h2 style="margin: 15px auto 2px; padding: 0px; font-size: 21px;">2.1 从一个简单四则运算计算器说起</h2><p style="margin: 10px auto; padding: 0px;">　　假如有以下一个场景，我们要做一个简单的四则计算器。aspx页面代码和后端逻辑代码如下：</p><p style="margin: 10px auto; padding: 0px;">　　（1）aspx页面代码</p><div class="cnblogs_code" style="margin: 5px 0px; padding: 5px; background-color: rgb(245, 245, 245); border: 1px solid rgb(204, 204, 204); overflow: auto; font-family: 'Courier New' !important; font-size: 12px !important;"><img id="code_img_opened_4ec2572f-dc02-4028-8b86-b3f52794c729" class="code_img_opened" src="周旭龙 webForm 基础笔记_files/7a8e2ef3-0a6e-4377-baf6-62331a3798c0.gif" alt="" style="margin: 0px; padding: 0px 5px 0px 0px; vertical-align: middle;"><div id="cnblogs_code_open_4ec2572f-dc02-4028-8b86-b3f52794c729" class="cnblogs_code_hide" style="margin: 0px; padding: 0px;"><div class="cnblogs_code_toolbar" style="margin: 5px 0px 0px; padding: 0px;"><span class="cnblogs_code_copy" style="margin: 0px; padding: 0px 5px 0px 0px; font-size: 12px !important; line-height: 1.5 !important;"><a href="" title="复制代码" style="margin: 0px; padding: 1px 3px; color: green; text-decoration: none; border: none !important;"><img src="周旭龙 webForm 基础笔记_files/36677de3-436f-49a4-bd1e-4b1d88de499f.gif" alt="复制代码" style="margin: 0px; padding: 0px; border-style: none !important;"></a></span></div><pre style="margin-top: 0px; margin-bottom: 0px; padding: 0px; white-space: pre-wrap; word-wrap: break-word; font-family: 'Courier New' !important; font-size: 12px !important;"><span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">&lt;</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); font-size: 12px !important; line-height: 1.5 !important;">html </span><span style="margin: 0px; padding: 0px; color: rgb(255, 0, 0); font-size: 12px !important; line-height: 1.5 !important;">xmlns</span><span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">="http://www.w3.org/1999/xhtml"</span><span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">&gt;</span><span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">&lt;</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); font-size: 12px !important; line-height: 1.5 !important;">head </span><span style="margin: 0px; padding: 0px; color: rgb(255, 0, 0); font-size: 12px !important; line-height: 1.5 !important;">runat</span><span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">="server"</span><span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">&gt;</span><span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">&lt;</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); font-size: 12px !important; line-height: 1.5 !important;">title</span><span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">&gt;</span>AJAX计算器<span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">&lt;/</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); font-size: 12px !important; line-height: 1.5 !important;">title</span><span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">&gt;</span><span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">&lt;/</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); font-size: 12px !important; line-height: 1.5 !important;">head</span><span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">&gt;</span><span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">&lt;</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); font-size: 12px !important; line-height: 1.5 !important;">body</span><span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">&gt;</span><span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">&lt;</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); font-size: 12px !important; line-height: 1.5 !important;">form </span><span style="margin: 0px; padding: 0px; color: rgb(255, 0, 0); font-size: 12px !important; line-height: 1.5 !important;">id</span><span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">="form1"</span><span style="margin: 0px; padding: 0px; color: rgb(255, 0, 0); font-size: 12px !important; line-height: 1.5 !important;"> runat</span><span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">="server"</span><span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">&gt;</span><span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">&lt;</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); font-size: 12px !important; line-height: 1.5 !important;">div </span><span style="margin: 0px; padding: 0px; color: rgb(255, 0, 0); font-size: 12px !important; line-height: 1.5 !important;">align</span><span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">="center"</span><span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">&gt;</span><span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">&lt;</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); font-size: 12px !important; line-height: 1.5 !important;">asp:TextBox </span><span style="margin: 0px; padding: 0px; color: rgb(255, 0, 0); font-size: 12px !important; line-height: 1.5 !important;">ID</span><span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">="txtNumber1"</span><span style="margin: 0px; padding: 0px; color: rgb(255, 0, 0); font-size: 12px !important; line-height: 1.5 !important;"> runat</span><span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">="server"</span><span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">&gt;&lt;/</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); font-size: 12px !important; line-height: 1.5 !important;">asp:TextBox</span><span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">&gt;</span><span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">&lt;</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); font-size: 12px !important; line-height: 1.5 !important;">asp:DropDownList </span><span style="margin: 0px; padding: 0px; color: rgb(255, 0, 0); font-size: 12px !important; line-height: 1.5 !important;">ID</span><span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">="ddlFunc"</span><span style="margin: 0px; padding: 0px; color: rgb(255, 0, 0); font-size: 12px !important; line-height: 1.5 !important;"> runat</span><span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">="server"</span><span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">&gt;</span><span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">&lt;</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); font-size: 12px !important; line-height: 1.5 !important;">asp:ListItem </span><span style="margin: 0px; padding: 0px; color: rgb(255, 0, 0); font-size: 12px !important; line-height: 1.5 !important;">Value</span><span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">="0"</span><span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">&gt;</span>+<span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">&lt;/</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); font-size: 12px !important; line-height: 1.5 !important;">asp:ListItem</span><span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">&gt;</span><span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">&lt;</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); font-size: 12px !important; line-height: 1.5 !important;">asp:ListItem </span><span style="margin: 0px; padding: 0px; color: rgb(255, 0, 0); font-size: 12px !important; line-height: 1.5 !important;">Value</span><span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">="1"</span><span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">&gt;</span>-<span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">&lt;/</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); font-size: 12px !important; line-height: 1.5 !important;">asp:ListItem</span><span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">&gt;</span><span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">&lt;</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); font-size: 12px !important; line-height: 1.5 !important;">asp:ListItem </span><span style="margin: 0px; padding: 0px; color: rgb(255, 0, 0); font-size: 12px !important; line-height: 1.5 !important;">Value</span><span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">="2"</span><span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">&gt;</span>*<span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">&lt;/</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); font-size: 12px !important; line-height: 1.5 !important;">asp:ListItem</span><span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">&gt;</span><span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">&lt;</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); font-size: 12px !important; line-height: 1.5 !important;">asp:ListItem </span><span style="margin: 0px; padding: 0px; color: rgb(255, 0, 0); font-size: 12px !important; line-height: 1.5 !important;">Value</span><span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">="3"</span><span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">&gt;</span>/<span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">&lt;/</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); font-size: 12px !important; line-height: 1.5 !important;">asp:ListItem</span><span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">&gt;</span><span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">&lt;/</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); font-size: 12px !important; line-height: 1.5 !important;">asp:DropDownList</span><span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">&gt;</span><span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">&lt;</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); font-size: 12px !important; line-height: 1.5 !important;">asp:TextBox </span><span style="margin: 0px; padding: 0px; color: rgb(255, 0, 0); font-size: 12px !important; line-height: 1.5 !important;">ID</span><span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">="txtNumber2"</span><span style="margin: 0px; padding: 0px; color: rgb(255, 0, 0); font-size: 12px !important; line-height: 1.5 !important;"> runat</span><span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">="server"</span><span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">&gt;&lt;/</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); font-size: 12px !important; line-height: 1.5 !important;">asp:TextBox</span><span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">&gt;</span><span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">&lt;</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); font-size: 12px !important; line-height: 1.5 !important;">asp:Button </span><span style="margin: 0px; padding: 0px; color: rgb(255, 0, 0); font-size: 12px !important; line-height: 1.5 !important;">ID</span><span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">="btnGetResult"</span><span style="margin: 0px; padding: 0px; color: rgb(255, 0, 0); font-size: 12px !important; line-height: 1.5 !important;"> runat</span><span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">="server"</span><span style="margin: 0px; padding: 0px; color: rgb(255, 0, 0); font-size: 12px !important; line-height: 1.5 !important;"> Text</span><span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">="="</span><span style="margin: 0px; padding: 0px; color: rgb(255, 0, 0); font-size: 12px !important; line-height: 1.5 !important;"> Width</span><span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">="50"</span><span style="margin: 0px; padding: 0px; color: rgb(255, 0, 0); font-size: 12px !important; line-height: 1.5 !important;"> 
            onclick</span><span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">="btnGetResult_Click"</span> <span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">/&gt;</span><span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">&lt;</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); font-size: 12px !important; line-height: 1.5 !important;">asp:Label </span><span style="margin: 0px; padding: 0px; color: rgb(255, 0, 0); font-size: 12px !important; line-height: 1.5 !important;">ID</span><span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">="lblResult"</span><span style="margin: 0px; padding: 0px; color: rgb(255, 0, 0); font-size: 12px !important; line-height: 1.5 !important;"> runat</span><span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">="server"</span><span style="margin: 0px; padding: 0px; color: rgb(255, 0, 0); font-size: 12px !important; line-height: 1.5 !important;"> Text</span><span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">=""</span><span style="margin: 0px; padding: 0px; color: rgb(255, 0, 0); font-size: 12px !important; line-height: 1.5 !important;"> Font-Bold</span><span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">="true"</span><span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">&gt;&lt;/</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); font-size: 12px !important; line-height: 1.5 !important;">asp:Label</span><span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">&gt;</span><span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">&lt;/</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); font-size: 12px !important; line-height: 1.5 !important;">div</span><span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">&gt;</span><span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">&lt;/</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); font-size: 12px !important; line-height: 1.5 !important;">form</span><span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">&gt;</span><span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">&lt;/</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); font-size: 12px !important; line-height: 1.5 !important;">body</span><span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">&gt;</span><span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">&lt;/</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); font-size: 12px !important; line-height: 1.5 !important;">html</span><span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">&gt;</span></pre><div class="cnblogs_code_toolbar" style="margin: 5px 0px 0px; padding: 0px;"><span class="cnblogs_code_copy" style="margin: 0px; padding: 0px 5px 0px 0px; font-size: 12px !important; line-height: 1.5 !important;"><a href="" title="复制代码" style="margin: 0px; padding: 1px 3px; color: green; text-decoration: none; border: none !important;"><img src="周旭龙 webForm 基础笔记_files/36677de3-436f-49a4-bd1e-4b1d88de499f.gif" alt="复制代码" style="margin: 0px; padding: 0px; border-style: none !important;"></a></span></div></div></div><p style="margin: 10px auto; padding: 0px;">　　（2）后置逻辑代码</p><div class="cnblogs_code" style="margin: 5px 0px; padding: 5px; background-color: rgb(245, 245, 245); border: 1px solid rgb(204, 204, 204); overflow: auto; font-family: 'Courier New' !important; font-size: 12px !important;"><img id="code_img_opened_12a7ba06-b162-48f4-8358-c478186dbdfc" class="code_img_opened" src="周旭龙 webForm 基础笔记_files/7a8e2ef3-0a6e-4377-baf6-62331a3798c0.gif" alt="" style="margin: 0px; padding: 0px 5px 0px 0px; vertical-align: middle;"><div id="cnblogs_code_open_12a7ba06-b162-48f4-8358-c478186dbdfc" class="cnblogs_code_hide" style="margin: 0px; padding: 0px;"><div class="cnblogs_code_toolbar" style="margin: 5px 0px 0px; padding: 0px;"><span class="cnblogs_code_copy" style="margin: 0px; padding: 0px 5px 0px 0px; font-size: 12px !important; line-height: 1.5 !important;"><a href="" title="复制代码" style="margin: 0px; padding: 1px 3px; color: green; text-decoration: none; border: none !important;"><img src="周旭龙 webForm 基础笔记_files/36677de3-436f-49a4-bd1e-4b1d88de499f.gif" alt="复制代码" style="margin: 0px; padding: 0px; border-style: none !important;"></a></span></div><pre style="margin-top: 0px; margin-bottom: 0px; padding: 0px; white-space: pre-wrap; word-wrap: break-word; font-family: 'Courier New' !important; font-size: 12px !important;"><span style="margin: 0px; padding: 0px; font-size: 12px !important; line-height: 1.5 !important;">public partial class AjaxCalculator : System.Web.UI.Page
{
        protected void Page_Load(object sender, EventArgs e)
        {

        }

        protected void btnGetResult_Click(object sender, EventArgs e)
        {
            int number1 = Convert.ToInt32(this.txtNumber1.Text);
            int number2 = Convert.ToInt32(this.txtNumber2.Text);
            int result = 0;
            switch(this.ddlFunc.SelectedValue)
            {
                case "0":
                    result = number1 + number2;
                    break;
                case "1":
                    result = number1 - number2;
                    break;
                case "2":
                    result = number1 * number2;
                    break;
                case "3":
                    if(number2 == 0)
                    {
                        throw new DivideByZeroException("除数不能为0！");
                    }
                    result = number1 / number2;
                    break;
            }
            this.lblResult.Text = result.ToString();
        }
}</span></pre><div class="cnblogs_code_toolbar" style="margin: 5px 0px 0px; padding: 0px;"><span class="cnblogs_code_copy" style="margin: 0px; padding: 0px 5px 0px 0px; font-size: 12px !important; line-height: 1.5 !important;"><a href="" title="复制代码" style="margin: 0px; padding: 1px 3px; color: green; text-decoration: none; border: none !important;"><img src="周旭龙 webForm 基础笔记_files/36677de3-436f-49a4-bd1e-4b1d88de499f.gif" alt="复制代码" style="margin: 0px; padding: 0px; border-style: none !important;"></a></span></div></div></div><p style="margin: 10px auto; padding: 0px;">　　生成后运行该页面，可以达到以下的效果。我们输入两个数字后，选择是加法、减法、还是乘除法后，点击=按钮，即可刷新页面显示运算结果。</p><p style="margin: 10px auto; padding: 0px;"><img src="周旭龙 webForm 基础笔记_files/ef8c7cfd-ea0f-4653-b1aa-74ab688d2802.jpg" alt="" style="margin: 0px auto; padding: 0px; display: block;"></p><p style="margin: 10px auto; padding: 0px;">　　在WebForm中，每一次点击runat="server"的按钮都会将调用form.submit将请求提交到服务器，服务器会返回新的页面html进行页面重绘。这是一个整页的刷新操作，不符合AJAX的风格需求。因此，我们想要将其改为AJAX版本的，除了使用基本的XMLHttpRequest外，我们还可以使用基于JQuery的AJAX方案，这些都是轻量级的原生态的AJAX技术方案。但我们伟大的微软（我哭啊，真是为我们考虑啊，连AJAX方案都为我们解决了，而且还提供了AJAX控件供我们使用，我们拖控件的习惯可以用到AJAX方案上了！！！）还为我们提供了一套叫做<strong style="margin: 0px; padding: 0px;">ASP.Net AJAX</strong>的技术方案，通过这套方案，我们可以在ASP.Net很容易地实现AJAX效果，甚至都不需要我们懂JavaScript。因此，也就出现了前些年，很多WebForm开发者陆续使用ASP.Net AJAX Extension进行AJAX开发，纷纷表示：AJAX如此简单，我等岂能不会？但是，虽然它简单易行，由于其性能问题一直被人诟病，而我们这些菜鸟也未能了解其性能问题的原因，本着知其然也知其所以然的目标，现在我们来使用它并剖析它一下。</p><h2 style="margin: 15px auto 2px; padding: 0px; font-size: 21px;">2.2 天上掉下个林妹妹—使用UpdatePanel控件</h2><p style="margin: 10px auto; padding: 0px;">　　不得不说，UpdatePanel真的是天上掉下的林妹妹，一个神奇的控件！有了它，我们可以将页面中需要进行局部刷新的内容放到其ContentTemplate中，一个<strong style="margin: 0px; padding: 0px;">需要整页刷新的操作便可以成为局部刷新</strong>。现在，我们首先来使用其改造刚刚的简单四则计算器页面。</p><p style="margin: 10px auto; padding: 0px;">　　（1）加入UpdatePanel，并将计算器html内容拖入ContentTemplate中</p><div class="cnblogs_code" style="margin: 5px 0px; padding: 5px; background-color: rgb(245, 245, 245); border: 1px solid rgb(204, 204, 204); overflow: auto; font-family: 'Courier New' !important; font-size: 12px !important;"><div class="cnblogs_code_toolbar" style="margin: 5px 0px 0px; padding: 0px;"><span class="cnblogs_code_copy" style="margin: 0px; padding: 0px 5px 0px 0px; font-size: 12px !important; line-height: 1.5 !important;"><a href="" title="复制代码" style="margin: 0px; padding: 1px 3px; color: green; text-decoration: none; border: none !important;"><img src="周旭龙 webForm 基础笔记_files/36677de3-436f-49a4-bd1e-4b1d88de499f.gif" alt="复制代码" style="margin: 0px; padding: 0px; border-style: none !important;"></a></span></div><pre style="margin-top: 0px; margin-bottom: 0px; padding: 0px; white-space: pre-wrap; word-wrap: break-word; font-family: 'Courier New' !important; font-size: 12px !important;"> <span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">&lt;</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); font-size: 12px !important; line-height: 1.5 !important;">form </span><span style="margin: 0px; padding: 0px; color: rgb(255, 0, 0); font-size: 12px !important; line-height: 1.5 !important;">id</span><span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">="form1"</span><span style="margin: 0px; padding: 0px; color: rgb(255, 0, 0); font-size: 12px !important; line-height: 1.5 !important;"> runat</span><span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">="server"</span><span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">&gt;</span><span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">&lt;</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); font-size: 12px !important; line-height: 1.5 !important;">div </span><span style="margin: 0px; padding: 0px; color: rgb(255, 0, 0); font-size: 12px !important; line-height: 1.5 !important;">align</span><span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">="center"</span><span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">&gt;</span><span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">&lt;</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); font-size: 12px !important; line-height: 1.5 !important;">asp:ScriptManager </span><span style="margin: 0px; padding: 0px; color: rgb(255, 0, 0); font-size: 12px !important; line-height: 1.5 !important;">ID</span><span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">="scriptManager"</span><span style="margin: 0px; padding: 0px; color: rgb(255, 0, 0); font-size: 12px !important; line-height: 1.5 !important;"> runat</span><span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">="server"</span><span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">&gt;</span><span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">&lt;/</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); font-size: 12px !important; line-height: 1.5 !important;">asp:ScriptManager</span><span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">&gt;</span><span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">&lt;</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); font-size: 12px !important; line-height: 1.5 !important;">asp:UpdatePanel </span><span style="margin: 0px; padding: 0px; color: rgb(255, 0, 0); font-size: 12px !important; line-height: 1.5 !important;">ID</span><span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">="updatePanel"</span><span style="margin: 0px; padding: 0px; color: rgb(255, 0, 0); font-size: 12px !important; line-height: 1.5 !important;"> runat</span><span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">="server"</span><span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">&gt;</span><span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">&lt;</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); font-size: 12px !important; line-height: 1.5 !important;">ContentTemplate</span><span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">&gt;</span><span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">&lt;</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); font-size: 12px !important; line-height: 1.5 !important;">asp:TextBox </span><span style="margin: 0px; padding: 0px; color: rgb(255, 0, 0); font-size: 12px !important; line-height: 1.5 !important;">ID</span><span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">="txtNumber1"</span><span style="margin: 0px; padding: 0px; color: rgb(255, 0, 0); font-size: 12px !important; line-height: 1.5 !important;"> runat</span><span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">="server"</span><span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">&gt;&lt;/</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); font-size: 12px !important; line-height: 1.5 !important;">asp:TextBox</span><span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">&gt;</span><span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">&lt;</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); font-size: 12px !important; line-height: 1.5 !important;">asp:DropDownList </span><span style="margin: 0px; padding: 0px; color: rgb(255, 0, 0); font-size: 12px !important; line-height: 1.5 !important;">ID</span><span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">="ddlFunc"</span><span style="margin: 0px; padding: 0px; color: rgb(255, 0, 0); font-size: 12px !important; line-height: 1.5 !important;"> runat</span><span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">="server"</span><span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">&gt;</span><span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">&lt;</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); font-size: 12px !important; line-height: 1.5 !important;">asp:ListItem </span><span style="margin: 0px; padding: 0px; color: rgb(255, 0, 0); font-size: 12px !important; line-height: 1.5 !important;">Value</span><span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">="0"</span><span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">&gt;</span>+<span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">&lt;/</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); font-size: 12px !important; line-height: 1.5 !important;">asp:ListItem</span><span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">&gt;</span><span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">&lt;</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); font-size: 12px !important; line-height: 1.5 !important;">asp:ListItem </span><span style="margin: 0px; padding: 0px; color: rgb(255, 0, 0); font-size: 12px !important; line-height: 1.5 !important;">Value</span><span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">="1"</span><span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">&gt;</span>-<span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">&lt;/</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); font-size: 12px !important; line-height: 1.5 !important;">asp:ListItem</span><span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">&gt;</span><span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">&lt;</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); font-size: 12px !important; line-height: 1.5 !important;">asp:ListItem </span><span style="margin: 0px; padding: 0px; color: rgb(255, 0, 0); font-size: 12px !important; line-height: 1.5 !important;">Value</span><span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">="2"</span><span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">&gt;</span>*<span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">&lt;/</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); font-size: 12px !important; line-height: 1.5 !important;">asp:ListItem</span><span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">&gt;</span><span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">&lt;</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); font-size: 12px !important; line-height: 1.5 !important;">asp:ListItem </span><span style="margin: 0px; padding: 0px; color: rgb(255, 0, 0); font-size: 12px !important; line-height: 1.5 !important;">Value</span><span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">="3"</span><span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">&gt;</span>/<span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">&lt;/</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); font-size: 12px !important; line-height: 1.5 !important;">asp:ListItem</span><span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">&gt;</span><span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">&lt;/</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); font-size: 12px !important; line-height: 1.5 !important;">asp:DropDownList</span><span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">&gt;</span><span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">&lt;</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); font-size: 12px !important; line-height: 1.5 !important;">asp:TextBox </span><span style="margin: 0px; padding: 0px; color: rgb(255, 0, 0); font-size: 12px !important; line-height: 1.5 !important;">ID</span><span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">="txtNumber2"</span><span style="margin: 0px; padding: 0px; color: rgb(255, 0, 0); font-size: 12px !important; line-height: 1.5 !important;"> runat</span><span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">="server"</span><span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">&gt;&lt;/</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); font-size: 12px !important; line-height: 1.5 !important;">asp:TextBox</span><span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">&gt;</span><span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">&lt;</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); font-size: 12px !important; line-height: 1.5 !important;">asp:Button </span><span style="margin: 0px; padding: 0px; color: rgb(255, 0, 0); font-size: 12px !important; line-height: 1.5 !important;">ID</span><span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">="btnGetResult"</span><span style="margin: 0px; padding: 0px; color: rgb(255, 0, 0); font-size: 12px !important; line-height: 1.5 !important;"> runat</span><span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">="server"</span><span style="margin: 0px; padding: 0px; color: rgb(255, 0, 0); font-size: 12px !important; line-height: 1.5 !important;"> Text</span><span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">="="</span><span style="margin: 0px; padding: 0px; color: rgb(255, 0, 0); font-size: 12px !important; line-height: 1.5 !important;"> Width</span><span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">="50"</span><span style="margin: 0px; padding: 0px; color: rgb(255, 0, 0); font-size: 12px !important; line-height: 1.5 !important;"> OnClick</span><span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">="btnGetResult_Click"</span> <span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">/&gt;</span><span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">&lt;</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); font-size: 12px !important; line-height: 1.5 !important;">asp:Label </span><span style="margin: 0px; padding: 0px; color: rgb(255, 0, 0); font-size: 12px !important; line-height: 1.5 !important;">ID</span><span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">="lblResult"</span><span style="margin: 0px; padding: 0px; color: rgb(255, 0, 0); font-size: 12px !important; line-height: 1.5 !important;"> runat</span><span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">="server"</span><span style="margin: 0px; padding: 0px; color: rgb(255, 0, 0); font-size: 12px !important; line-height: 1.5 !important;"> Text</span><span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">=""</span><span style="margin: 0px; padding: 0px; color: rgb(255, 0, 0); font-size: 12px !important; line-height: 1.5 !important;"> Font-Bold</span><span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">="true"</span><span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">&gt;&lt;/</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); font-size: 12px !important; line-height: 1.5 !important;">asp:Label</span><span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">&gt;</span><span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">&lt;/</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); font-size: 12px !important; line-height: 1.5 !important;">ContentTemplate</span><span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">&gt;</span><span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">&lt;/</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); font-size: 12px !important; line-height: 1.5 !important;">asp:UpdatePanel</span><span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">&gt;</span><span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">&lt;/</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); font-size: 12px !important; line-height: 1.5 !important;">div</span><span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">&gt;</span><span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">&lt;/</span><span style="margin: 0px; padding: 0px; color: rgb(128, 0, 0); font-size: 12px !important; line-height: 1.5 !important;">form</span><span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">&gt;</span></pre><div class="cnblogs_code_toolbar" style="margin: 5px 0px 0px; padding: 0px;"><span class="cnblogs_code_copy" style="margin: 0px; padding: 0px 5px 0px 0px; font-size: 12px !important; line-height: 1.5 !important;"><a href="" title="复制代码" style="margin: 0px; padding: 1px 3px; color: green; text-decoration: none; border: none !important;"><img src="周旭龙 webForm 基础笔记_files/36677de3-436f-49a4-bd1e-4b1d88de499f.gif" alt="复制代码" style="margin: 0px; padding: 0px; border-style: none !important;"></a></span></div></div><p style="margin: 10px auto; padding: 0px;">　　（2）运行该页面，通过开发人员工具查看Http请求</p><p style="margin: 10px auto; padding: 0px;"><img src="周旭龙 webForm 基础笔记_files/7374a5f7-fad4-418f-b36a-7c72ccb9da8f.jpg" alt="" style="margin: 0px auto; padding: 0px; display: block; width: 660px;"></p><p style="margin: 10px auto; padding: 0px;">　　通过查看请求报文，我们了解到此次的请求响应不再是返回整页的html内容，而只是我们放在了UpdatePanel里面的html内容，页面也没有再刷新，于是不禁感叹一句：AJAX，So easy！妈妈再也不用担心我的页面了！</p><h2 style="margin: 15px auto 2px; padding: 0px; font-size: 21px;">2.3&nbsp;直到看见XmlHttpRequest才是唯一的答案—UpdatePanel原来如此</h2><p style="margin: 10px auto; padding: 0px;">　　正当我们沉浸在UpdatePanel为我们提供的神奇的AJAX世界里时，我们不禁对UpdatePanel为我们做了哪些工作产生了兴趣。</p><p style="margin: 10px auto; padding: 0px;">　　（1）首先，我们知道AJAX的核心对象是XmlHttpRequest，那么原生态的AJAX请求的JS方法是如何写的呢？</p><div class="cnblogs_code" style="margin: 5px 0px; padding: 5px; background-color: rgb(245, 245, 245); border: 1px solid rgb(204, 204, 204); overflow: auto; font-family: 'Courier New' !important; font-size: 12px !important;"><div class="cnblogs_code_toolbar" style="margin: 5px 0px 0px; padding: 0px;"><span class="cnblogs_code_copy" style="margin: 0px; padding: 0px 5px 0px 0px; font-size: 12px !important; line-height: 1.5 !important;"><a href="" title="复制代码" style="margin: 0px; padding: 1px 3px; color: green; text-decoration: none; border: none !important;"><img src="周旭龙 webForm 基础笔记_files/36677de3-436f-49a4-bd1e-4b1d88de499f.gif" alt="复制代码" style="margin: 0px; padding: 0px; border-style: none !important;"></a></span></div><pre style="margin-top: 0px; margin-bottom: 0px; padding: 0px; white-space: pre-wrap; word-wrap: break-word; font-family: 'Courier New' !important; font-size: 12px !important;"><span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">function</span><span style="margin: 0px; padding: 0px; font-size: 12px !important; line-height: 1.5 !important;"> ajax(url, onsuccess) {
    </span><span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">var</span> xmlhttp = window.XMLHttpRequest ? <span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">new</span> XMLHttpRequest() : <span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">new</span> ActiveXObject('Microsoft.XMLHTTP'); <span style="margin: 0px; padding: 0px; color: rgb(0, 128, 0); font-size: 12px !important; line-height: 1.5 !important;">//</span><span style="margin: 0px; padding: 0px; color: rgb(0, 128, 0); font-size: 12px !important; line-height: 1.5 !important;">创建XMLHTTP对象，考虑兼容性。XHR</span>
    xmlhttp.open("POST", url, <span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">true</span>); <span style="margin: 0px; padding: 0px; color: rgb(0, 128, 0); font-size: 12px !important; line-height: 1.5 !important;">//</span><span style="margin: 0px; padding: 0px; color: rgb(0, 128, 0); font-size: 12px !important; line-height: 1.5 !important;">“准备”向服务器的xx.ashx发出Post请求（GET可能会有缓存问题）。这里还没有发出请求</span><span style="margin: 0px; padding: 0px; color: rgb(0, 128, 0); font-size: 12px !important; line-height: 1.5 !important;">//</span><span style="margin: 0px; padding: 0px; color: rgb(0, 128, 0); font-size: 12px !important; line-height: 1.5 !important;">AJAX是异步的，并不是等到服务器端返回才继续执行</span>
    xmlhttp.onreadystatechange = <span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">function</span><span style="margin: 0px; padding: 0px; font-size: 12px !important; line-height: 1.5 !important;"> () {
        </span><span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">if</span> (xmlhttp.readyState == 4) <span style="margin: 0px; padding: 0px; color: rgb(0, 128, 0); font-size: 12px !important; line-height: 1.5 !important;">//</span><span style="margin: 0px; padding: 0px; color: rgb(0, 128, 0); font-size: 12px !important; line-height: 1.5 !important;">readyState == 4 表示服务器返回完成数据了。之前可能会经历2（请求已发送，正在处理中）、3（响应中已有部分数据可用了，但是服务器还没有完成响应的生成）</span><span style="margin: 0px; padding: 0px; font-size: 12px !important; line-height: 1.5 !important;">        {
            </span><span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">if</span> (xmlhttp.status == 200) <span style="margin: 0px; padding: 0px; color: rgb(0, 128, 0); font-size: 12px !important; line-height: 1.5 !important;">//</span><span style="margin: 0px; padding: 0px; color: rgb(0, 128, 0); font-size: 12px !important; line-height: 1.5 !important;">如果Http状态码为200则是成功</span><span style="margin: 0px; padding: 0px; font-size: 12px !important; line-height: 1.5 !important;">            {
                onsuccess(xmlhttp.responseText);
            }
            </span><span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">else</span><span style="margin: 0px; padding: 0px; font-size: 12px !important; line-height: 1.5 !important;"> {
                alert(</span>"AJAX服务器返回错误！"<span style="margin: 0px; padding: 0px; font-size: 12px !important; line-height: 1.5 !important;">);
            }
        }
    }
    </span><span style="margin: 0px; padding: 0px; color: rgb(0, 128, 0); font-size: 12px !important; line-height: 1.5 !important;">//</span><span style="margin: 0px; padding: 0px; color: rgb(0, 128, 0); font-size: 12px !important; line-height: 1.5 !important;">不要以为if (xmlhttp.readyState == 4) {在send之前执行！！！！</span>
    xmlhttp.send(); <span style="margin: 0px; padding: 0px; color: rgb(0, 128, 0); font-size: 12px !important; line-height: 1.5 !important;">//</span><span style="margin: 0px; padding: 0px; color: rgb(0, 128, 0); font-size: 12px !important; line-height: 1.5 !important;">这时才开始发送请求。并不等于服务器端返回。请求发出去了，我不等！去监听onreadystatechange吧！</span>
}</pre><div class="cnblogs_code_toolbar" style="margin: 5px 0px 0px; padding: 0px;"><span class="cnblogs_code_copy" style="margin: 0px; padding: 0px 5px 0px 0px; font-size: 12px !important; line-height: 1.5 !important;"><a href="" title="复制代码" style="margin: 0px; padding: 1px 3px; color: green; text-decoration: none; border: none !important;"><img src="周旭龙 webForm 基础笔记_files/36677de3-436f-49a4-bd1e-4b1d88de499f.gif" alt="复制代码" style="margin: 0px; padding: 0px; border-style: none !important;"></a></span></div></div><p style="margin: 10px auto; padding: 0px;">　　（2）其次，通过查看运行页面的html，我们可以发现加入UpdatePanel后，我们的html中多了这么几个js引用。</p><p style="margin: 10px auto; padding: 0px;"><img src="周旭龙 webForm 基础笔记_files/655d2861-60bb-4ecd-9a46-ab4b9e731916.jpg" alt="" style="margin: 0px auto; padding: 0px; display: block; width: 660px;"></p><p style="margin: 10px auto; padding: 0px;">　　（3）既然我们知道要发AJAX请求，必然会涉及到XmlHttpRequest。那么，我们就在这几个js中取看看是否有涉及到XmlHttpRequest。通过查看，我们找到了这样一个似曾相识的js方法：</p><div class="cnblogs_code" style="margin: 5px 0px; padding: 5px; background-color: rgb(245, 245, 245); border: 1px solid rgb(204, 204, 204); overflow: auto; font-family: 'Courier New' !important; font-size: 12px !important;"><div class="cnblogs_code_toolbar" style="margin: 5px 0px 0px; padding: 0px;"><span class="cnblogs_code_copy" style="margin: 0px; padding: 0px 5px 0px 0px; font-size: 12px !important; line-height: 1.5 !important;"><a href="" title="复制代码" style="margin: 0px; padding: 1px 3px; color: green; text-decoration: none; border: none !important;"><img src="周旭龙 webForm 基础笔记_files/36677de3-436f-49a4-bd1e-4b1d88de499f.gif" alt="复制代码" style="margin: 0px; padding: 0px; border-style: none !important;"></a></span></div><pre style="margin-top: 0px; margin-bottom: 0px; padding: 0px; white-space: pre-wrap; word-wrap: break-word; font-family: 'Courier New' !important; font-size: 12px !important;"><span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">function</span><span style="margin: 0px; padding: 0px; font-size: 12px !important; line-height: 1.5 !important;"> Sys$Net$XMLHttpExecutor$executeRequest() {
        </span><span style="margin: 0px; padding: 0px; color: rgb(0, 128, 0); font-size: 12px !important; line-height: 1.5 !important;">//</span><span style="margin: 0px; padding: 0px; color: rgb(0, 128, 0); font-size: 12px !important; line-height: 1.5 !important;">/ &lt;summary locid="M:J#Sys.Net.XMLHttpExecutor.executeRequest" /&gt;</span><span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">if</span> (arguments.length !== 0) <span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">throw</span><span style="margin: 0px; padding: 0px; font-size: 12px !important; line-height: 1.5 !important;"> Error.parameterCount();
        </span><span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">this</span>._webRequest = <span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">this</span><span style="margin: 0px; padding: 0px; font-size: 12px !important; line-height: 1.5 !important;">.get_webRequest();
        </span><span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">if</span> (<span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">this</span><span style="margin: 0px; padding: 0px; font-size: 12px !important; line-height: 1.5 !important;">._started) {
            </span><span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">throw</span> Error.invalidOperation(String.format(Sys.Res.cannotCallOnceStarted, 'executeRequest'<span style="margin: 0px; padding: 0px; font-size: 12px !important; line-height: 1.5 !important;">));
        }
        </span><span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">if</span> (<span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">this</span>._webRequest === <span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">null</span><span style="margin: 0px; padding: 0px; font-size: 12px !important; line-height: 1.5 !important;">) {
            </span><span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">throw</span><span style="margin: 0px; padding: 0px; font-size: 12px !important; line-height: 1.5 !important;"> Error.invalidOperation(Sys.Res.nullWebRequest);
        }
        </span><span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">var</span> body = <span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">this</span><span style="margin: 0px; padding: 0px; font-size: 12px !important; line-height: 1.5 !important;">._webRequest.get_body();
        </span><span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">var</span> headers = <span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">this</span><span style="margin: 0px; padding: 0px; font-size: 12px !important; line-height: 1.5 !important;">._webRequest.get_headers();
        </span><span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">this</span>._xmlHttpRequest = <span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">new</span><span style="margin: 0px; padding: 0px; font-size: 12px !important; line-height: 1.5 !important;"> XMLHttpRequest();
        </span><span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">this</span>._xmlHttpRequest.onreadystatechange = <span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">this</span><span style="margin: 0px; padding: 0px; font-size: 12px !important; line-height: 1.5 !important;">._onReadyStateChange;
        </span><span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">var</span> verb = <span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">this</span><span style="margin: 0px; padding: 0px; font-size: 12px !important; line-height: 1.5 !important;">._webRequest.get_httpVerb();
        </span><span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">this</span>._xmlHttpRequest.open(verb, <span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">this</span>._webRequest.getResolvedUrl(), <span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">true</span><span style="margin: 0px; padding: 0px; font-size: 12px !important; line-height: 1.5 !important;"> );
        </span><span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">this</span>._xmlHttpRequest.setRequestHeader("X-Requested-With", "XMLHttpRequest"<span style="margin: 0px; padding: 0px; font-size: 12px !important; line-height: 1.5 !important;">);
        </span><span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">if</span><span style="margin: 0px; padding: 0px; font-size: 12px !important; line-height: 1.5 !important;"> (headers) {
            </span><span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">for</span> (<span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">var</span> header <span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">in</span><span style="margin: 0px; padding: 0px; font-size: 12px !important; line-height: 1.5 !important;"> headers) {
                </span><span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">var</span> val =<span style="margin: 0px; padding: 0px; font-size: 12px !important; line-height: 1.5 !important;"> headers[header];
                </span><span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">if</span> (<span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">typeof</span>(val) !== "function"<span style="margin: 0px; padding: 0px; font-size: 12px !important; line-height: 1.5 !important;">)
                    </span><span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">this</span><span style="margin: 0px; padding: 0px; font-size: 12px !important; line-height: 1.5 !important;">._xmlHttpRequest.setRequestHeader(header, val);
            }
        }
        </span><span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">if</span> (verb.toLowerCase() === "post"<span style="margin: 0px; padding: 0px; font-size: 12px !important; line-height: 1.5 !important;">) {
            </span><span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">if</span> ((headers === <span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">null</span>) || !headers['Content-Type'<span style="margin: 0px; padding: 0px; font-size: 12px !important; line-height: 1.5 !important;">]) {
                </span><span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">this</span>._xmlHttpRequest.setRequestHeader('Content-Type', 'application/x-www-form-urlencoded; charset=utf-8'<span style="margin: 0px; padding: 0px; font-size: 12px !important; line-height: 1.5 !important;">);
            }
            </span><span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">if</span> (!<span style="margin: 0px; padding: 0px; font-size: 12px !important; line-height: 1.5 !important;">body) {
                body </span>= ""<span style="margin: 0px; padding: 0px; font-size: 12px !important; line-height: 1.5 !important;">;
            }
        }
        </span><span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">var</span> timeout = <span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">this</span><span style="margin: 0px; padding: 0px; font-size: 12px !important; line-height: 1.5 !important;">._webRequest.get_timeout();
        </span><span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">if</span> (timeout &gt; 0<span style="margin: 0px; padding: 0px; font-size: 12px !important; line-height: 1.5 !important;">) {
            </span><span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">this</span>._timer = window.setTimeout(Function.createDelegate(<span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">this</span>, <span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">this</span><span style="margin: 0px; padding: 0px; font-size: 12px !important; line-height: 1.5 !important;">._onTimeout), timeout);
        }
        </span><span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">this</span><span style="margin: 0px; padding: 0px; font-size: 12px !important; line-height: 1.5 !important;">._xmlHttpRequest.send(body);
        </span><span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">this</span>._started = <span style="margin: 0px; padding: 0px; color: rgb(0, 0, 255); font-size: 12px !important; line-height: 1.5 !important;">true</span><span style="margin: 0px; padding: 0px; font-size: 12px !important; line-height: 1.5 !important;">;
}</span></pre><div class="cnblogs_code_toolbar" style="margin: 5px 0px 0px; padding: 0px;"><span class="cnblogs_code_copy" style="margin: 0px; padding: 0px 5px 0px 0px; font-size: 12px !important; line-height: 1.5 !important;"><a href="" title="复制代码" style="margin: 0px; padding: 1px 3px; color: green; text-decoration: none; border: none !important;"><img src="周旭龙 webForm 基础笔记_files/36677de3-436f-49a4-bd1e-4b1d88de499f.gif" alt="复制代码" style="margin: 0px; padding: 0px; border-style: none !important;"></a></span></div></div><p style="margin: 10px auto; padding: 0px;">　　由以上的方法名我们可以猜到，此方法是一个执行AJAX请求的方法。在此方法中，创建了XmlHttpRequest对象，也使用了open方法指明以GET还是POST方法向服务器哪个处理程序发送请求，并且也为该请求指定了请求成功后需要执行的回调函数方法（onreadystatechange），最后调用send方法正式发送请求</p><p style="margin: 10px auto; padding: 0px;">　　由此，我们可以初步分析出一个结论：<strong style="margin: 0px; padding: 0px;">UpdatePanel本质还是帮我们封装了以XmlHttpRequest为核心的一系列方法帮我们将CodeBehind中的同步事件变为了异步操作，并通过DOM更新指定的HTML内容，使得我们可以方便地实现AJAX效果</strong>。</p><p style="margin: 10px auto; padding: 0px;">　　但是，我们也不由发出感叹：本来可以很简单地使用XmlHttpRequest来实现的东西，<strong style="margin: 0px; padding: 0px;">为什么使用UpdatePanel会引入这么多js，并且为我们返回的东西还是那么多</strong>（比如上面的例子，我只需要的数据是一个结果，却给我返回一部分无用的html，还有一系列的hiddenId之类的数据）。在对性能要求较高的应用场合，如果使用UpdatePanel来实现AJAX会增加服务器的负载，并且会消耗掉不必要的网络流量（比如<strong style="margin: 0px; padding: 0px;">每次请求都会来回都会发送ViewState里的数据，在性能和数据量上都会造成损失</strong>）。园子里的浪子曾经在他的博文《远离UpdatePanel带给我的噩梦》里边写到：“UpdatePanel在页面小的时候还是很好用的,而当页面控件数不断上升的时候，UpdatePanel就开始直线下降，我们现在页面有4，5百个控件，每做一次PostBack需要长达15秒钟之长，实在让人无法忍受。”</p><p style="margin: 10px auto; padding: 0px;">　　那么，有木有方式可以替换UpdatePanel呢？其实答案很简单，那就是使用基于XmlHttpRequest的js方法，再加上一定的js回调函数即可。这就要求我们掌握javascript，不能只做拖UpdatePanel控件的程序员。现在基于js的JQuery库也早已为我们封装了XmlHttpRequest，提供了ajax开发的一系列方法供我们调用，相当于UpdatePanel的“重量级”来说，可谓是轻了不少，是一个“轻量级”的AJAX开发方式。通过借助jQuery Ajax+ashx可以方便地在.Net中进行Ajax开发，并且具有不错的性能，这也是我实习所在的企业中经常用到的方式。</p><h1 style="padding: 5px 0px 5px 20px; font-size: 17px; background-color: rgb(43, 102, 149); border-top-left-radius: 6px; border-top-right-radius: 6px; border-bottom-right-radius: 6px; border-bottom-left-radius: 6px; box-shadow: rgb(95, 90, 75) 0px 0px 0px 1px, rgba(10, 10, 0, 0.498039) 1px 1px 6px 1px; color: white; font-family: 微软雅黑, 宋体, 黑体, Arial; height: 25px; line-height: 25px; text-shadow: rgb(34, 34, 34) 2px 2px 3px; width: 640.1902465820313px; margin: 15px 0px !important;">三、学习总结</h1><p style="margin: 10px auto; padding: 0px;">　　本篇主要学习了WebForm中的状态保持法宝—ViewState，以及曾经的ASP.Net AJAX方案的利器—UpdatePanel，虽然一直在说这个不好，那个别用。但是，微软之所以为我们提供了这些东西，肯定有它存在的理由，并不一定都是不好的东西。<strong style="margin: 0px; padding: 0px;">所谓利器在手，没有一点内功心法的人还是使用不好它，无法发挥出其100%的优势</strong>。因此，身为.Net学习者的我们，不能满足于微软为我们所提供的便利，要知其然也知其所以然，做一个上进的程序员，加油吧！</p><p style="margin: 10px auto; padding: 0px;">　　校园招聘的大潮就快来临，希望园子里跟我一样即将毕业的菜鸟们能够好好复习基础，在招聘中赢得一份好offer，实现自己的价值！</p><h1 style="padding: 5px 0px 5px 20px; font-size: 17px; background-color: rgb(43, 102, 149); border-top-left-radius: 6px; border-top-right-radius: 6px; border-bottom-right-radius: 6px; border-bottom-left-radius: 6px; box-shadow: rgb(95, 90, 75) 0px 0px 0px 1px, rgba(10, 10, 0, 0.498039) 1px 1px 6px 1px; color: white; font-family: 微软雅黑, 宋体, 黑体, Arial; height: 25px; line-height: 25px; text-shadow: rgb(34, 34, 34) 2px 2px 3px; width: 640.1902465820313px; margin: 15px 0px !important;">参考资料</h1><p style="margin: 10px auto; padding: 0px;">　　（1）杨中科，《特供2014版ASP.Net教程》，http://net.itcast.cn/subject/tegongnet/index.html</p><p style="margin: 10px auto; padding: 0px;">　　（2）匿名未知，《状态保存机制之ViewState概述及应用》，http://www.jb51.net/article/33686.htm</p><p style="margin: 10px auto; padding: 0px;">　　（3）popping_dancer，《ASP.Net原理篇之ViewState》，http://www.2cto.com/kf/201210/160413.html</p><p style="margin: 10px auto; padding: 0px;">　　（4）玉开，《ASP.Net 4.0新特性-输出更纯净的Html代码》，http://www.cnblogs.com/yukaizhao/archive/2010/05/22/asp-net-new-feature-pure-html.html</p><p style="margin: 10px auto; padding: 0px;">　　（5）Infinities Loop，《ASP.Net ViewState详解》，http://www.cnblogs.com/wwan/archive/2010/11/18/1880357.html</p><p style="margin: 10px auto; padding: 0px;">　　（6）LifelongLearning，《ASP.Net 4.0中ViewState使用简介》，http://www.csharpwin.com/dotnetspace/13220r6527.shtml</p><p style="margin: 10px auto; padding: 0px;">　　（7）自由飞，《禁用VIEWSTATE之后（一）》，http://www.cnblogs.com/freeflying/archive/2009/12/28/1634229.html</p><p style="margin: 10px auto; padding: 0px;">　　（8）MSDN，《了解使用ASP.NET AJAX进行局部页面刷新》，http://msdn.microsoft.com/zh-cn/dd361854.aspx</p><p style="margin: 10px auto; padding: 0px;">　　（9）xiaomin，《UpdatePanel工作原理》，http://www.cnblogs.com/xiaomin/archive/2011/11/01/2232215.html</p><p style="margin: 10px auto; padding: 0px;">　　（10）浪子，《远离UpdatePanel给我的噩梦》，http://www.cnblogs.com/walkingboy/archive/2007/01/09/615691.html</p><br><div style="color:gray"><small>来源：&nbsp;&lt;<a href="http://www.cnblogs.com/edisonchou/p/3901559.html">http://www.cnblogs.com/edisonchou/p/3901559.html</a><small>&gt;</small></small></div></div></div></body></html>