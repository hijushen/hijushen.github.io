<!DOCTYPE html>
<html><head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">

<!--defaultCSS-->
<title>Linq 10条基本用法</title>



<style type="text/css" id="wiz_custom_css">
body
{
    font-family: "Microsoft YaHei UI","Microsoft YaHei",SimSun,"Segoe UI",Tahoma,Helvetica,Sans-Serif,"Microsoft YaHei", Georgia,Helvetica,Arial,sans-serif,宋体, PMingLiU,serif;
    font-size: 10.5pt;
    line-height: 1.5;
}
html, body
{
    
    
}
h1 {
    font-size:1.5em;
    font-weight:bold;
}
h2 {
    font-size:1.4em;
    font-weight:bold;
}
h3 {
    font-size:1.3em;
    font-weight:bold;
}
h4 {
    font-size:1.2em;
    font-weight:bold;
}
h5 {
    font-size:1.1em;
    font-weight:bold;
}
h6 {
    font-size:1.0em;
    font-weight:bold;
}
img {
    border:0;
    max-width: 100%;
}
blockquote {
    margin-top:0px;
    margin-bottom:0px;
}

</style>
<style type="text/css" id="wiz_todo_style_id" wiz_link_version="01.00.07">.wiz-todo, .wiz-todo-img {width: 16px; height: 16px; cursor: default; padding: 0 10px 0 2px; vertical-align: -10%;-webkit-user-select: none;} .wiz-todo-label {margin-top: 8px; margin-bottom: 8px; line-height: 1;} .wiz-todo-label-checked { /*text-decoration: line-through;*/ color: #666;} .wiz-todo-label-unchecked {text-decoration: initial;} .wiz-todo-completed-info {padding-left: 44px; display: inline-block; } .wiz-todo-avatar { width:20px; height: 20px; vertical-align: -20%; margin-right:10px; border-radius: 2px;} .wiz-todo-account, .wiz-todo-dt { color: #666; }</style></head>

<body  style=""><h2 style="margin: 0px; padding: 0px; line-height: 1.8; font-size: 21px; font-family: verdana, Arial, Helvetica, sans-serif; background-color: rgb(255, 255, 255);"><strong style="margin: 0px; padding: 0px;"><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体; font-size: 15px;">1.简单的linq语法</span></strong></h2><div class="cnblogs_code" style="margin: 5px 0px; padding: 5px; background-color: rgb(247, 247, 255); border: 1px solid rgb(204, 204, 204); overflow: auto; font-family: 'Courier New' !important; font-size: 12px !important;"><div class="cnblogs_code_toolbar" style="margin: 5px 0px 0px; padding: 0px;"><span class="cnblogs_code_copy" style="margin: 0px; padding: 0px 5px 0px 0px; line-height: 1.8;"><a href="" title="复制代码" style="margin: 0px; padding: 0px; text-decoration: none; color: rgb(0, 0, 0); border: none !important; background-color: rgb(245, 245, 245) !important;"><img src="Linq 10条基本用法_files/copycode[1].gif" alt="复制代码" style="margin: 0px; padding: 0px; border-style: none !important;"></a></span></div><pre style="margin-top: 0px; margin-bottom: 0px; padding: 0px; white-space: pre-wrap; word-wrap: break-word; font-family: 'Courier New' !important;">            <span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(0, 128, 0);">//</span><span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(0, 128, 0);">1</span>
            <span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(0, 0, 255);">var</span> ss = <span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(0, 0, 255);">from</span> r <span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(0, 0, 255);">in</span><span style="margin: 0px; padding: 0px; line-height: 1.8;"> db.Am_recProScheme
                     </span><span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(0, 0, 255);">select</span><span style="margin: 0px; padding: 0px; line-height: 1.8;"> r;
            </span><span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(0, 128, 0);">//</span><span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(0, 128, 0);">2</span>
            <span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(0, 0, 255);">var</span> ss1 =<span style="margin: 0px; padding: 0px; line-height: 1.8;"> db.Am_recProScheme;
            </span><span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(0, 128, 0);">//</span><span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(0, 128, 0);">3</span>
            <span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(0, 0, 255);">string</span> sssql = <span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(128, 0, 0);">"</span><span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(128, 0, 0);">select * from Am_recProScheme</span><span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(128, 0, 0);">"</span>;</pre><div class="cnblogs_code_toolbar" style="margin: 5px 0px 0px; padding: 0px;"><span class="cnblogs_code_copy" style="margin: 0px; padding: 0px 5px 0px 0px; line-height: 1.8;"><a href="" title="复制代码" style="margin: 0px; padding: 0px; text-decoration: none; color: rgb(0, 0, 0); border: none !important; background-color: rgb(245, 245, 245) !important;"><img src="Linq 10条基本用法_files/copycode[1].gif" alt="复制代码" style="margin: 0px; padding: 0px; border-style: none !important;"></a></span></div></div><h2 style="margin: 0px; padding: 0px; line-height: 1.8; font-size: 21px; font-family: verdana, Arial, Helvetica, sans-serif; background-color: rgb(255, 255, 255);"><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体; font-size: 15px;"><strong style="margin: 0px; padding: 0px;">2.带where的查询</strong></span></h2><div class="cnblogs_code" style="margin: 5px 0px; padding: 5px; background-color: rgb(247, 247, 255); border: 1px solid rgb(204, 204, 204); overflow: auto; font-family: 'Courier New' !important; font-size: 12px !important;"><div class="cnblogs_code_toolbar" style="margin: 5px 0px 0px; padding: 0px;"><span class="cnblogs_code_copy" style="margin: 0px; padding: 0px 5px 0px 0px; line-height: 1.8;"><a href="" title="复制代码" style="margin: 0px; padding: 0px; text-decoration: none; color: rgb(0, 0, 0); border: none !important; background-color: rgb(245, 245, 245) !important;"><img src="Linq 10条基本用法_files/copycode[1].gif" alt="复制代码" style="margin: 0px; padding: 0px; border-style: none !important;"></a></span></div><pre style="margin-top: 0px; margin-bottom: 0px; padding: 0px; white-space: pre-wrap; word-wrap: break-word; font-family: 'Courier New' !important;">            <span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(0, 128, 0);">//</span><span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(0, 128, 0);">1</span>
            <span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(0, 0, 255);">var</span> ss = <span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(0, 0, 255);">from</span> r <span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(0, 0, 255);">in</span><span style="margin: 0px; padding: 0px; line-height: 1.8;"> db.Am_recProScheme
                     </span><span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(0, 0, 255);">where</span> r.rpId &gt; <span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(128, 0, 128);">10</span>
                     <span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(0, 0, 255);">select</span><span style="margin: 0px; padding: 0px; line-height: 1.8;"> r;
            </span><span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(0, 128, 0);">//</span><span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(0, 128, 0);">2</span>
            <span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(0, 0, 255);">var</span> ss1 = db.Am_recProScheme.Where(p =&gt; p.rpId &gt; <span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(128, 0, 128);">10</span><span style="margin: 0px; padding: 0px; line-height: 1.8;">);
            </span><span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(0, 128, 0);">//</span><span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(0, 128, 0);">3</span>
            <span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(0, 0, 255);">string</span> sssql = <span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(128, 0, 0);">"</span><span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(128, 0, 0);">select * from Am_recProScheme where rpid&gt;10</span><span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(128, 0, 0);">"</span>;</pre><div class="cnblogs_code_toolbar" style="margin: 5px 0px 0px; padding: 0px;"><span class="cnblogs_code_copy" style="margin: 0px; padding: 0px 5px 0px 0px; line-height: 1.8;"><a href="" title="复制代码" style="margin: 0px; padding: 0px; text-decoration: none; color: rgb(0, 0, 0); border: none !important; background-color: rgb(245, 245, 245) !important;"><img src="Linq 10条基本用法_files/copycode[1].gif" alt="复制代码" style="margin: 0px; padding: 0px; border-style: none !important;"></a></span></div></div><h2 style="margin: 0px; padding: 0px; line-height: 1.8; font-size: 21px; font-family: verdana, Arial, Helvetica, sans-serif; background-color: rgb(255, 255, 255);"><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体; font-size: 15px;"><strong style="margin: 0px; padding: 0px;">3.简单的函数计算（count，min，max，sum）</strong></span></h2><div class="cnblogs_code" style="margin: 5px 0px; padding: 5px; background-color: rgb(247, 247, 255); border: 1px solid rgb(204, 204, 204); overflow: auto; font-family: 'Courier New' !important; font-size: 12px !important;"><div class="cnblogs_code_toolbar" style="margin: 5px 0px 0px; padding: 0px;"><span class="cnblogs_code_copy" style="margin: 0px; padding: 0px 5px 0px 0px; line-height: 1.8;"><a href="" title="复制代码" style="margin: 0px; padding: 0px; text-decoration: none; color: rgb(0, 0, 0); border: none !important; background-color: rgb(245, 245, 245) !important;"><img src="Linq 10条基本用法_files/copycode[1].gif" alt="复制代码" style="margin: 0px; padding: 0px; border-style: none !important;"></a></span></div><pre style="margin-top: 0px; margin-bottom: 0px; padding: 0px; white-space: pre-wrap; word-wrap: break-word; font-family: 'Courier New' !important;">            <span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(0, 128, 0);">//</span><span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(0, 128, 0);">1</span>
            <span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(128, 128, 128);">///</span><span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(0, 128, 0);">/获取最大的rpId</span>
            <span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(0, 128, 0);">//</span><span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(0, 128, 0);">var ss = (from r in db.Am_recProScheme
            </span><span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(0, 128, 0);">//</span><span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(0, 128, 0);">          select r).Max(p =&gt; p.rpId);</span>
            <span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(128, 128, 128);">///</span><span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(0, 128, 0);">/获取最小的rpId</span>
            <span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(0, 128, 0);">//</span><span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(0, 128, 0);">var ss = (from r in db.Am_recProScheme
            </span><span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(0, 128, 0);">//</span><span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(0, 128, 0);">          select r).Min(p =&gt; p.rpId);
            </span><span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(0, 128, 0);">//</span><span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(0, 128, 0);">获取结果集的总数
            </span><span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(0, 128, 0);">//</span><span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(0, 128, 0);">var ss = (from r in db.Am_recProScheme                  
            </span><span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(0, 128, 0);">//</span><span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(0, 128, 0);">         select r).Count();
            </span><span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(0, 128, 0);">//</span><span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(0, 128, 0);">获取rpId的和</span>
            <span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(0, 0, 255);">var</span> ss = (<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(0, 0, 255);">from</span> r <span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(0, 0, 255);">in</span><span style="margin: 0px; padding: 0px; line-height: 1.8;"> db.Am_recProScheme
                      </span><span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(0, 0, 255);">select</span> r).Sum(p =&gt;<span style="margin: 0px; padding: 0px; line-height: 1.8;"> p.rpId);


            </span><span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(0, 128, 0);">//</span><span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(0, 128, 0);">2
            </span><span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(0, 128, 0);">//</span><span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(0, 128, 0);">var ss1 = db.Am_recProScheme.Max(p=&gt;p.rpId);
            </span><span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(0, 128, 0);">//</span><span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(0, 128, 0);">var ss1 = db.Am_recProScheme.Min(p =&gt; p.rpId);
            </span><span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(0, 128, 0);">//</span><span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(0, 128, 0);">var ss1 = db.Am_recProScheme.Count() ;</span>
            <span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(0, 0, 255);">var</span> ss1 = db.Am_recProScheme.Sum(p =&gt;<span style="margin: 0px; padding: 0px; line-height: 1.8;"> p.rpId);
            Response.Write(ss);

            </span><span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(0, 128, 0);">//</span><span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(0, 128, 0);">3</span>
            <span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(0, 0, 255);">string</span> sssql = <span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(128, 0, 0);">"</span><span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(128, 0, 0);">select max(rpId) from Am_recProScheme</span><span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(128, 0, 0);">"</span><span style="margin: 0px; padding: 0px; line-height: 1.8;">;
                   sssql </span>= <span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(128, 0, 0);">"</span><span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(128, 0, 0);">select min(rpId) from Am_recProScheme</span><span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(128, 0, 0);">"</span><span style="margin: 0px; padding: 0px; line-height: 1.8;">;
                   sssql </span>= <span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(128, 0, 0);">"</span><span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(128, 0, 0);">select count(1) from Am_recProScheme</span><span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(128, 0, 0);">"</span><span style="margin: 0px; padding: 0px; line-height: 1.8;">;
                   sssql </span>= <span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(128, 0, 0);">"</span><span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(128, 0, 0);">select sum(rpId) from Am_recProScheme</span><span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(128, 0, 0);">"</span>;</pre><div class="cnblogs_code_toolbar" style="margin: 5px 0px 0px; padding: 0px;"><span class="cnblogs_code_copy" style="margin: 0px; padding: 0px 5px 0px 0px; line-height: 1.8;"><a href="" title="复制代码" style="margin: 0px; padding: 0px; text-decoration: none; color: rgb(0, 0, 0); border: none !important; background-color: rgb(245, 245, 245) !important;"><img src="Linq 10条基本用法_files/copycode[1].gif" alt="复制代码" style="margin: 0px; padding: 0px; border-style: none !important;"></a></span></div></div><h2 style="margin: 0px; padding: 0px; line-height: 1.8; font-size: 21px; font-family: verdana, Arial, Helvetica, sans-serif; background-color: rgb(255, 255, 255);"><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体; font-size: 15px;"><strong style="margin: 0px; padding: 0px;">4.排序order by desc/asc</strong></span></h2><div class="cnblogs_code" style="margin: 5px 0px; padding: 5px; background-color: rgb(247, 247, 255); border: 1px solid rgb(204, 204, 204); overflow: auto; font-family: 'Courier New' !important; font-size: 12px !important;"><div class="cnblogs_code_toolbar" style="margin: 5px 0px 0px; padding: 0px;"><span class="cnblogs_code_copy" style="margin: 0px; padding: 0px 5px 0px 0px; line-height: 1.8;"><a href="" title="复制代码" style="margin: 0px; padding: 0px; text-decoration: none; color: rgb(0, 0, 0); border: none !important; background-color: rgb(245, 245, 245) !important;"><img src="Linq 10条基本用法_files/copycode[1].gif" alt="复制代码" style="margin: 0px; padding: 0px; border-style: none !important;"></a></span></div><pre style="margin-top: 0px; margin-bottom: 0px; padding: 0px; white-space: pre-wrap; word-wrap: break-word; font-family: 'Courier New' !important;">            <span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(0, 0, 255);">var</span> ss = <span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(0, 0, 255);">from</span> r <span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(0, 0, 255);">in</span><span style="margin: 0px; padding: 0px; line-height: 1.8;"> db.Am_recProScheme
                     </span><span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(0, 0, 255);">where</span> r.rpId &gt; <span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(128, 0, 128);">10</span>
                     <span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(0, 0, 255);">orderby</span> r.rpId descending  <span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(0, 128, 0);">//</span><span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(0, 128, 0);">倒序
                     </span><span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(0, 128, 0);">//</span><span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(0, 128, 0);">  orderby r.rpId ascending   </span><span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(0, 128, 0);">//</span><span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(0, 128, 0);">正序</span>
                     <span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(0, 0, 255);">select</span><span style="margin: 0px; padding: 0px; line-height: 1.8;"> r;

            </span><span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(0, 128, 0);">//</span><span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(0, 128, 0);">正序</span>
            <span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(0, 0, 255);">var</span> ss1 = db.Am_recProScheme.OrderBy(p =&gt; p.rpId).Where(p =&gt; p.rpId &gt; <span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(128, 0, 128);">10</span><span style="margin: 0px; padding: 0px; line-height: 1.8;">).ToList();
            </span><span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(0, 128, 0);">//</span><span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(0, 128, 0);">倒序</span>
            <span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(0, 0, 255);">var</span> ss2 = db.Am_recProScheme.OrderByDescending(p =&gt; p.rpId).Where(p =&gt; p.rpId &gt; <span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(128, 0, 128);">10</span><span style="margin: 0px; padding: 0px; line-height: 1.8;">).ToList();

            </span><span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(0, 0, 255);">string</span> sssql = <span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(128, 0, 0);">"</span><span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(128, 0, 0);">select * from Am_recProScheme where rpid&gt;10 order by rpId [desc|asc]</span><span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(128, 0, 0);">"</span>;</pre><div class="cnblogs_code_toolbar" style="margin: 5px 0px 0px; padding: 0px;"><span class="cnblogs_code_copy" style="margin: 0px; padding: 0px 5px 0px 0px; line-height: 1.8;"><a href="" title="复制代码" style="margin: 0px; padding: 0px; text-decoration: none; color: rgb(0, 0, 0); border: none !important; background-color: rgb(245, 245, 245) !important;"><img src="Linq 10条基本用法_files/copycode[1].gif" alt="复制代码" style="margin: 0px; padding: 0px; border-style: none !important;"></a></span></div></div><h2 style="margin: 0px; padding: 0px; line-height: 1.8; font-size: 21px; font-family: verdana, Arial, Helvetica, sans-serif; background-color: rgb(255, 255, 255);"><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体; font-size: 15px;"><strong style="margin: 0px; padding: 0px;">5.top(1)</strong></span></h2><div class="cnblogs_code" style="margin: 5px 0px; padding: 5px; background-color: rgb(247, 247, 255); border: 1px solid rgb(204, 204, 204); overflow: auto; font-family: 'Courier New' !important; font-size: 12px !important;"><div class="cnblogs_code_toolbar" style="margin: 5px 0px 0px; padding: 0px;"><span class="cnblogs_code_copy" style="margin: 0px; padding: 0px 5px 0px 0px; line-height: 1.8;"><a href="" title="复制代码" style="margin: 0px; padding: 0px; text-decoration: none; color: rgb(0, 0, 0); border: none !important; background-color: rgb(245, 245, 245) !important;"><img src="Linq 10条基本用法_files/copycode[1].gif" alt="复制代码" style="margin: 0px; padding: 0px; border-style: none !important;"></a></span></div><pre style="margin-top: 0px; margin-bottom: 0px; padding: 0px; white-space: pre-wrap; word-wrap: break-word; font-family: 'Courier New' !important;">            <span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(0, 128, 0);">//</span><span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(0, 128, 0);">如果取最后一个可以按倒叙排列再取值</span>
            <span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(0, 0, 255);">var</span> ss = (<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(0, 0, 255);">from</span> r <span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(0, 0, 255);">in</span><span style="margin: 0px; padding: 0px; line-height: 1.8;"> db.Am_recProScheme                     
                      </span><span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(0, 0, 255);">select</span><span style="margin: 0px; padding: 0px; line-height: 1.8;"> r).FirstOrDefault();

            </span><span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(0, 128, 0);">//</span><span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(0, 128, 0);">（）linq to ef 好像不支持 Last() </span>
            <span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(0, 0, 255);">var</span> ss1 =<span style="margin: 0px; padding: 0px; line-height: 1.8;"> db.Am_recProScheme.FirstOrDefault();
            </span><span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(0, 128, 0);">//</span><span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(0, 128, 0);">var ss1 = db.Am_recProScheme.First();          </span>

            <span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(0, 0, 255);">string</span> sssql = <span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(128, 0, 0);">"</span><span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(128, 0, 0);">select top(1) * from Am_recProScheme</span><span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(128, 0, 0);">"</span>;</pre><div class="cnblogs_code_toolbar" style="margin: 5px 0px 0px; padding: 0px;"><span class="cnblogs_code_copy" style="margin: 0px; padding: 0px 5px 0px 0px; line-height: 1.8;"><a href="" title="复制代码" style="margin: 0px; padding: 0px; text-decoration: none; color: rgb(0, 0, 0); border: none !important; background-color: rgb(245, 245, 245) !important;"><img src="Linq 10条基本用法_files/copycode[1].gif" alt="复制代码" style="margin: 0px; padding: 0px; border-style: none !important;"></a></span></div></div><h2 style="margin: 0px; padding: 0px; line-height: 1.8; font-size: 21px; font-family: verdana, Arial, Helvetica, sans-serif; background-color: rgb(255, 255, 255);"><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体; font-size: 15px;">6.跳过前面多少条数据取余下的数据</span></h2><div class="cnblogs_code" style="margin: 5px 0px; padding: 5px; background-color: rgb(247, 247, 255); border: 1px solid rgb(204, 204, 204); overflow: auto; font-family: 'Courier New' !important; font-size: 12px !important;"><div class="cnblogs_code_toolbar" style="margin: 5px 0px 0px; padding: 0px;"><span class="cnblogs_code_copy" style="margin: 0px; padding: 0px 5px 0px 0px; line-height: 1.8;"><a href="" title="复制代码" style="margin: 0px; padding: 0px; text-decoration: none; color: rgb(0, 0, 0); border: none !important; background-color: rgb(245, 245, 245) !important;"><img src="Linq 10条基本用法_files/copycode[1].gif" alt="复制代码" style="margin: 0px; padding: 0px; border-style: none !important;"></a></span></div><pre style="margin-top: 0px; margin-bottom: 0px; padding: 0px; white-space: pre-wrap; word-wrap: break-word; font-family: 'Courier New' !important;">            <span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(0, 128, 0);">//</span><span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(0, 128, 0);">1</span>
            <span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(0, 0, 255);">var</span> ss = (<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(0, 0, 255);">from</span> r <span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(0, 0, 255);">in</span><span style="margin: 0px; padding: 0px; line-height: 1.8;"> db.Am_recProScheme
                      </span><span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(0, 0, 255);">orderby</span><span style="margin: 0px; padding: 0px; line-height: 1.8;"> r.rpId descending
                      </span><span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(0, 0, 255);">select</span> r).Skip(<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(128, 0, 128);">10</span>); <span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(0, 128, 0);">//</span><span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(0, 128, 0);">跳过前10条数据，取10条之后的所有数据   
            </span><span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(0, 128, 0);">//</span><span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(0, 128, 0);">2  </span>
            <span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(0, 0, 255);">var</span> ss1 = db.Am_recProScheme.OrderByDescending(p =&gt; p.rpId).Skip(<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(128, 0, 128);">10</span><span style="margin: 0px; padding: 0px; line-height: 1.8;">).ToList();
            </span><span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(0, 128, 0);">//</span><span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(0, 128, 0);">3</span>
            <span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(0, 0, 255);">string</span> sssql = <span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(128, 0, 0);">"</span><span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(128, 0, 0);">select * from  (select ROW_NUMBER()over(order by rpId desc) as rowNum, * from [Am_recProScheme]) as t where rowNum&gt;10</span><span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(128, 0, 0);">"</span>;</pre><div class="cnblogs_code_toolbar" style="margin: 5px 0px 0px; padding: 0px;"><span class="cnblogs_code_copy" style="margin: 0px; padding: 0px 5px 0px 0px; line-height: 1.8;"><a href="" title="复制代码" style="margin: 0px; padding: 0px; text-decoration: none; color: rgb(0, 0, 0); border: none !important; background-color: rgb(245, 245, 245) !important;"><img src="Linq 10条基本用法_files/copycode[1].gif" alt="复制代码" style="margin: 0px; padding: 0px; border-style: none !important;"></a></span></div></div><h2 style="margin: 0px; padding: 0px; line-height: 1.8; font-size: 21px; font-family: verdana, Arial, Helvetica, sans-serif; background-color: rgb(255, 255, 255);"><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体; font-size: 15px;"><strong style="margin: 0px; padding: 0px;">7.分页数据查询</strong></span></h2><div class="cnblogs_code" style="margin: 5px 0px; padding: 5px; background-color: rgb(247, 247, 255); border: 1px solid rgb(204, 204, 204); overflow: auto; font-family: 'Courier New' !important; font-size: 12px !important;"><div class="cnblogs_code_toolbar" style="margin: 5px 0px 0px; padding: 0px;"><span class="cnblogs_code_copy" style="margin: 0px; padding: 0px 5px 0px 0px; line-height: 1.8;"><a href="" title="复制代码" style="margin: 0px; padding: 0px; text-decoration: none; color: rgb(0, 0, 0); border: none !important; background-color: rgb(245, 245, 245) !important;"><img src="Linq 10条基本用法_files/copycode[1].gif" alt="复制代码" style="margin: 0px; padding: 0px; border-style: none !important;"></a></span></div><pre style="margin-top: 0px; margin-bottom: 0px; padding: 0px; white-space: pre-wrap; word-wrap: break-word; font-family: 'Courier New' !important;">            <span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(0, 128, 0);">//</span><span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(0, 128, 0);">1</span>
            <span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(0, 0, 255);">var</span> ss = (<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(0, 0, 255);">from</span> r <span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(0, 0, 255);">in</span><span style="margin: 0px; padding: 0px; line-height: 1.8;"> db.Am_recProScheme
                      </span><span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(0, 0, 255);">where</span> r.rpId &gt; <span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(128, 0, 128);">10</span>
                      <span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(0, 0, 255);">orderby</span><span style="margin: 0px; padding: 0px; line-height: 1.8;"> r.rpId descending
                      </span><span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(0, 0, 255);">select</span> r).Skip(<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(128, 0, 128);">10</span>).Take(<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(128, 0, 128);">10</span>); <span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(0, 128, 0);">//</span><span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(0, 128, 0);">取第11条到第20条数据                   

            </span><span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(0, 128, 0);">//</span><span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(0, 128, 0);">2 Take(10): 数据从开始获取，获取指定数量（10）的连续数据</span>
            <span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(0, 0, 255);">var</span> ss1 = db.Am_recProScheme.OrderByDescending(p =&gt; p.rpId).Where(p =&gt; p.rpId &gt; <span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(128, 0, 128);">10</span>).Skip(<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(128, 0, 128);">10</span>).Take(<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(128, 0, 128);">10</span><span style="margin: 0px; padding: 0px; line-height: 1.8;">).ToList();
            </span><span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(0, 128, 0);">//</span><span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(0, 128, 0);">3</span>
            <span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(0, 0, 255);">string</span> sssql = <span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(128, 0, 0);">"</span><span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(128, 0, 0);">select * from  (select ROW_NUMBER()over(order by rpId desc) as rowNum, * from [Am_recProScheme]) as t where rowNum&gt;10 and rowNum&lt;=20</span><span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(128, 0, 0);">"</span>;</pre><div class="cnblogs_code_toolbar" style="margin: 5px 0px 0px; padding: 0px;"><span class="cnblogs_code_copy" style="margin: 0px; padding: 0px 5px 0px 0px; line-height: 1.8;"><a href="" title="复制代码" style="margin: 0px; padding: 0px; text-decoration: none; color: rgb(0, 0, 0); border: none !important; background-color: rgb(245, 245, 245) !important;"><img src="Linq 10条基本用法_files/copycode[1].gif" alt="复制代码" style="margin: 0px; padding: 0px; border-style: none !important;"></a></span></div></div><h2 style="margin: 0px; padding: 0px; line-height: 1.8; font-size: 21px; font-family: verdana, Arial, Helvetica, sans-serif; background-color: rgb(255, 255, 255);"><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体; font-size: 15px;"><strong style="margin: 0px; padding: 0px;">8.包含，类似like '%%'</strong></span></h2><div class="cnblogs_code" style="margin: 5px 0px; padding: 5px; background-color: rgb(247, 247, 255); border: 1px solid rgb(204, 204, 204); overflow: auto; font-family: 'Courier New' !important; font-size: 12px !important;"><div class="cnblogs_code_toolbar" style="margin: 5px 0px 0px; padding: 0px;"><span class="cnblogs_code_copy" style="margin: 0px; padding: 0px 5px 0px 0px; line-height: 1.8;"><a href="" title="复制代码" style="margin: 0px; padding: 0px; text-decoration: none; color: rgb(0, 0, 0); border: none !important; background-color: rgb(245, 245, 245) !important;"><img src="Linq 10条基本用法_files/copycode[1].gif" alt="复制代码" style="margin: 0px; padding: 0px; border-style: none !important;"></a></span></div><pre style="margin-top: 0px; margin-bottom: 0px; padding: 0px; white-space: pre-wrap; word-wrap: break-word; font-family: 'Courier New' !important;">            <span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(0, 128, 0);">//</span><span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(0, 128, 0);">1</span>
            <span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(0, 0, 255);">var</span> ss = <span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(0, 0, 255);">from</span> r <span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(0, 0, 255);">in</span><span style="margin: 0px; padding: 0px; line-height: 1.8;"> db.Am_recProScheme
                     </span><span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(0, 0, 255);">where</span> r.SortsText.Contains(<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(128, 0, 0);">"张</span><span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(128, 0, 0);">"</span><span style="margin: 0px; padding: 0px; line-height: 1.8;">)
                     </span><span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(0, 0, 255);">select</span><span style="margin: 0px; padding: 0px; line-height: 1.8;"> r;
            </span><span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(0, 128, 0);">//</span><span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(0, 128, 0);">2</span>
            <span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(0, 0, 255);">var</span> ss1 = db.Am_recProScheme.Where(p =&gt; p.SortsText.Contains(<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(128, 0, 0);">"</span><span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(128, 0, 0);">张</span><span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(128, 0, 0);">"</span><span style="margin: 0px; padding: 0px; line-height: 1.8;">)).ToList();
            </span><span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(0, 128, 0);">//</span><span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(0, 128, 0);">3</span>
            <span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(0, 0, 255);">string</span> sssql = <span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(128, 0, 0);">"</span><span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(128, 0, 0);">select * from Am_recProScheme where SortsText like '%张%'</span><span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(128, 0, 0);">"</span>;</pre><div class="cnblogs_code_toolbar" style="margin: 5px 0px 0px; padding: 0px;"><span class="cnblogs_code_copy" style="margin: 0px; padding: 0px 5px 0px 0px; line-height: 1.8;"><a href="" title="复制代码" style="margin: 0px; padding: 0px; text-decoration: none; color: rgb(0, 0, 0); border: none !important; background-color: rgb(245, 245, 245) !important;"><img src="Linq 10条基本用法_files/copycode[1].gif" alt="复制代码" style="margin: 0px; padding: 0px; border-style: none !important;"></a></span></div></div><h2 style="margin: 0px; padding: 0px; line-height: 1.8; font-size: 21px; font-family: verdana, Arial, Helvetica, sans-serif; background-color: rgb(255, 255, 255);"><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体; font-size: 15px;"><strong style="margin: 0px; padding: 0px;">9.分组group by</strong></span></h2><div class="cnblogs_code" style="margin: 5px 0px; padding: 5px; background-color: rgb(247, 247, 255); border: 1px solid rgb(204, 204, 204); overflow: auto; font-family: 'Courier New' !important; font-size: 12px !important;"><div class="cnblogs_code_toolbar" style="margin: 5px 0px 0px; padding: 0px;"><span class="cnblogs_code_copy" style="margin: 0px; padding: 0px 5px 0px 0px; line-height: 1.8;"><a href="" title="复制代码" style="margin: 0px; padding: 0px; text-decoration: none; color: rgb(0, 0, 0); border: none !important; background-color: rgb(245, 245, 245) !important;"><img src="Linq 10条基本用法_files/copycode[1].gif" alt="复制代码" style="margin: 0px; padding: 0px; border-style: none !important;"></a></span></div><pre style="margin-top: 0px; margin-bottom: 0px; padding: 0px; white-space: pre-wrap; word-wrap: break-word; font-family: 'Courier New' !important;"><span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(0, 128, 0);">            //</span><span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(0, 128, 0);">1</span>
            <span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(0, 0, 255);">var</span> ss = <span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(0, 0, 255);">from</span> r <span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(0, 0, 255);">in</span><span style="margin: 0px; padding: 0px; line-height: 1.8;"> db.Am_recProScheme
                     </span><span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(0, 0, 255);">orderby</span><span style="margin: 0px; padding: 0px; line-height: 1.8;"> r.rpId descending
                     group r by r.recType into n
                     </span><span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(0, 0, 255);">select</span> <span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(0, 0, 255);">new</span><span style="margin: 0px; padding: 0px; line-height: 1.8;">
                     {
                         n.Key,  </span><span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(0, 128, 0);">//</span><span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(0, 128, 0);">这个Key是recType</span>
                         rpId = n.Sum(r =&gt; r.rpId), <span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(0, 128, 0);">//</span><span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(0, 128, 0);">组内rpId之和</span>
                         MaxRpId = n.Max(r =&gt; r.rpId),<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(0, 128, 0);">//</span><span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(0, 128, 0);">组内最大rpId</span>
                         MinRpId = n.Min(r =&gt; r.rpId), <span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(0, 128, 0);">//</span><span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(0, 128, 0);">组内最小rpId</span>
<span style="margin: 0px; padding: 0px; line-height: 1.8;">                     };
            </span><span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(0, 0, 255);">foreach</span> (<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(0, 0, 255);">var</span> t <span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(0, 0, 255);">in</span><span style="margin: 0px; padding: 0px; line-height: 1.8;"> ss)
            {
                Response.Write(t.Key </span>+ <span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(128, 0, 0);">"</span><span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(128, 0, 0);">--</span><span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(128, 0, 0);">"</span> + t.rpId + <span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(128, 0, 0);">"</span><span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(128, 0, 0);">--</span><span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(128, 0, 0);">"</span> + t.MaxRpId + <span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(128, 0, 0);">"</span><span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(128, 0, 0);">--</span><span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(128, 0, 0);">"</span> +<span style="margin: 0px; padding: 0px; line-height: 1.8;"> t.MinRpId);
            }
            </span><span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(0, 128, 0);">//</span><span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(0, 128, 0);">2</span>
            <span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(0, 0, 255);">var</span> ss1 = <span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(0, 0, 255);">from</span> r <span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(0, 0, 255);">in</span><span style="margin: 0px; padding: 0px; line-height: 1.8;"> db.Am_recProScheme
                     </span><span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(0, 0, 255);">orderby</span><span style="margin: 0px; padding: 0px; line-height: 1.8;"> r.rpId descending
                     group r by r.recType into n
                     </span><span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(0, 0, 255);">select</span><span style="margin: 0px; padding: 0px; line-height: 1.8;"> n;
            </span><span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(0, 0, 255);">foreach</span> (<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(0, 0, 255);">var</span> t <span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(0, 0, 255);">in</span><span style="margin: 0px; padding: 0px; line-height: 1.8;"> ss1)
            {
                Response.Write(t.Key </span>+ <span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(128, 0, 0);">"</span><span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(128, 0, 0);">--</span><span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(128, 0, 0);">"</span> + t.Min(p =&gt;<span style="margin: 0px; padding: 0px; line-height: 1.8;"> p.rpId));
            }
            </span><span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(0, 128, 0);">//</span><span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(0, 128, 0);">3</span>
            <span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(0, 0, 255);">var</span> ss2 = db.Am_recProScheme.GroupBy(p =&gt;<span style="margin: 0px; padding: 0px; line-height: 1.8;"> p.recType);
            </span><span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(0, 0, 255);">foreach</span> (<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(0, 0, 255);">var</span> t <span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(0, 0, 255);">in</span><span style="margin: 0px; padding: 0px; line-height: 1.8;"> ss2)
            {
                Response.Write(t.Key </span>+ <span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(128, 0, 0);">"</span><span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(128, 0, 0);">--</span><span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(128, 0, 0);">"</span> + t.Min(p =&gt;<span style="margin: 0px; padding: 0px; line-height: 1.8;"> p.rpId));
            }
            </span><span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(0, 128, 0);">//</span><span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(0, 128, 0);">4</span>
            <span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(0, 0, 255);">string</span> sssql = <span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(128, 0, 0);">"</span><span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(128, 0, 0);">select recType,min(rpId),max(rpId),sum(rpId) from Am_recProScheme group by recType</span><span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(128, 0, 0);">"</span>;</pre><div class="cnblogs_code_toolbar" style="margin: 5px 0px 0px; padding: 0px;"><span class="cnblogs_code_copy" style="margin: 0px; padding: 0px 5px 0px 0px; line-height: 1.8;"><a href="" title="复制代码" style="margin: 0px; padding: 0px; text-decoration: none; color: rgb(0, 0, 0); border: none !important; background-color: rgb(245, 245, 245) !important;"><img src="Linq 10条基本用法_files/copycode[1].gif" alt="复制代码" style="margin: 0px; padding: 0px; border-style: none !important;"></a></span></div></div><h2 style="margin: 0px; padding: 0px; line-height: 1.8; font-size: 21px; font-family: verdana, Arial, Helvetica, sans-serif; background-color: rgb(255, 255, 255);"><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体; font-size: 15px;"><strong style="margin: 0px; padding: 0px;">10.连接查询&nbsp;</strong></span></h2><div class="cnblogs_code" style="margin: 5px 0px; padding: 5px; background-color: rgb(247, 247, 255); border: 1px solid rgb(204, 204, 204); overflow: auto; font-family: 'Courier New' !important; font-size: 12px !important;"><div class="cnblogs_code_toolbar" style="margin: 5px 0px 0px; padding: 0px;"><span class="cnblogs_code_copy" style="margin: 0px; padding: 0px 5px 0px 0px; line-height: 1.8;"><a href="" title="复制代码" style="margin: 0px; padding: 0px; text-decoration: none; color: rgb(0, 0, 0); border: none !important; background-color: rgb(245, 245, 245) !important;"><img src="Linq 10条基本用法_files/copycode[1].gif" alt="复制代码" style="margin: 0px; padding: 0px; border-style: none !important;"></a></span></div><pre style="margin-top: 0px; margin-bottom: 0px; padding: 0px; white-space: pre-wrap; word-wrap: break-word; font-family: 'Courier New' !important;">            <span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(0, 128, 0);">//</span><span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(0, 128, 0);">1</span>
            <span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(0, 0, 255);">var</span> ss = <span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(0, 0, 255);">from</span> r <span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(0, 0, 255);">in</span><span style="margin: 0px; padding: 0px; line-height: 1.8;"> db.Am_recProScheme
                     join w </span><span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(0, 0, 255);">in</span><span style="margin: 0px; padding: 0px; line-height: 1.8;"> db.Am_Test_Result on r.rpId equals w.rsId
                     </span><span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(0, 0, 255);">orderby</span><span style="margin: 0px; padding: 0px; line-height: 1.8;"> r.rpId descending
                     </span><span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(0, 0, 255);">select</span><span style="margin: 0px; padding: 0px; line-height: 1.8;"> r;
            </span><span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(0, 128, 0);">//</span><span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(0, 128, 0);">2</span>
            <span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(0, 0, 255);">var</span> ss1 = db.Am_recProScheme.Join(db.Am_Test_Result, p =&gt; p.rpId, r =&gt; r.rsId, (p, r) =&gt; p).OrderByDescending(p =&gt;<span style="margin: 0px; padding: 0px; line-height: 1.8;"> p.rpId).ToList();
            </span><span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(0, 128, 0);">//</span><span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(0, 128, 0);">3</span>
            <span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(0, 0, 255);">string</span> sssql = <span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(128, 0, 0);">"</span><span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(128, 0, 0);">select r.* from  [Am_recProScheme] as r inner join [dbo].[Am_Test_Result] as t on r.[rpId] = t.[rsId] order by r.[rpId] desc</span><span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(128, 0, 0);">"</span>;</pre><div class="cnblogs_code_toolbar" style="margin: 5px 0px 0px; padding: 0px;"><span class="cnblogs_code_copy" style="margin: 0px; padding: 0px 5px 0px 0px; line-height: 1.8;"><a href="" title="复制代码" style="margin: 0px; padding: 0px; text-decoration: none; color: rgb(0, 0, 0); border: none !important; background-color: rgb(245, 245, 245) !important;"><img src="Linq 10条基本用法_files/copycode[1].gif" alt="复制代码" style="margin: 0px; padding: 0px; border-style: none !important;"></a></span></div></div><h2 style="margin: 0px; padding: 0px; line-height: 1.8; font-size: 21px; font-family: verdana, Arial, Helvetica, sans-serif; background-color: rgb(255, 255, 255);"><span style="margin: 0px; padding: 0px; line-height: 1.8; font-family: 宋体; font-size: 15px;">11.sql中的In</span></h2><div class="cnblogs_code" style="margin: 5px 0px; padding: 5px; background-color: rgb(247, 247, 255); border: 1px solid rgb(204, 204, 204); overflow: auto; font-family: 'Courier New' !important; font-size: 12px !important;"><div class="cnblogs_code_toolbar" style="margin: 5px 0px 0px; padding: 0px;"><span class="cnblogs_code_copy" style="margin: 0px; padding: 0px 5px 0px 0px; line-height: 1.8;"><a href="" title="复制代码" style="margin: 0px; padding: 0px; text-decoration: none; color: rgb(0, 0, 0); border: none !important; background-color: rgb(245, 245, 245) !important;"><img src="Linq 10条基本用法_files/copycode[1].gif" alt="复制代码" style="margin: 0px; padding: 0px; border-style: none !important;"></a></span></div><pre style="margin-top: 0px; margin-bottom: 0px; padding: 0px; white-space: pre-wrap; word-wrap: break-word; font-family: 'Courier New' !important;">            <span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(0, 128, 0);">//</span><span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(0, 128, 0);">1</span>
            <span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(0, 0, 255);">var</span> ss = <span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(0, 0, 255);">from</span> p <span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(0, 0, 255);">in</span><span style="margin: 0px; padding: 0px; line-height: 1.8;"> db.Am_recProScheme
                              </span><span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(0, 0, 255);">where</span> (<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(0, 0, 255);">new</span> <span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(0, 0, 255);">int</span>?[] { <span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(128, 0, 128);">24</span>, <span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(128, 0, 128);">25</span>,<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(128, 0, 128);">26</span><span style="margin: 0px; padding: 0px; line-height: 1.8;"> }).Contains(p.rpId)
                              </span><span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(0, 0, 255);">select</span><span style="margin: 0px; padding: 0px; line-height: 1.8;"> p;
            </span><span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(0, 0, 255);">foreach</span> (<span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(0, 0, 255);">var</span> p <span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(0, 0, 255);">in</span><span style="margin: 0px; padding: 0px; line-height: 1.8;"> ss)
            {
                Response.Write(p.Sorts);
            }
            </span><span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(0, 128, 0);">//</span><span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(0, 128, 0);">2</span>
            <span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(0, 0, 255);">string</span> st = <span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(128, 0, 0);">"</span><span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(128, 0, 0);">select * from Am_recProScheme where rpId in(24,25,26)</span><span style="margin: 0px; padding: 0px; line-height: 1.8; color: rgb(128, 0, 0);">"</span>;</pre><div class="cnblogs_code_toolbar" style="margin: 5px 0px 0px; padding: 0px;"><span class="cnblogs_code_copy" style="margin: 0px; padding: 0px 5px 0px 0px; line-height: 1.8;"><a href="" title="复制代码" style="margin: 0px; padding: 0px; text-decoration: none; color: rgb(0, 0, 0); border: none !important; background-color: rgb(245, 245, 245) !important;"><img src="Linq 10条基本用法_files/copycode[1].gif" alt="复制代码" style="margin: 0px; padding: 0px; border-style: none !important;"></a></span></div><br><div style="color:gray"><small>来源：&nbsp;&lt;<a href="http://www.cnblogs.com/knowledgesea/archive/2014/08/08/3897665.html">http://www.cnblogs.com/knowledgesea/archive/2014/08/08/3897665.html</a><small>&gt;</small></small></div><small><small>&nbsp;</small></small></div>



</body></html>