<!DOCTYPE html>
<html><head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">

<!--defaultCSS-->
<title>C# DataTable的詳細用法</title>



<style type="text/css" id="wiz_custom_css">
body
{
    font-family: "Microsoft YaHei UI","Microsoft YaHei",SimSun,"Segoe UI",Tahoma,Helvetica,Sans-Serif,"Microsoft YaHei", Georgia,Helvetica,Arial,sans-serif,宋体, PMingLiU,serif;
    font-size: 10.5pt;
    line-height: 1.5;
}
html, body
{
    
    
}
h1 {
    font-size:1.5em;
    font-weight:bold;
}
h2 {
    font-size:1.4em;
    font-weight:bold;
}
h3 {
    font-size:1.3em;
    font-weight:bold;
}
h4 {
    font-size:1.2em;
    font-weight:bold;
}
h5 {
    font-size:1.1em;
    font-weight:bold;
}
h6 {
    font-size:1.0em;
    font-weight:bold;
}
img {
    border:0;
    max-width: 100%;
}
blockquote {
    margin-top:0px;
    margin-bottom:0px;
}
table {
    border-collapse:collapse;
    border:1px solid #bbbbbb;
}
td {
    border-collapse:collapse;
    border:1px solid #bbbbbb;
}
</style>
<style type="text/css" id="wiz_todo_style_id" wiz_link_version="01.00.07">.wiz-todo, .wiz-todo-img {width: 16px; height: 16px; cursor: default; padding: 0 10px 0 2px; vertical-align: -10%;-webkit-user-select: none;} .wiz-todo-label {margin-top: 8px; margin-bottom: 8px; line-height: 1;} .wiz-todo-label-checked { /*text-decoration: line-through;*/ color: #666;} .wiz-todo-label-unchecked {text-decoration: initial;} .wiz-todo-completed-info {padding-left: 44px; display: inline-block; } .wiz-todo-avatar { width:20px; height: 20px; vertical-align: -20%; margin-right:10px; border-radius: 2px;} .wiz-todo-account, .wiz-todo-dt { color: #666; }</style></head>

<body  style=""><section class="jz-contentwrap" id="jz-contentwrap" style="width: 768px; margin: 0px auto; padding: 12px; overflow: hidden; box-shadow: rgb(0, 0, 0) 0px 0px 0.5em; background-color: rgb(255, 255, 255);"><div class="jz-title" id="jz-title" style="font-size: 24px; font-weight: bold; margin: 12px 0px 20px; text-align: center;">C# DataTable的詳細用法 - hcw_peter的专栏 - 博客频道 - CSDN.NET</div><div class="jz-subtitle" id="jz-subtitle" style="text-align: right; font-size: 12px; margin-top: -20px;"></div><article class="jz-article loading" id="jz-article" style="padding-bottom: 30px; word-wrap: break-word; overflow: hidden;"><section class="jz-addcontent" style="margin-top: 20px;"><div class="article_content"><p class="MsoNormal"><span lang="ZH-CN">在项目中经常用到</span><span lang="EN-US">DataTable,</span><span lang="ZH-CN">如果</span><span lang="EN-US">DataTable</span><span lang="ZH-CN">使用得当，不仅能使程序简洁实用，而且能够提高性能，达到事半功倍的效果，现对</span><span lang="EN-US">DataTable</span><span lang="ZH-CN">的使用技巧进行一下总结。</span><span lang="EN-US">&nbsp;</span></p><p class="MsoNormal"><span lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><strong>一、<span lang="EN-US">DataTable</span>简介</strong><span lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;</span></p><p class="MsoNormal"><span lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(1)</span>构造函数<span lang="EN-US">&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DataTable()&nbsp;&nbsp;&nbsp;</span>不带参数初始化<span lang="EN-US">DataTable&nbsp;</span>类的新实例。<span lang="EN-US">&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DataTable(string tableName)&nbsp;&nbsp;</span>用指定的表名初始化<span lang="EN-US">DataTable&nbsp;</span>类的新实例。<span lang="EN-US">&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DataTable(string tableName, string tableNamespace)&nbsp;</span>用指定的表名和命名空间初始化<span lang="EN-US">DataTable&nbsp;</span>类的新实例。<span lang="EN-US">&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(2)&nbsp;</span>常用属性<span lang="EN-US">&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CaseSensitive&nbsp;&nbsp;&nbsp;&nbsp;</span>指示表中的字符串比较是否区分大小写。<span lang="EN-US">&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ChildRelations&nbsp;&nbsp;&nbsp;</span>获取此<span lang="EN-US">DataTable&nbsp;</span>的子关系的集合。<span lang="EN-US">&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Columns&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>获取属于该表的列的集合。<span lang="EN-US">&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Constraints&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>获取由该表维护的约束的集合。<span lang="EN-US">&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span lang="EN-US">DataSet&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span lang="ZH-CN">获取此表所属的</span><span lang="EN-US">DataSet</span><span lang="ZH-CN">。</span><span lang="EN-US">&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DefaultView&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span lang="ZH-CN">获取可能包括筛选视图或游标位置的表的自定义视图。</span><span lang="EN-US">&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span lang="EN-US">HasErrors&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>获取一个值，该值指示该表所属的<span lang="EN-US">DataSet&nbsp;</span>的任何表的任何行中是否有错误。<span lang="EN-US">&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MinimumCapacity&nbsp;&nbsp;</span>获取或设置该表最初的起始大小。该表中行的最初起始大小。<span lang="ZH-CN">默认值为</span><span lang="EN-US">&nbsp;50</span><span lang="ZH-CN">。</span><span lang="EN-US">&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Rows&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span lang="ZH-CN">获取属于该表的行的集合。</span><span lang="EN-US">&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span lang="EN-US">TableName&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>获取或设置<span lang="EN-US">DataTable&nbsp;</span>的名称。<span lang="EN-US">&nbsp;</span></p><p class="MsoNormal"><span lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(3)</span>常用方法<span lang="EN-US">&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AcceptChanges()&nbsp;&nbsp;&nbsp;</span>提交自上次调用<span lang="EN-US">AcceptChanges()&nbsp;</span>以来对该表进行的所有更改。<span lang="EN-US">&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BeginInit()&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>开始初始化在窗体上使用或由另一个组件使用的<span lang="EN-US">DataTable</span>。初始化发生在运行时。</p><p class="MsoNormal"><span lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Clear()&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>清除所有数据的<span lang="EN-US">DataTable</span>。<span lang="EN-US">&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Clone()&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>克隆<span lang="EN-US">DataTable&nbsp;</span>的结构，包括所有<span lang="EN-US">DataTable&nbsp;</span>架构和约束。<span lang="EN-US">&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EndInit()&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>结束在窗体上使用或由另一个组件使用的<span lang="EN-US">DataTable&nbsp;</span>的初始化。初始化发生在运行时。<span lang="EN-US">&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ImportRow(DataRow row)&nbsp;&nbsp;&nbsp;&nbsp;</span>将<span lang="EN-US">DataRow&nbsp;</span>复制到<span lang="EN-US">DataTable&nbsp;</span>中，保留任何属性设置以及初始值和当前值。<span lang="EN-US">&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Merge(DataTable table)&nbsp;&nbsp;</span>将指定的<span lang="EN-US">DataTable&nbsp;</span>与当前的<span lang="EN-US">DataTable&nbsp;</span>合并。<span lang="EN-US">&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NewRow()&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>创建与该表具有相同架构的新<span lang="EN-US">DataRow</span>。<span lang="EN-US"><br>&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><strong>二、<span lang="EN-US">DataTable</span>使用技巧</strong></p><p class="MsoNormal"><span lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>（<span lang="EN-US">1</span>）<span lang="EN-US">Create a DataTable<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; DataTable dt = new DataTable("Table_AX");&nbsp;</span></p><p class="MsoNormal"><span lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>（<span lang="EN-US">2</span>）<span lang="EN-US">Add columns for DataTable<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //Method 1<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; dt.Columns.Add("column0", System.Type.GetType("System.String"));<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //Method 2<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; DataColumn dc = new DataColumn("column1", System.Type.GetType("System.Boolean"));<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; dt.Columns.Add(dc);&nbsp;<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>（<span lang="EN-US">3</span>）<span lang="EN-US">Add rows for DataTable<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //Initialize the row<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; DataRow dr = dt.NewRow();<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; dr["column0"] = "AX";<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; dr["column1"] = true;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; dt.Rows.Add(dr);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //Doesn't initialize the row<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; DataRow dr1 = dt.NewRow();<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; dt.Rows.Add(dr1);&nbsp;&nbsp;</span></p><p class="MsoNormal"><span lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>（<span lang="EN-US">4</span>）<span lang="EN-US">Select row<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //Search the second row&nbsp;</span>如果没有赋值<span lang="EN-US">,</span>则用<span lang="EN-US">is null</span>来<span lang="EN-US">select<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; DataRow[] drs = dt.Select("column1 is null");<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; DataRow[] drss = dt.Select("column0 = 'AX'");&nbsp;</span></p><p class="MsoNormal"><span lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>（<span lang="EN-US">5</span>）<span lang="EN-US">Copy DataTable include data<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; DataTable dtNew = dt.Copy();&nbsp;<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>（<span lang="EN-US">6</span>）<span lang="EN-US">Copy DataTable only scheme<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; DataTable dtOnlyScheme = dt.Clone();&nbsp;<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>（<span lang="EN-US">7</span>）<span lang="EN-US">Operate one row<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //</span>对<span lang="EN-US">dt</span>的操作<span lang="EN-US"><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //Method 1<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; DataRow drOperate = dt.Rows[0];<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; drOperate["column0"] = "AXzhz";<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; drOperate["column1"] = false;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //Method 2<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; drOperate[0] = "AXzhz";<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; drOperate[1] = false;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //Method 3<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; dt.Rows[0]["column0"] = "AXzhz";<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; dt.Rows[0]["column1"] = false;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //Method 4<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; dt.Rows[0][0] = "AXzhz";<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; dt.Rows[0][1] = false;&nbsp;<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>（<span lang="EN-US">8</span>）<span lang="EN-US">Evaluate another DataTable's row to current Datatable<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; dtOnlyScheme.Rows.Add(dt.Rows[0].ItemArray);&nbsp;<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>（<span lang="EN-US">9</span>）<span lang="EN-US">Convert to string<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; System.IO.StringWriter sw = new System.IO.StringWriter();<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; System.Xml.XmlTextWriter xw = new System.Xml.XmlTextWriter(sw);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; dt.WriteXml(xw);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; string s = sw.ToString();<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>（<span lang="EN-US">10</span>）<span lang="EN-US">Filter DataTable<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; dt.DefaultView.RowFilter = "column1 &lt;&gt; true";<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; dt.DefaultView.RowFilter = "column1 = true";<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>（<span lang="EN-US">11</span>）<span lang="EN-US">Sort row<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; dt.DefaultView.Sort = "ID ,Name ASC";<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; dt=dt.DefaultView.ToTable();<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>（<span lang="EN-US">12</span>）<span lang="EN-US">Bind DataTable<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //</span>绑定的其实是<span lang="EN-US">DefaultView<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; gvTestDataTable.DataSource = dt;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; gvTestDataTable.DataBind();<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>（<span lang="EN-US">13</span>）<span lang="EN-US">judge the DataTable</span>’<span lang="EN-US">s Column name is a string<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //</span>判断一个字符串是否为<span lang="EN-US">DataTable</span>的列名<span lang="EN-US"><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; dtInfo.Columns.Contains("AX");<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>（<span lang="EN-US">14</span>）<span lang="EN-US">DataTable convert to XML and XML convert to DataTable<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; protected void Page_Load(object sender, EventArgs e)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; DataTable dt_AX = new DataTable();<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //dt_AX.Columns.Add("Sex", typeof(System.Boolean));<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //DataRow dr = dt_AX.NewRow();<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //dr["Sex"] = true;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //dt_AX.Rows.Add(dr);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; string xml=ConvertBetweenDataTableAndXML_AX(dt_AX);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; DataTable dt = ConvertBetweenDataTableAndXML_AX(xml);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; public string ConvertBetweenDataTableAndXML_AX(DataTable dtNeedCoveret)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; System.IO.TextWriter tw = new System.IO.StringWriter();<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //if TableName is empty, WriteXml() will throw Exception.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></p><p class="MsoNormal"><span lang="EN-US">dtNeedCoveret.TableName=dtNeedCoveret.TableName.Length==0?"Table_AX":dtNeedCoveret.TableName;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; dtNeedCoveret.WriteXml(tw);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; dtNeedCoveret.WriteXmlSchema(tw);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return tw.ToString();<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; public DataTable ConvertBetweenDataTableAndXML_AX(string xml)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; System.IO.TextReader trDataTable = new System.IO.StringReader(xml.Substring(0, xml.IndexOf("&lt;?xml")));<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; System.IO.TextReader trSchema = new System.IO.StringReader(xml.Substring(xml.IndexOf("&lt;?xml")));<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; DataTable dtReturn = new DataTable();<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; dtReturn.ReadXmlSchema(trSchema);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; dtReturn.ReadXml(trDataTable);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return dtReturn;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></p><p class="MsoNormal"><span lang="EN-US">&nbsp;</span></p></div></section></article></section><section class="jz-sider" id="jz-sider" style="position: fixed; right: 0px; top: 12px; bottom: 0px; width: 107.90625px;"><div class="jz-actionbtn jz-closebtn" id="jz-closebtn" title="返回(Esc)" style="width: 24px; height: 24px; cursor: pointer; border: 1px solid transparent; margin: 0px 0px 20px; position: absolute; right: 20px; padding: 4px; -webkit-transition: opacity 0.18s; border-top-left-radius: 50%; border-top-right-radius: 50%; border-bottom-right-radius: 50%; border-bottom-left-radius: 50%; top: 0px; opacity: 0; color: rgb(51, 51, 51); font-family: 楷体_GB2312, 仿宋_GB2312, 宋体; font-size: 18px; font-weight: bold; line-height: 27px; background-image: url(&quot;&quot;); background-color: rgb(162, 167, 73); background-position: 50% 50%; background-repeat: no-repeat no-repeat;"></div><div class="jz-actionbtn jz-editbtn" id="jz-editbtn" title="编辑" style="width: 24px; height: 24px; cursor: pointer; border: 1px solid transparent; margin: 0px 0px 20px; position: absolute; right: 20px; padding: 4px; -webkit-transition: opacity 0.18s; border-top-left-radius: 50%; border-top-right-radius: 50%; border-bottom-right-radius: 50%; border-bottom-left-radius: 50%; top: 60px; opacity: 0; color: rgb(51, 51, 51); font-family: 楷体_GB2312, 仿宋_GB2312, 宋体; font-size: 18px; font-weight: bold; line-height: 27px; background-image: url(&quot;&quot;); background-color: rgb(162, 167, 73); background-position: 50% 50%; background-repeat: no-repeat no-repeat;"></div><div class="jz-actionbtn jz-printbtn" id="jz-printbtn" title="打印" style="width: 24px; height: 24px; cursor: pointer; border: 1px solid transparent; margin: 0px 0px 20px; position: absolute; right: 20px; padding: 4px; -webkit-transition: opacity 0.18s; border-top-left-radius: 50%; border-top-right-radius: 50%; border-bottom-right-radius: 50%; border-bottom-left-radius: 50%; top: 120px; opacity: 0; color: rgb(51, 51, 51); font-family: 楷体_GB2312, 仿宋_GB2312, 宋体; font-size: 18px; font-weight: bold; line-height: 27px; background-image: url(&quot;&quot;); background-color: rgb(162, 167, 73); background-position: 50% 50%; background-repeat: no-repeat no-repeat;"></div></section>



</body></html>