<meta http-equiv="Content-Type" content="text/html; charset=utf-8"><title>读文件操作 导出Excel</title><?xml version="1.0" encoding="UTF-8"?>


<div style="word-wrap: break-word; -webkit-nbsp-mode: space; -webkit-line-break: after-white-space;">
1，读文件操作：<font face="YaHei Consolas Hybrid" size="1"><span style="font-size:9pt">openFileDialog1.Filter =</span></font> <font color="#A31515" face="YaHei Consolas Hybrid" size="1"><span style="font-size:9pt">&quot;Excel files |*.xls;*.xlsx&quot;</span></font><font face="YaHei Consolas Hybrid" size="1"><span style="font-size:9pt">;</span></font><div align="left"><font face="YaHei Consolas Hybrid" size="1"><span style="font-size:9pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></font> <font color="#0000FF" face="YaHei Consolas Hybrid" size="1"><span style="font-size:9pt">if</span></font> <font face="YaHei Consolas Hybrid" size="1"><span style="font-size:9pt">(openFileDialog1.ShowDialog() ==</span></font> <font color="#2B91AF" face="YaHei Consolas Hybrid" size="1"><span style="font-size:9pt">DialogResult</span></font><font face="YaHei Consolas Hybrid" size="1"><span style="font-size:9pt">.OK)</span></font></div><div align="left"><font face="YaHei Consolas Hybrid" size="1"><span style="font-size:9pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</span></font></div><div align="left"><font face="YaHei Consolas Hybrid" size="1"><span style="font-size:9pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; edt_TxtPath.Text = openFileDialog1.FileName;</span></font></div><div align="left"><font face="YaHei Consolas Hybrid" size="1"><span style="font-size:9pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></font></div><div align="left"><font face="YaHei Consolas Hybrid" size="1"><span style="font-size:9pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></font> <font color="#0000FF" face="YaHei Consolas Hybrid" size="1"><span style="font-size:9pt">if</span></font> <font face="YaHei Consolas Hybrid" size="1"><span style="font-size:9pt">(edt_TxtPath.Text !=</span></font> <font color="#A31515" face="YaHei Consolas Hybrid" size="1"><span style="font-size:9pt">&quot;&quot;</span></font> <font face="YaHei Consolas Hybrid" size="1"><span style="font-size:9pt">)</span></font></div><div align="left"><font face="YaHei Consolas Hybrid" size="1"><span style="font-size:9pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</span></font></div><div align="left"><font face="YaHei Consolas Hybrid" size="1"><span style="font-size:9pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></font> <font color="#008000" face="YaHei Consolas Hybrid" size="1"><span style="font-size:9pt">//this.bt_ponit.Enabled = true;</span></font></div><div align="left"><font face="YaHei Consolas Hybrid" size="1"><span style="font-size:9pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></font></div><div align="left"><font face="YaHei Consolas Hybrid" size="1"><span style="font-size:9pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></font> <font color="#0000FF" face="YaHei Consolas Hybrid" size="1"><span style="font-size:9pt">else</span></font></div><div align="left"><font face="YaHei Consolas Hybrid" size="1"><span style="font-size:9pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</span></font></div><div align="left"><font face="YaHei Consolas Hybrid" size="1"><span style="font-size:9pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ErrorMSG(</span></font> <font color="#A31515" face="YaHei Consolas Hybrid" size="1"><span style="font-size:9pt">&quot;Excel path can not null! &quot;</span></font> <font face="YaHei Consolas Hybrid" size="1"><span style="font-size:9pt">);</span></font></div><div align="left"><font face="YaHei Consolas Hybrid" size="1"><span style="font-size:9pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></font></div><div align="left"><font face="YaHei Consolas Hybrid" size="1"><span style="font-size:9pt">2，导出到Excel操作：</span></font></div><div align="left"><div align="left"><font color="#0000FF" face="YaHei Consolas Hybrid" size="1"><span style="font-size:9pt">public</span></font> <font color="#0000FF" face="YaHei Consolas Hybrid" size="1"><span style="font-size:9pt">void</span></font> <font face="YaHei Consolas Hybrid" size="1"><span style="font-size:9pt">SaveToExcle(</span></font><font color="#2B91AF" face="YaHei Consolas Hybrid" size="1"><span style="font-size:9pt">DataTable</span></font> <font face="YaHei Consolas Hybrid" size="1"><span style="font-size:9pt">dt,</span></font> <font color="#2B91AF" face="YaHei Consolas Hybrid" size="1"><span style="font-size:9pt">List</span></font><font face="YaHei Consolas Hybrid" size="1"><span style="font-size:9pt">&lt;</span></font><font color="#0000FF" face="YaHei Consolas Hybrid" size="1"><span style="font-size:9pt">object</span></font> <font face="YaHei Consolas Hybrid" size="1"><span style="font-size:9pt">&gt; LT)</span></font></div><div align="left"><font face="YaHei Consolas Hybrid" size="1"><span style="font-size:9pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</span></font></div><div align="left"><font face="YaHei Consolas Hybrid" size="1"><span style="font-size:9pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></font> <font color="#2B91AF" face="YaHei Consolas Hybrid" size="1"><span style="font-size:9pt">SaveFileDialog</span></font> <font face="YaHei Consolas Hybrid" size="1"><span style="font-size:9pt">sf =</span></font> <font color="#0000FF" face="YaHei Consolas Hybrid" size="1"><span style="font-size:9pt">new</span></font> <font color="#2B91AF" face="YaHei Consolas Hybrid" size="1"><span style="font-size:9pt">SaveFileDialog</span></font><font face="YaHei Consolas Hybrid" size="1"><span style="font-size:9pt">();</span></font></div><div align="left"><font face="YaHei Consolas Hybrid" size="1"><span style="font-size:9pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; sf.FileName =</span></font> <font color="#2B91AF" face="YaHei Consolas Hybrid" size="1"><span style="font-size:9pt">DateTime</span></font><font face="YaHei Consolas Hybrid" size="1"><span style="font-size:9pt">.Now.ToString(</span></font><font color="#A31515" face="YaHei Consolas Hybrid" size="1"><span style="font-size:9pt">&quot;yyyyMMddHHmmss&quot;</span></font> <font face="YaHei Consolas Hybrid" size="1"><span style="font-size:9pt">) +</span></font> <font color="#A31515" face="YaHei Consolas Hybrid" size="1"><span style="font-size:9pt">&quot;.xls&quot;</span></font><font face="YaHei Consolas Hybrid" size="1"><span style="font-size:9pt">;</span></font></div><div align="left"><font face="YaHei Consolas Hybrid" size="1"><span style="font-size:9pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; sf.Title =</span></font> <font color="#A31515" face="YaHei Consolas Hybrid" size="1"><span style="font-size:9pt">&quot;Select a path to save the file&quot;</span></font> <font face="YaHei Consolas Hybrid" size="1"><span style="font-size:9pt">;</span></font></div><div align="left"><font face="YaHei Consolas Hybrid" size="1"><span style="font-size:9pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></font> <font color="#0000FF" face="YaHei Consolas Hybrid" size="1"><span style="font-size:9pt">if</span></font> <font face="YaHei Consolas Hybrid" size="1"><span style="font-size:9pt">(sf.ShowDialog() ==</span></font> <font color="#2B91AF" face="YaHei Consolas Hybrid" size="1"><span style="font-size:9pt">DialogResult</span></font> <font face="YaHei Consolas Hybrid" size="1"><span style="font-size:9pt">.OK)</span></font></div><div align="left"><font face="YaHei Consolas Hybrid" size="1"><span style="font-size:9pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</span></font></div><div align="left"><font face="YaHei Consolas Hybrid" size="1"><span style="font-size:9pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></font> <font color="#0000FF" face="YaHei Consolas Hybrid" size="1"><span style="font-size:9pt">try</span></font></div><div align="left"><font face="YaHei Consolas Hybrid" size="1"><span style="font-size:9pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</span></font></div><div align="left"><font face="YaHei Consolas Hybrid" size="1"><span style="font-size:9pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></font> <font color="#0000FF" face="YaHei Consolas Hybrid" size="1"><span style="font-size:9pt">string</span></font> <font face="YaHei Consolas Hybrid" size="1"><span style="font-size:9pt">filename = sf.FileName;</span></font></div><div align="left"><font face="YaHei Consolas Hybrid" size="1"><span style="font-size:9pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></font> <font color="#0000FF" face="YaHei Consolas Hybrid" size="1"><span style="font-size:9pt">string</span></font> <font face="YaHei Consolas Hybrid" size="1"><span style="font-size:9pt">title =</span></font> <font color="#A31515" face="YaHei Consolas Hybrid" size="1"><span style="font-size:9pt">&quot;Print Date:&quot;</span></font> <font face="YaHei Consolas Hybrid" size="1"><span style="font-size:9pt">+</span></font> <font color="#2B91AF" face="YaHei Consolas Hybrid" size="1"><span style="font-size:9pt">DateTime</span></font><font face="YaHei Consolas Hybrid" size="1"><span style="font-size:9pt">.Now.ToString();</span></font></div><div align="left"><font face="YaHei Consolas Hybrid" size="1"><span style="font-size:9pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></font> <font color="#0000FF" face="YaHei Consolas Hybrid" size="1"><span style="font-size:9pt">this</span></font><font face="YaHei Consolas Hybrid" size="1"><span style="font-size:9pt">.operate.ToExcelFunction(dt, filename, LT);</span></font></div><div align="left"><font face="YaHei Consolas Hybrid" size="1"><span style="font-size:9pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; SuccessMSG(</span></font> <font color="#A31515" face="YaHei Consolas Hybrid" size="1"><span style="font-size:9pt">&quot;File save success!&quot;</span></font> <font face="YaHei Consolas Hybrid" size="1"><span style="font-size:9pt">);</span></font></div><div align="left"><font face="YaHei Consolas Hybrid" size="1"><span style="font-size:9pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></font></div><div align="left"><font face="YaHei Consolas Hybrid" size="1"><span style="font-size:9pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></font> <font color="#0000FF" face="YaHei Consolas Hybrid" size="1"><span style="font-size:9pt">catch</span></font> <font face="YaHei Consolas Hybrid" size="1"><span style="font-size:9pt">(</span></font><font color="#2B91AF" face="YaHei Consolas Hybrid" size="1"><span style="font-size:9pt">Exception</span></font> <font face="YaHei Consolas Hybrid" size="1"><span style="font-size:9pt">ex)</span></font></div><div align="left"><font face="YaHei Consolas Hybrid" size="1"><span style="font-size:9pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</span></font></div><div align="left"><font face="YaHei Consolas Hybrid" size="1"><span style="font-size:9pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ErrorMSG(</span></font> <font color="#A31515" face="YaHei Consolas Hybrid" size="1"><span style="font-size:9pt">&quot;To Excel Error:&quot;</span></font> <font face="YaHei Consolas Hybrid" size="1"><span style="font-size:9pt">+ ex.Message);</span></font></div><div align="left"><font face="YaHei Consolas Hybrid" size="1"><span style="font-size:9pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></font></div><div align="left"><font face="YaHei Consolas Hybrid" size="1"><span style="font-size:9pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></font></div><div align="left"><font face="YaHei Consolas Hybrid" size="1"><span style="font-size:9pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></font></div></div></div>