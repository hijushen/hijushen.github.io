<!DOCTYPE html>
<html><head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">

<!--defaultCSS-->
<title>异步APM练习 2015/11/18 beginInvoke</title>



<style type="text/css" id="wiz_custom_css">
body
{
    font-family: Microsoft YaHei UI,"Microsoft YaHei", Georgia,Helvetica,Arial,sans-serif,宋体, PMingLiU,serif;
    font-size: 10.5pt;
    line-height: 1.5;
}
html, body
{
    
    
}
h1 {
    font-size:1.5em;
    font-weight:bold;
}
h2 {
    font-size:1.4em;
    font-weight:bold;
}
h3 {
    font-size:1.3em;
    font-weight:bold;
}
h4 {
    font-size:1.2em;
    font-weight:bold;
}
h5 {
    font-size:1.1em;
    font-weight:bold;
}
h6 {
    font-size:1.0em;
    font-weight:bold;
}
img {
    border:0;
    max-width: 100%;
    height: auto !important;
}
blockquote {
    margin-top:0px;
    margin-bottom:0px;
}
table {
    border-collapse:collapse;
    border:1px solid #bbbbbb;
}
td {
    border-collapse:collapse;
    border:1px solid #bbbbbb;
}
</style>

<style type="text/css" id="wiz_todo_style_id" wiz_link_version="01.00.09">.wiz-todo, .wiz-todo-img {width: 16px; height: 16px; cursor: default; padding: 0 10px 0 2px; vertical-align: -10%;-webkit-user-select: none;} .wiz-todo-label { display: inline-block; padding-top: 7px; padding-bottom: 6px; line-height: 1.5;} .wiz-todo-label-checked {  color: #666;} .wiz-todo-label-unchecked {text-decoration: initial;} .wiz-todo-completed-info {padding-left: 44px; display: inline-block; } .wiz-todo-avatar { width:20px; height: 20px; vertical-align: -20%; margin-right:10px; border-radius: 2px;} .wiz-todo-account, .wiz-todo-dt { color: #666; }</style><link type="text/css" rel="stylesheet" id="wiz_code_highlight_link" href="异步APM练习 2015-11-18 beginInvoke_files/wiz_code_highlight_14.css"></head>

<body  style=""><div><pre class="prettyprint linenums prettyprinted"><ol class="linenums" style="padding-left: 0px;"><li style="list-style-type: none; padding-left: 0px;" class="L0"><code class="language-cs"><span class="pln">        </span><span class="kwd">static</span><span class="pln"> </span><span class="kwd">void</span><span class="pln"> </span><span class="typ">Main</span><span class="pun">(</span><span class="kwd">string</span><span class="pun">[]</span><span class="pln"> args</span><span class="pun">)</span></code></li><li style="list-style-type: none; padding-left: 0px;" class="L1"><code class="language-cs"><span class="pln">        </span><span class="pun">{</span></code></li><li style="list-style-type: none; padding-left: 0px;" class="L2"><code class="language-cs"><span class="pln">            </span><span class="typ">int</span><span class="pln"> threadId </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span></code></li><li style="list-style-type: none; padding-left: 0px;" class="L3"><code class="language-cs"><span class="pln">            </span><span class="typ">RunOnThreadPool</span><span class="pln"> poolDelegate </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Test</span><span class="pun">;</span></code></li><li style="list-style-type: none; padding-left: 0px;" class="L4"><code class="language-cs"></code></li><li style="list-style-type: none; padding-left: 0px;" class="L5"><code class="language-cs"><span class="pln">            </span><span class="kwd">var</span><span class="pln"> t </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">Thread</span><span class="pun">(()</span><span class="pln"> </span><span class="pun">=&gt;</span><span class="pln"> </span><span class="typ">Test</span><span class="pun">(</span><span class="kwd">out</span><span class="pln"> threadId</span><span class="pun">));</span></code></li><li style="list-style-type: none; padding-left: 0px;" class="L6"><code class="language-cs"><span class="pln">            t</span><span class="pun">.</span><span class="typ">Start</span><span class="pun">();</span></code></li><li style="list-style-type: none; padding-left: 0px;" class="L7"><code class="language-cs"><span class="pln">            t</span><span class="pun">.</span><span class="typ">Join</span><span class="pun">();</span></code></li><li style="list-style-type: none; padding-left: 0px;" class="L8"><code class="language-cs"></code></li><li style="list-style-type: none; padding-left: 0px;" class="L9"><code class="language-cs"><span class="pln">            </span><span class="typ">Console</span><span class="pun">.</span><span class="typ">WriteLine</span><span class="pun">(</span><span class="str">"Thread id: {0}"</span><span class="pun">,</span><span class="pln">threadId</span><span class="pun">);</span></code></li><li style="list-style-type: none; padding-left: 0px;" class="L0"><code class="language-cs"><span class="pln">            </span><span class="typ">Console</span><span class="pun">.</span><span class="typ">WriteLine</span><span class="pun">(</span><span class="str">"Current Thread id:{0}"</span><span class="pun">,</span><span class="typ">Thread</span><span class="pun">.</span><span class="typ">CurrentThread</span><span class="pun">.</span><span class="typ">ManagedThreadId</span><span class="pun">);</span></code></li><li style="list-style-type: none; padding-left: 0px;" class="L1"><code class="language-cs"></code></li><li style="list-style-type: none; padding-left: 0px;" class="L2"><code class="language-cs"><span class="pln">            </span><span class="typ">IAsyncResult</span><span class="pln"> r </span><span class="pun">=</span><span class="pln"> poolDelegate</span><span class="pun">.</span><span class="typ">BeginInvoke</span><span class="pun">(</span><span class="kwd">out</span><span class="pln"> threadId</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">AsyncCallback</span><span class="pun">(</span><span class="typ">Callback</span><span class="pun">),</span><span class="pln"> </span><span class="str">"a delegate asynchronous call"</span><span class="pun">);</span></code></li><li style="list-style-type: none; padding-left: 0px;" class="L3"><code class="language-cs"><span class="pln">            </span><span class="com">//r.AsyncWaitHandle.WaitOne();</span></code></li><li style="list-style-type: none; padding-left: 0px;" class="L4"><code class="language-cs"></code></li><li style="list-style-type: none; padding-left: 0px;" class="L5"><code class="language-cs"><span class="pln">            </span><span class="kwd">string</span><span class="pln"> result </span><span class="pun">=</span><span class="pln"> poolDelegate</span><span class="pun">.</span><span class="typ">EndInvoke</span><span class="pun">(</span><span class="kwd">out</span><span class="pln"> threadId</span><span class="pun">,</span><span class="pln"> r</span><span class="pun">);</span></code></li><li style="list-style-type: none; padding-left: 0px;" class="L6"><code class="language-cs"></code></li><li style="list-style-type: none; padding-left: 0px;" class="L7"><code class="language-cs"><span class="pln">            </span><span class="typ">Console</span><span class="pun">.</span><span class="typ">WriteLine</span><span class="pun">(</span><span class="str">"Thread pool worker thread Id: {0}"</span><span class="pun">,</span><span class="pln">threadId</span><span class="pun">);</span></code></li><li style="list-style-type: none; padding-left: 0px;" class="L8"><code class="language-cs"><span class="pln">            </span><span class="typ">Console</span><span class="pun">.</span><span class="typ">WriteLine</span><span class="pun">(</span><span class="pln">result</span><span class="pun">);</span></code></li><li style="list-style-type: none; padding-left: 0px;" class="L9"><code class="language-cs"></code></li><li style="list-style-type: none; padding-left: 0px;" class="L0"><code class="language-cs"><span class="pln">            </span><span class="typ">Thread</span><span class="pun">.</span><span class="typ">Sleep</span><span class="pun">(</span><span class="typ">TimeSpan</span><span class="pun">.</span><span class="typ">FromSeconds</span><span class="pun">(</span><span class="lit">2</span><span class="pun">));</span></code></li><li style="list-style-type: none; padding-left: 0px;" class="L1"><code class="language-cs"></code></li><li style="list-style-type: none; padding-left: 0px;" class="L2"><code class="language-cs"><span class="pln">            </span><span class="typ">Console</span><span class="pun">.</span><span class="typ">Read</span><span class="pun">();</span></code></li><li style="list-style-type: none; padding-left: 0px;" class="L3"><code class="language-cs"><span class="pln">        </span><span class="pun">}</span></code></li><li style="list-style-type: none; padding-left: 0px;" class="L4"><code class="language-cs"></code></li><li style="list-style-type: none; padding-left: 0px;" class="L5"><code class="language-cs"><span class="pln">        </span><span class="kwd">private</span><span class="pln"> </span><span class="kwd">delegate</span><span class="pln"> </span><span class="kwd">string</span><span class="pln"> </span><span class="typ">RunOnThreadPool</span><span class="pun">(</span><span class="kwd">out</span><span class="pln"> </span><span class="typ">int</span><span class="pln"> threadId</span><span class="pun">);</span></code></li><li style="list-style-type: none; padding-left: 0px;" class="L6"><code class="language-cs"><span class="pln">        </span><span class="kwd">private</span><span class="pln"> </span><span class="kwd">static</span><span class="pln"> </span><span class="kwd">string</span><span class="pln"> </span><span class="typ">Test</span><span class="pun">(</span><span class="kwd">out</span><span class="pln"> </span><span class="typ">int</span><span class="pln"> threadId</span><span class="pun">)</span></code></li><li style="list-style-type: none; padding-left: 0px;" class="L7"><code class="language-cs"><span class="pln">        </span><span class="pun">{</span></code></li><li style="list-style-type: none; padding-left: 0px;" class="L8"><code class="language-cs"><span class="pln">            </span><span class="typ">Console</span><span class="pun">.</span><span class="typ">WriteLine</span><span class="pun">(</span><span class="str">"Starting ..."</span><span class="pun">);</span></code></li><li style="list-style-type: none; padding-left: 0px;" class="L9"><code class="language-cs"><span class="pln">            </span><span class="typ">Console</span><span class="pun">.</span><span class="typ">WriteLine</span><span class="pun">(</span><span class="str">"Is thread pool thread: {0}"</span><span class="pun">,</span><span class="typ">Thread</span><span class="pun">.</span><span class="typ">CurrentThread</span><span class="pun">.</span><span class="typ">IsThreadPoolThread</span><span class="pun">);</span></code></li><li style="list-style-type: none; padding-left: 0px;" class="L0"><code class="language-cs"><span class="pln">            </span><span class="typ">Thread</span><span class="pun">.</span><span class="typ">Sleep</span><span class="pun">(</span><span class="typ">TimeSpan</span><span class="pun">.</span><span class="typ">FromSeconds</span><span class="pun">(</span><span class="lit">2</span><span class="pun">));</span></code></li><li style="list-style-type: none; padding-left: 0px;" class="L1"><code class="language-cs"><span class="pln">            threadId </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Thread</span><span class="pun">.</span><span class="typ">CurrentThread</span><span class="pun">.</span><span class="typ">ManagedThreadId</span><span class="pun">;</span></code></li><li style="list-style-type: none; padding-left: 0px;" class="L2"><code class="language-cs"><span class="pln">            </span><span class="kwd">return</span><span class="pln"> </span><span class="kwd">string</span><span class="pun">.</span><span class="typ">Format</span><span class="pun">(</span><span class="str">"Thread pool worker thread is was: {0}"</span><span class="pun">,</span><span class="pln"> threadId</span><span class="pun">);</span></code></li><li style="list-style-type: none; padding-left: 0px;" class="L3"><code class="language-cs"><span class="pln">        </span><span class="pun">}</span></code></li><li style="list-style-type: none; padding-left: 0px;" class="L4"><code class="language-cs"></code></li><li style="list-style-type: none; padding-left: 0px;" class="L5"><code class="language-cs"><span class="pln">        </span><span class="kwd">private</span><span class="pln"> </span><span class="kwd">static</span><span class="pln"> </span><span class="kwd">void</span><span class="pln"> </span><span class="typ">Callback</span><span class="pun">(</span><span class="typ">IAsyncResult</span><span class="pln"> ar</span><span class="pun">)</span></code></li><li style="list-style-type: none; padding-left: 0px;" class="L6"><code class="language-cs"><span class="pln">        </span><span class="pun">{</span></code></li><li style="list-style-type: none; padding-left: 0px;" class="L7"><code class="language-cs"><span class="pln">            </span><span class="typ">Console</span><span class="pun">.</span><span class="typ">WriteLine</span><span class="pun">(</span><span class="str">"Starting a callback ..."</span><span class="pun">);</span></code></li><li style="list-style-type: none; padding-left: 0px;" class="L8"><code class="language-cs"><span class="pln">            </span><span class="typ">Console</span><span class="pun">.</span><span class="typ">WriteLine</span><span class="pun">(</span><span class="str">"State passed to a callback: {0}"</span><span class="pun">,(</span><span class="kwd">string</span><span class="pun">)</span><span class="pln">ar</span><span class="pun">.</span><span class="typ">AsyncState</span><span class="pun">);</span></code></li><li style="list-style-type: none; padding-left: 0px;" class="L9"><code class="language-cs"><span class="pln">            </span><span class="typ">Console</span><span class="pun">.</span><span class="typ">WriteLine</span><span class="pun">(</span><span class="str">"Is thread pool thread: {0}"</span><span class="pun">,</span><span class="typ">Thread</span><span class="pun">.</span><span class="typ">CurrentThread</span><span class="pun">.</span><span class="typ">IsThreadPoolThread</span><span class="pun">);</span></code></li><li style="list-style-type: none; padding-left: 0px;" class="L0"><code class="language-cs"><span class="pln">            </span><span class="typ">Console</span><span class="pun">.</span><span class="typ">WriteLine</span><span class="pun">(</span><span class="str">"Thread pool worker thread id: {0}"</span><span class="pun">,</span><span class="typ">Thread</span><span class="pun">.</span><span class="typ">CurrentThread</span><span class="pun">.</span><span class="typ">ManagedThreadId</span><span class="pun">);</span></code></li><li style="list-style-type: none; padding-left: 0px;" class="L1"><code class="language-cs"></code></li><li style="list-style-type: none; padding-left: 0px;" class="L2"><code class="language-cs"><span class="pln">            </span><span class="typ">Console</span><span class="pun">.</span><span class="typ">Read</span><span class="pun">();</span></code></li><li style="list-style-type: none; padding-left: 0px;" class="L3"><code class="language-cs"><span class="pln">        </span><span class="pun">}</span></code></li></ol></pre></div><div>联系二， 计算方式：</div><div><div><pre class="prettyprint linenums prettyprinted"><ol class="linenums" style="padding-left: 0px;"><li style="list-style-type: none; padding-left: 0px;" class="L0"><code class="language-cs"><span class="pln">    </span><span class="kwd">class</span><span class="pln"> </span><span class="typ">Program</span></code></li><li style="list-style-type: none; padding-left: 0px;" class="L1"><code class="language-cs"><span class="pln">    </span><span class="pun">{</span></code></li><li style="list-style-type: none; padding-left: 0px;" class="L2"><code class="language-cs"><span class="pln">        </span><span class="kwd">public</span><span class="pln"> </span><span class="kwd">delegate</span><span class="pln"> </span><span class="typ">Int64</span><span class="pln"> </span><span class="typ">CalculateFolderSizeDelegate</span><span class="pun">(</span><span class="kwd">string</span><span class="pln"> folderName</span><span class="pun">);</span></code></li><li style="list-style-type: none; padding-left: 0px;" class="L3"><code class="language-cs"><span class="pln">        </span><span class="kwd">static</span><span class="pln"> </span><span class="kwd">void</span><span class="pln"> </span><span class="typ">Main</span><span class="pun">(</span><span class="kwd">string</span><span class="pun">[]</span><span class="pln"> args</span><span class="pun">)</span></code></li><li style="list-style-type: none; padding-left: 0px;" class="L4"><code class="language-cs"><span class="pln">        </span><span class="pun">{</span></code></li><li style="list-style-type: none; padding-left: 0px;" class="L5"><code class="language-cs"><span class="pln">            </span><span class="typ">CalculateFolderSizeDelegate</span><span class="pln"> calFSDele </span><span class="pun">=</span><span class="pln"> </span><span class="typ">CalculateFolderSize</span><span class="pun">;</span></code></li><li style="list-style-type: none; padding-left: 0px;" class="L6"><code class="language-cs"></code></li><li style="list-style-type: none; padding-left: 0px;" class="L7"><code class="language-cs"><span class="pln">            </span><span class="com">//IAsyncResult ia = calFSDele.BeginInvoke(string.Format(@"E:\中鼎\yi\美的项目\code\new"), null, null);</span></code></li><li style="list-style-type: none; padding-left: 0px;" class="L8"><code class="language-cs"><span class="pln">            calFSDele</span><span class="pun">.</span><span class="typ">BeginInvoke</span><span class="pun">(</span><span class="kwd">string</span><span class="pun">.</span><span class="typ">Format</span><span class="pun">(</span><span class="str">@"E:\中鼎\yi\美的项目\code\new"</span><span class="pun">),</span><span class="typ">CalAsyncCallback</span><span class="pun">,</span><span class="pln">calFSDele</span><span class="pun">);</span></code></li><li style="list-style-type: none; padding-left: 0px;" class="L9"><code class="language-cs"><span class="pln">            </span><span class="typ">Console</span><span class="pun">.</span><span class="typ">WriteLine</span><span class="pun">(</span><span class="str">"Starting ...."</span><span class="pun">);</span></code></li><li style="list-style-type: none; padding-left: 0px;" class="L0"><code class="language-cs"><span class="pln">            </span><span class="com">//while (!ia.IsCompleted) { Console.WriteLine("."); }</span></code></li><li style="list-style-type: none; padding-left: 0px;" class="L1"><code class="language-cs"></code></li><li style="list-style-type: none; padding-left: 0px;" class="L2"><code class="language-cs"><span class="pln">            </span><span class="com">//while (!ia.AsyncWaitHandle.WaitOne(10))</span></code></li><li style="list-style-type: none; padding-left: 0px;" class="L3"><code class="language-cs"><span class="pln">            </span><span class="com">//{</span></code></li><li style="list-style-type: none; padding-left: 0px;" class="L4"><code class="language-cs"><span class="pln">            </span><span class="com">//    Console.WriteLine("..");</span></code></li><li style="list-style-type: none; padding-left: 0px;" class="L5"><code class="language-cs"><span class="pln">            </span><span class="com">//}</span></code></li><li style="list-style-type: none; padding-left: 0px;" class="L6"><code class="language-cs"><span class="pln">            </span><span class="com">//Int64 result = calFSDele.EndInvoke(ia);</span></code></li><li style="list-style-type: none; padding-left: 0px;" class="L7"><code class="language-cs"><span class="pln">            </span><span class="com">//Console.WriteLine("OK");</span></code></li><li style="list-style-type: none; padding-left: 0px;" class="L8"><code class="language-cs"><span class="pln">            </span><span class="com">//Console.WriteLine("Result: {0}",result);</span></code></li><li style="list-style-type: none; padding-left: 0px;" class="L9"><code class="language-cs"></code></li><li style="list-style-type: none; padding-left: 0px;" class="L0"><code class="language-cs"></code></li><li style="list-style-type: none; padding-left: 0px;" class="L1"><code class="language-cs"><span class="pln">            </span><span class="typ">Console</span><span class="pun">.</span><span class="typ">ReadKey</span><span class="pun">();</span></code></li><li style="list-style-type: none; padding-left: 0px;" class="L2"><code class="language-cs"><span class="pln">        </span><span class="pun">}</span></code></li><li style="list-style-type: none; padding-left: 0px;" class="L3"><code class="language-cs"></code></li><li style="list-style-type: none; padding-left: 0px;" class="L4"><code class="language-cs"><span class="pln">        </span><span class="kwd">private</span><span class="pln"> </span><span class="kwd">static</span><span class="pln"> </span><span class="kwd">void</span><span class="pln"> </span><span class="typ">CalAsyncCallback</span><span class="pun">(</span><span class="typ">IAsyncResult</span><span class="pln"> ia</span><span class="pun">)</span></code></li><li style="list-style-type: none; padding-left: 0px;" class="L5"><code class="language-cs"><span class="pln">        </span><span class="pun">{</span></code></li><li style="list-style-type: none; padding-left: 0px;" class="L6"><code class="language-cs"><span class="pln">            </span><span class="kwd">while</span><span class="pln"> </span><span class="pun">(!</span><span class="pln">ia</span><span class="pun">.</span><span class="typ">AsyncWaitHandle</span><span class="pun">.</span><span class="typ">WaitOne</span><span class="pun">(</span><span class="lit">10</span><span class="pun">))</span></code></li><li style="list-style-type: none; padding-left: 0px;" class="L7"><code class="language-cs"><span class="pln">            </span><span class="pun">{</span></code></li><li style="list-style-type: none; padding-left: 0px;" class="L8"><code class="language-cs"><span class="pln">                </span><span class="typ">Console</span><span class="pun">.</span><span class="typ">WriteLine</span><span class="pun">(</span><span class="str">".."</span><span class="pun">);</span></code></li><li style="list-style-type: none; padding-left: 0px;" class="L9"><code class="language-cs"><span class="pln">            </span><span class="pun">}</span></code></li><li style="list-style-type: none; padding-left: 0px;" class="L0"><code class="language-cs"><span class="pln">            </span><span class="kwd">var</span><span class="pln"> temp </span><span class="pun">=</span><span class="pln"> ia</span><span class="pun">.</span><span class="typ">AsyncState</span><span class="pln"> </span><span class="kwd">as</span><span class="pln"> </span><span class="typ">CalculateFolderSizeDelegate</span><span class="pun">;</span></code></li><li style="list-style-type: none; padding-left: 0px;" class="L1"><code class="language-cs"><span class="pln">            </span><span class="typ">Int64</span><span class="pln"> result </span><span class="pun">=</span><span class="pln"> temp</span><span class="pun">.</span><span class="typ">EndInvoke</span><span class="pun">(</span><span class="pln">ia</span><span class="pun">);</span></code></li><li style="list-style-type: none; padding-left: 0px;" class="L2"><code class="language-cs"><span class="pln">            </span><span class="typ">Console</span><span class="pun">.</span><span class="typ">WriteLine</span><span class="pun">(</span><span class="str">"OK"</span><span class="pun">);</span></code></li><li style="list-style-type: none; padding-left: 0px;" class="L3"><code class="language-cs"><span class="pln">            </span><span class="typ">Console</span><span class="pun">.</span><span class="typ">WriteLine</span><span class="pun">(</span><span class="str">"Result: {0}"</span><span class="pun">,</span><span class="pln"> result</span><span class="pun">);</span></code></li><li style="list-style-type: none; padding-left: 0px;" class="L4"><code class="language-cs"><span class="pln">        </span><span class="pun">}</span></code></li><li style="list-style-type: none; padding-left: 0px;" class="L5"><code class="language-cs"></code></li><li style="list-style-type: none; padding-left: 0px;" class="L6"><code class="language-cs"><span class="pln">        </span><span class="kwd">private</span><span class="pln"> </span><span class="kwd">static</span><span class="pln"> </span><span class="typ">Int64</span><span class="pln"> </span><span class="typ">CalculateFolderSize</span><span class="pun">(</span><span class="kwd">string</span><span class="pln"> folderName</span><span class="pun">)</span></code></li><li style="list-style-type: none; padding-left: 0px;" class="L7"><code class="language-cs"><span class="pln">        </span><span class="pun">{</span></code></li><li style="list-style-type: none; padding-left: 0px;" class="L8"><code class="language-cs"><span class="pln">            </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="typ">Directory</span><span class="pun">.</span><span class="typ">Exists</span><span class="pun">(</span><span class="pln">folderName</span><span class="pun">)</span><span class="pln"> </span><span class="pun">==</span><span class="pln"> </span><span class="kwd">false</span><span class="pun">)</span></code></li><li style="list-style-type: none; padding-left: 0px;" class="L9"><code class="language-cs"><span class="pln">            </span><span class="pun">{</span></code></li><li style="list-style-type: none; padding-left: 0px;" class="L0"><code class="language-cs"><span class="pln">                </span><span class="kwd">throw</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">Exception</span><span class="pun">(</span><span class="str">"文件不存在"</span><span class="pun">);</span></code></li><li style="list-style-type: none; padding-left: 0px;" class="L1"><code class="language-cs"><span class="pln">            </span><span class="pun">}</span></code></li><li style="list-style-type: none; padding-left: 0px;" class="L2"><code class="language-cs"></code></li><li style="list-style-type: none; padding-left: 0px;" class="L3"><code class="language-cs"><span class="pln">            </span><span class="typ">DirectoryInfo</span><span class="pln"> rootDir </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">DirectoryInfo</span><span class="pun">(</span><span class="pln">folderName</span><span class="pun">);</span></code></li><li style="list-style-type: none; padding-left: 0px;" class="L4"><code class="language-cs"><span class="pln">            </span><span class="typ">DirectoryInfo</span><span class="pun">[]</span><span class="pln"> childDirs </span><span class="pun">=</span><span class="pln"> rootDir</span><span class="pun">.</span><span class="typ">GetDirectories</span><span class="pun">();</span></code></li><li style="list-style-type: none; padding-left: 0px;" class="L5"><code class="language-cs"><span class="pln">            </span><span class="typ">FileInfo</span><span class="pun">[]</span><span class="pln"> childFiles </span><span class="pun">=</span><span class="pln"> rootDir</span><span class="pun">.</span><span class="typ">GetFiles</span><span class="pun">();</span></code></li><li style="list-style-type: none; padding-left: 0px;" class="L6"><code class="language-cs"></code></li><li style="list-style-type: none; padding-left: 0px;" class="L7"><code class="language-cs"><span class="pln">            </span><span class="typ">Int64</span><span class="pln"> totalSize </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span></code></li><li style="list-style-type: none; padding-left: 0px;" class="L8"><code class="language-cs"><span class="pln">            </span><span class="kwd">foreach</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">var</span><span class="pln"> file </span><span class="kwd">in</span><span class="pln"> childFiles</span><span class="pun">)</span></code></li><li style="list-style-type: none; padding-left: 0px;" class="L9"><code class="language-cs"><span class="pln">            </span><span class="pun">{</span></code></li><li style="list-style-type: none; padding-left: 0px;" class="L0"><code class="language-cs"><span class="pln">                totalSize </span><span class="pun">+=</span><span class="pln"> file</span><span class="pun">.</span><span class="typ">Length</span><span class="pun">;</span></code></li><li style="list-style-type: none; padding-left: 0px;" class="L1"><code class="language-cs"><span class="pln">            </span><span class="pun">}</span></code></li><li style="list-style-type: none; padding-left: 0px;" class="L2"><code class="language-cs"></code></li><li style="list-style-type: none; padding-left: 0px;" class="L3"><code class="language-cs"><span class="pln">            </span><span class="kwd">foreach</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">var</span><span class="pln"> direc </span><span class="kwd">in</span><span class="pln"> childDirs</span><span class="pun">)</span></code></li><li style="list-style-type: none; padding-left: 0px;" class="L4"><code class="language-cs"><span class="pln">            </span><span class="pun">{</span></code></li><li style="list-style-type: none; padding-left: 0px;" class="L5"><code class="language-cs"><span class="pln">                totalSize </span><span class="pun">+=</span><span class="pln"> </span><span class="typ">CalculateFolderSize</span><span class="pun">(</span><span class="pln">direc</span><span class="pun">.</span><span class="typ">FullName</span><span class="pun">);</span></code></li><li style="list-style-type: none; padding-left: 0px;" class="L6"><code class="language-cs"><span class="pln">            </span><span class="pun">}</span></code></li><li style="list-style-type: none; padding-left: 0px;" class="L7"><code class="language-cs"><span class="pln">            </span><span class="kwd">return</span><span class="pln"> totalSize</span><span class="pun">;</span></code></li><li style="list-style-type: none; padding-left: 0px;" class="L8"><code class="language-cs"><span class="pln">        </span><span class="pun">}</span></code></li><li style="list-style-type: none; padding-left: 0px;" class="L9"><code class="language-cs"></code></li><li style="list-style-type: none; padding-left: 0px;" class="L0"><code class="language-cs"><span class="pln">    </span><span class="pun">}</span></code></li></ol></pre></div><div><br></div></div></body></html>