<meta http-equiv="Content-Type" content="text/html; charset=utf-8"><title>Timer控件 DateDiff TimeSpan</title><?xml version="1.0" encoding="UTF-8"?>


<div style="word-wrap: break-word; -webkit-nbsp-mode: space; -webkit-line-break: after-white-space;">
1，计算2个时间差：
<div>&nbsp; &nbsp; &nbsp;<font color="#0000FF" face="YaHei Consolas Hybrid" size="1"><span style="font-size:9pt; background:#c7edcc">private</span></font> <font color="#0000FF" face="YaHei Consolas Hybrid" size="1"><span style="font-size:9pt; background:#c7edcc">string</span></font> <font face="YaHei Consolas Hybrid" size="1"><span style="font-size:9pt; background:#c7edcc">DateDiff(DateTime DateTime1, DateTime DateTime2)</span></font> <font color="#008000" face="YaHei Consolas Hybrid" size="1"><span style="font-size:9pt; background:#c7edcc">//计算2个时间差</span></font></div><div align="left"><font face="YaHei Consolas Hybrid" size="1"><span style="font-size:9pt; background:#c7edcc">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</span></font></div><div align="left"><font face="YaHei Consolas Hybrid" size="1"><span style="font-size:9pt; background:#c7edcc">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></font> <font color="#0000FF" face="YaHei Consolas Hybrid" size="1"><span style="font-size:9pt; background:#c7edcc">string</span></font> <font face="YaHei Consolas Hybrid" size="1"><span style="font-size:9pt; background:#c7edcc">dateDiff =</span></font> <font color="#0000FF" face="YaHei Consolas Hybrid" size="1"><span style="font-size:9pt; background:#c7edcc">null</span></font><font face="YaHei Consolas Hybrid" size="1"><span style="font-size:9pt; background:#c7edcc">;</span></font></div><div align="left"><font face="YaHei Consolas Hybrid" size="1"><span style="font-size:9pt; background:#c7edcc">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; TimeSpan ts1 =</span></font> <font color="#0000FF" face="YaHei Consolas Hybrid" size="1"><span style="font-size:9pt; background:#c7edcc">new</span></font> <font face="YaHei Consolas Hybrid" size="1"><span style="font-size:9pt; background:#c7edcc">TimeSpan(DateTime1.Ticks);</span></font></div><div align="left"><font face="YaHei Consolas Hybrid" size="1"><span style="font-size:9pt; background:#c7edcc">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; TimeSpan ts2 =</span></font> <font color="#0000FF" face="YaHei Consolas Hybrid" size="1"><span style="font-size:9pt; background:#c7edcc">new</span></font> <font face="YaHei Consolas Hybrid" size="1"><span style="font-size:9pt; background:#c7edcc">TimeSpan(DateTime2.Ticks);</span></font></div><div align="left"><font face="YaHei Consolas Hybrid" size="1"><span style="font-size:9pt; background:#c7edcc">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; TimeSpan ts = ts1.Subtract(ts2).Duration();</span></font></div><div align="left"><font face="YaHei Consolas Hybrid" size="1"><span style="font-size:9pt; background:#c7edcc">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; dateDiff = ts.Days.ToString() +</span></font> <font color="#A31515" face="YaHei Consolas Hybrid" size="1"><span style="font-size:9pt; background:#c7edcc">&quot;天&quot;</span></font> <font face="YaHei Consolas Hybrid" size="1"><span style="font-size:9pt; background:#c7edcc">+ ts.Hours.ToString() +</span></font> <font color="#A31515" face="YaHei Consolas Hybrid" size="1"><span style="font-size:9pt; background:#c7edcc">&quot;小时&quot;</span></font> <font face="YaHei Consolas Hybrid" size="1"><span style="font-size:9pt; background:#c7edcc">+ ts.Minutes.ToString() +</span></font> <font color="#A31515" face="YaHei Consolas Hybrid" size="1"><span style="font-size:9pt; background:#c7edcc">&quot;分钟&quot;</span></font> <font face="YaHei Consolas Hybrid" size="1"><span style="font-size:9pt; background:#c7edcc">+ ts.Seconds.ToString() +</span></font> <font color="#A31515" face="YaHei Consolas Hybrid" size="1"><span style="font-size:9pt; background:#c7edcc">&quot;秒&quot;</span></font> <font face="YaHei Consolas Hybrid" size="1"><span style="font-size:9pt; background:#c7edcc">;</span></font></div><div align="left"><font face="YaHei Consolas Hybrid" size="1"><span style="font-size:9pt; background:#c7edcc">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></font> <font color="#0000FF" face="YaHei Consolas Hybrid" size="1"><span style="font-size:9pt; background:#c7edcc">return</span></font> <font face="YaHei Consolas Hybrid" size="1"><span style="font-size:9pt; background:#c7edcc">dateDiff;</span></font></div><div align="left"><font face="YaHei Consolas Hybrid" size="1"><span style="font-size:9pt; background:#c7edcc">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></font></div><div align="left"><font face="YaHei Consolas Hybrid" size="1"><span style="font-size:9pt; background:#c7edcc">2，用于显示时间：在构造中填写</span></font></div><div align="left">&nbsp; &nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#0000FF" face="YaHei Consolas Hybrid" size="1"><span style="font-size:9pt; background:#c7edcc">this</span></font> <font face="YaHei Consolas Hybrid" size="1"><span style="font-size:9pt; background:#c7edcc">.timer1.Interval = 1000;//1秒运行一次</span></font></div><div align="left"><font face="YaHei Consolas Hybrid" size="1"><span style="font-size:9pt; background:#c7edcc">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></font> <font color="#0000FF" face="YaHei Consolas Hybrid" size="1"><span style="font-size:9pt; background:#c7edcc">this</span></font><font face="YaHei Consolas Hybrid" size="1"><span style="font-size:9pt; background:#c7edcc">.timer1.Tick +=</span></font> <font color="#0000FF" face="YaHei Consolas Hybrid" size="1"><span style="font-size:9pt; background:#c7edcc">new</span></font> <font face="YaHei Consolas Hybrid" size="1"><span style="font-size:9pt; background:#c7edcc">System.</span></font> <font color="#2B91AF" face="YaHei Consolas Hybrid" size="1"><span style="font-size:9pt; background:#c7edcc">EventHandler</span></font> <font face="YaHei Consolas Hybrid" size="1"><span style="font-size:9pt; background:#c7edcc">(</span></font><font color="#0000FF" face="YaHei Consolas Hybrid" size="1"><span style="font-size:9pt; background:#c7edcc">this</span></font><font face="YaHei Consolas Hybrid" size="1"><span style="font-size:9pt; background:#c7edcc">.timer1_Tick);</span></font></div><div align="left"><font face="YaHei Consolas Hybrid" size="1"><span style="font-size:9pt; background:#c7edcc">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></font> <font color="#0000FF" face="YaHei Consolas Hybrid" size="1"><span style="font-size:9pt; background:#c7edcc">this</span></font><font face="YaHei Consolas Hybrid" size="1"><span style="font-size:9pt; background:#c7edcc">.timer1.Start();</span></font></div><div align="left"><font face="YaHei Consolas Hybrid" size="1"><span style="font-size:9pt; background:#c7edcc"><br/></span></font></div><div align="left">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;<font color="#0000FF" face="YaHei Consolas Hybrid" size="1"><span style="font-size:9pt; background:#c7edcc">private</span></font> <font color="#0000FF" face="YaHei Consolas Hybrid" size="1"><span style="font-size:9pt; background:#c7edcc">void</span></font> <font face="YaHei Consolas Hybrid" size="1"><span style="font-size:9pt; background:#c7edcc">timer1_Tick(</span></font> <font color="#0000FF" face="YaHei Consolas Hybrid" size="1"><span style="font-size:9pt; background:#c7edcc">object</span></font> <font face="YaHei Consolas Hybrid" size="1"><span style="font-size:9pt; background:#c7edcc">sender,</span></font><font color="#2B91AF" face="YaHei Consolas Hybrid" size="1"><span style="font-size:9pt; background:#c7edcc">EventArgs</span></font> <font face="YaHei Consolas Hybrid" size="1"><span style="font-size:9pt; background:#c7edcc">e)</span></font> <font color="#008000" face="YaHei Consolas Hybrid" size="1"><span style="font-size:9pt; background:#c7edcc">//系统当前时间</span></font></div><div align="left"><font face="YaHei Consolas Hybrid" size="1"><span style="font-size:9pt; background:#c7edcc">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</span></font></div><div align="left"><font face="YaHei Consolas Hybrid" size="1"><span style="font-size:9pt; background:#c7edcc">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></font> <font color="#0000FF" face="YaHei Consolas Hybrid" size="1"><span style="font-size:9pt; background:#c7edcc">this</span></font><font face="YaHei Consolas Hybrid" size="1"><span style="font-size:9pt; background:#c7edcc">.labeltimenow.Text =</span></font> <font color="#A31515" face="YaHei Consolas Hybrid" size="1"><span style="font-size:9pt; background:#c7edcc">&quot;系统当前时间：&quot;</span></font> <font face="YaHei Consolas Hybrid" size="1"><span style="font-size:9pt; background:#c7edcc">+DateTime.Now.ToString();</span></font></div><div align="left"><font face="YaHei Consolas Hybrid" size="1"><span style="font-size:9pt; background:#c7edcc">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></font> <font color="#0000FF" face="YaHei Consolas Hybrid" size="1"><span style="font-size:9pt; background:#c7edcc">string</span></font> <font face="YaHei Consolas Hybrid" size="1"><span style="font-size:9pt; background:#c7edcc">subTime = DateDiff(DateTime.Now,LongTime);</span></font></div><div align="left"><font face="YaHei Consolas Hybrid" size="1"><span style="font-size:9pt; background:#c7edcc">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></font> <font color="#0000FF" face="YaHei Consolas Hybrid" size="1"><span style="font-size:9pt; background:#c7edcc">this</span></font><font face="YaHei Consolas Hybrid" size="1"><span style="font-size:9pt; background:#c7edcc">.lbMaxTime.Text =</span></font> <font color="#A31515" face="YaHei Consolas Hybrid" size="1"><span style="font-size:9pt; background:#c7edcc">&quot;箱中最长时间：&quot;</span></font> <font face="YaHei Consolas Hybrid" size="1"><span style="font-size:9pt; background:#c7edcc">+ subTime;</span></font></div><div align="left"><font face="YaHei Consolas Hybrid" size="1"><span style="font-size:9pt; background:#c7edcc">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></font></div></div>