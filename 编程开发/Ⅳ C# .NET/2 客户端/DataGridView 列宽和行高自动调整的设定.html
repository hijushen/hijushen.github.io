<meta http-equiv="Content-Type" content="text/html; charset=utf-8"><title>DataGridView 列宽和行高自动调整的设定</title><?xml version="1.0" encoding="UTF-8"?>


<div style="word-wrap: break-word; -webkit-nbsp-mode: space; -webkit-line-break: after-white-space;"><h1 style="font-size: 14.7px; margin-bottom: 10px; color: rgb(75, 75, 75); font-family: Verdana, Geneva, Arial, Helvetica, sans-serif;"><a href="http://www.cnblogs.com/pinyan/archive/2011/10/26/2225284.html" style="text-decoration: none; color: rgb(26, 139, 200);">DataGridView 列宽和行高自动调整的设定</a></h1><div style="word-break: normal !important; color: rgb(75, 75, 75); font-family: Verdana, Geneva, Arial, Helvetica, sans-serif; font-size: 13px; line-height: 19px;"><p style="margin: 10px auto;">1) 设定行高和列宽自动调整</p><div align="left"><span style="color: rgb(0, 128, 0); background-color: rgb(192, 192, 192);">// 设定包括Header和所有单元格的列宽自动调整</span></div><div align="left"><span style="color: rgb(0, 0, 0); background-color: rgb(192, 192, 192);">DataGridView1.AutoSizeColumnsMode = DataGridViewAutoSizeColumnsMode.AllCells;</span><br/><span style="color: rgb(0, 128, 0); background-color: rgb(192, 192, 192);">// 设定包括Header和所有单元格的行高自动调整</span></div><div align="left"><span style="color: rgb(0, 0, 0); background-color: rgb(192, 192, 192);">DataGridView1.AutoSizeRowsMode = DataGridViewAutoSizeRowsMode.AllCells;</span></div><div align="left">AutoSizeColumnsMode 属性的设定值枚举请参照 msdn 的 DataGridViewAutoSizeRowsMode 说明。</div><div align="left">2）指定列或行自动调整</div><div align="left"><span style="color: rgb(0, 128, 0); background-color: rgb(192, 192, 192);">// 第一列自动调整</span></div><div align="left"><span style="background-color: rgb(192, 192, 192);">DataGridView1.Columns[0].AutoSizeMode =&nbsp; DataGridViewAutoSizeColumnMode.DisplayedCells;</span></div><div align="left">AutoSizeMode 设定为 NotSet&nbsp; 时， 默认继承的是&nbsp; DataGridView.AutoSizeColumnsMode 属性。</div><div align="left">3) 设定列头的高度和行头的宽度自动调整</div><div align="left"><span style="color: rgb(0, 128, 0); background-color: rgb(192, 192, 192);">&nbsp;// 设定列头的宽度可以自由调整</span></div><div align="left"><span style="background-color: rgb(192, 192, 192);">&nbsp;DataGridView1.ColumnHeadersHeightSizeMode =&nbsp;&nbsp; DataGridViewColumnHeadersHeightSizeMode.AutoSize;</span><br/><span style="color: rgb(0, 128, 0); background-color: rgb(192, 192, 192);">// 设定行头的宽度可以自由调整</span></div><div align="left"><span style="background-color: rgb(192, 192, 192);">DataGridView1.RowHeadersWidthSizeMode =&nbsp; DataGridViewRowHeadersWidthSizeMode.AutoSizeToAllHeaders;</span></div><div align="left">&nbsp;</div><div align="left">4） 随时自动调整</div><div align="left">&nbsp;a， 临时的，让列宽自动调整，这和指定AutoSizeColumnsMode属性一样。</div><div align="left"><span style="color: rgb(0, 128, 0); background-color: rgb(192, 192, 192);">// 让 DataGridView1 的所有列宽自动调整一下。</span></div><div align="left"><span style="background-color: rgb(192, 192, 192);">DataGridView1.AutoResizeColumns(DataGridViewAutoSizeColumnsMode.AllCells);</span><br/><span style="color: rgb(0, 128, 0); background-color: rgb(192, 192, 192);">// 让 DataGridView1 的第一列的列宽自动调整一下。</span></div><div align="left"><span style="background-color: rgb(192, 192, 192);">DataGridView1.AutoResizeColumn(0, DataGridViewAutoSizeColumnMode.AllCells);</span></div><div align="left">上面调用的 AutoResizeColumns 和 AutoResizeColumn 当指定的是DataGridViewAutoSizeColumnMode.AllCells 的时候， 参数可以省略。即： DataGridView1.AutoResizeColumn(0) 和 DataGridView1.AutoResizeColumns()</div><div align="left">b，临时的，让行高自动调整</div><div align="left"><span style="color: rgb(0, 128, 0); background-color: rgb(192, 192, 192);">// 让 DataGridView1 的所有行高自动调整一下。</span></div><div align="left"><span style="background-color: rgb(192, 192, 192);">&nbsp;DataGridView1.AutoResizeRows(DataGridViewAutoSizeRowsMode.AllCells);</span><br/><span style="color: rgb(0, 128, 0); background-color: rgb(192, 192, 192);">//让 DataGridView1 的第一行的行高自动调整一下。</span></div><div align="left"><span style="background-color: rgb(192, 192, 192);">DataGridView1.AutoResizeRow(0, DataGridViewAutoSizeRowMode.AllCells);</span></div><div align="left">上面调用的 AutoResizeRows 和 AutoResizeRow 当指定的是DataGridViewAutoSizeRowMode.AllCells 的时候， 参数可以省略。即：DataGridView1.AutoResizeRow (0) 和 DataGridView1.AutoResizeRows()</div><div align="left"><br/>
c，临时的，让行头和列头自动调整</div><div align="left"><span style="color: rgb(0, 128, 0); background-color: rgb(192, 192, 192);">&nbsp;// 列头高度自动调整</span></div><div align="left"><span style="background-color: rgb(192, 192, 192);">DataGridView1.AutoResizeColumnHeadersHeight();</span><br/><span style="color: rgb(0, 128, 0); background-color: rgb(192, 192, 192);">// 行头宽度自动调整</span></div><div align="left"><span style="background-color: rgb(192, 192, 192);">DataGridView1.AutoResizeRowHeadersWidth(DataGridViewRowHeadersWidthSizeMode.AutoSizeToAllHeaders);</span></div><div align="left"><b>关于性能：</b><b>&nbsp;</b>通过 AutoSizeColumnsMode 或者 AutoSizeRowsMode 属性所指定的单元格进行自动调整时，如果调整次数过于多那么将可能导致性能下降，尤其是在行和列数比较多的情况下。在这时用 DisplayedCells 代替 AllCells 能减少非所见的单元格的调整，从而提高性能。</div></div></div>