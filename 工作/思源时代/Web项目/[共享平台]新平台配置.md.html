<!DOCTYPE HTML><html><head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">

<title>[共享平台]新平台配置.md</title>
    <!--mark |wiz_custom_css| for wizeditor replace it-->


<style id="wiz_custom_css">        html, body {            font-size: 15px;        }        body {            font-family: Helvetica, 'Hiragino Sans GB', '微软雅黑', 'Microsoft YaHei UI', SimSun, SimHei, arial, sans-serif;            line-height: 1.6;            margin: 0;            padding: 20px 36px;            padding: 1.33rem 2.4rem;        }        h1, h2, h3, h4, h5, h6 {            margin: 20px 0 10px;            margin: 1.33rem 0 0.667rem;            padding: 0;            font-weight: bold;        }        h1 {            font-size: 21px;            font-size: 1.4rem;        }        h2 {            font-size: 20px;            font-size: 1.33rem;        }        h3 {            font-size: 18px;            font-size: 1.2rem;        }        h4 {            font-size: 17px;            font-size: 1.13rem;        }        h5 {            font-size: 15px;            font-size: 1rem;        }        h6 {            font-size: 15px;            font-size: 1rem;            color: #777777;            margin: 1rem 0;        }        div, p, ul, ol, dl, li {            margin: 0;        }        blockquote, table, pre, code {            margin: 8px 0;        }        ul, ol {            padding-left: 32px;            padding-left: 2.13rem;        }        blockquote {            padding: 0 12px;            padding: 0 0.8rem;        }        blockquote > :first-child {            margin-top: 0;        }        blockquote > :last-child {            margin-bottom: 0;        }        img {            border: 0;            max-width: 100%;            height: auto !important;            margin: 2px 0;        }        table {            border-collapse: collapse;            border: 1px solid #bbbbbb;        }        td {            padding: 4px 8px;            border-collapse: collapse;            border: 1px solid #bbbbbb;        }        @media screen and (max-width: 660px) {            body {                padding: 20px 18px;                padding: 1.33rem 1.2rem;            }        }        @media only screen and (-webkit-max-device-width: 1024px), only screen and (-o-max-device-width: 1024px), only screen and (max-device-width: 1024px), only screen and (-webkit-min-device-pixel-ratio: 3), only screen and (-o-min-device-pixel-ratio: 3), only screen and (min-device-pixel-ratio: 3) {            html, body {                font-size: 17px;            }            body {                line-height: 1.7;                padding: 0.75rem 0.9375rem;                color: #353c47;            }            h1 {                font-size: 2.125rem;            }            h2 {                font-size: 1.875rem;            }            h3 {                font-size: 1.625rem;            }            h4 {                font-size: 1.375rem;            }            h5 {                font-size: 1.125rem;            }            h6 {                color: inherit;            }            ul, ol {                padding-left: 2.5rem;            }            blockquote {                padding: 0 0.9375rem;            }        }</style><style type="text/css" id="wiz_todo_style_id" wiz_link_version="01.00.09">.wiz-todo, .wiz-todo-img {width: 16px; height: 16px; cursor: default; padding: 0 10px 0 2px; vertical-align: -10%;-webkit-user-select: none;} .wiz-todo-label { display: inline-block; padding-top: 7px; padding-bottom: 6px; line-height: 1.5;} .wiz-todo-label-checked {  color: #666;} .wiz-todo-label-unchecked {text-decoration: initial;} .wiz-todo-completed-info {padding-left: 44px; display: inline-block; } .wiz-todo-avatar { width:20px; height: 20px; vertical-align: -20%; margin-right:10px; border-radius: 2px;} .wiz-todo-account, .wiz-todo-dt { color: #666; }</style></head>

<body style="" ><p class="MsoNormal"><span lang="EN-US">[toc]</span></p><p class="MsoNormal"><span lang="EN-US"><br></span></p><p class="MsoNormal"><span lang="EN-US">## 1,</span>界面配置及配置生效原则<span lang="EN-US">. <o:p></o:p></span></p><p class="MsoNormal"><span lang="EN-US"><img width="553" height="58" src="[共享平台]新平台配置.md_files/clip_image002721cf784-0038-4dda-a75f-613dcaead2c1.jpg" v:shapes="图片_x0020_1"></span><span lang="EN-US"><o:p></o:p></span></p><p class="MsoNormal"><span lang="EN-US"><o:p>&nbsp;</o:p></span></p><p class="MsoNormal">每次关闭相应进程(退出IIS不一定会退出这个进程)<span lang="EN-US">, </span>刷新界面重新登录<span lang="EN-US">,
</span>会刷新界面<span lang="EN-US">.(原理, 界面菜单的构建在调试时对应进程里面生成)<o:p></o:p></span></p><p class="MsoNormal"><span lang="EN-US"><o:p>&nbsp;</o:p></span></p><p class="MsoNormal"><span lang="EN-US">## 2, </span>管理员功能保证</p><p class="MsoNormal"><span lang="EN-US">- &nbsp;</span>保证<span lang="EN-US">admin</span>菜单及相应功能<span lang="EN-US">,</span>后面各用户授权<span lang="EN-US">,</span>功能维护才能进行, 所以这是第一步.</p><p class="MsoNormal">### 解决问题</p><p class="MsoNormal">- 用<span lang="EN-US">admin</span>登录后如果没有任何左侧菜单<span lang="EN-US">:<o:p></o:p></span></p><p class="MsoNormal"><span style="font-size: 15px; line-height: 1.6;">&nbsp; &nbsp; - 解决方案1: 浏览器地址栏</span>输入后台**功能维护**对应地址去配置相应菜单功能(如下图1, 没有菜单怎么进入配置, 见图2)</p><p class="MsoNormal"><span style="font-size: 15px; line-height: 1.6;">&nbsp; &nbsp;</span><span style="font-size: 15px; line-height: 1.6;">&nbsp;- 解决方案2: 数据库表**批量**</span><span style="font-size: 15px; line-height: 1.6;">&nbsp;更新.查询[语句1](语句1), 更新[语句2](语句2)</span></p><p class="MsoNormal">- 原理说明: **<span lang="EN-US">&nbsp;“</span>默认功能为否<span lang="EN-US">, </span>系统功能为是<span lang="EN-US">”**, &nbsp;</span>则管理员则加载其菜单功能. (此部分不全, 后续补充 4 见最后&nbsp;2016-10-9)</p><p class="MsoNormal"><span lang="EN-US"><br></span></p><p class="MsoNormal"><span lang="EN-US"><img width="553" height="269" src="[共享平台]新平台配置.md_files/clip_image004573e1881-8c0f-419d-a11f-d3293edcb851.jpg" v:shapes="图片_x0020_2" name="">&nbsp;(这是管理员功能应该的设置配置)</span></p><p class="MsoNormal"><span lang="EN-US"><o:p>&nbsp;</o:p></span></p><p class="MsoNormal"><span lang="EN-US"><img width="554" height="219" src="[共享平台]新平台配置.md_files/clip_image0065f17fbce-f4f8-4589-a65a-3bdf4ac5f050.jpg" v:shapes="图片_x0020_3">(这是根据界面地址, 直接去配置)</span></p><p class="MsoNormal"><span lang="EN-US"><o:p>&nbsp;</o:p></span></p><p class="MsoNormal">### 后台批量更新语句</p><p class="MsoNormal"><span lang="EN-US"><br></span></p><p class="MsoNormal"><span lang="EN-US">[语句1](语句1)</span></p><p class="MsoNormal"><span lang="EN-US">`SELECT TOP 100 *&nbsp; FROM A1Func A<o:p></o:p></span></p><p class="MsoNormal"><span lang="EN-US">WHERE A.FuncName IN ('</span>权限管理<span lang="EN-US">','</span>基础数据维护<span lang="EN-US">','</span>组织机构管理<span lang="EN-US">','</span>职责管理<span lang="EN-US">','</span>机构维护<span lang="EN-US">','</span>机构管理<span lang="EN-US">','</span>机构关系类型<span lang="EN-US">'<o:p></o:p></span></p><p class="MsoNormal"><span lang="EN-US">,'</span>机构关系<span lang="EN-US">','</span>机构重组<span lang="EN-US">','</span>用户管理<span lang="EN-US">','</span>职责业务授权<span lang="EN-US">','</span>基础数据维护<span lang="EN-US">','</span>业务类型管理<span lang="EN-US">','</span>字典管理<span lang="EN-US">','</span>功能维护<span lang="EN-US">','</span>首页通知维护<span lang="EN-US">') `<o:p></o:p></span></p><p class="MsoNormal"><span lang="EN-US"><o:p>&nbsp;</o:p></span></p><p class="MsoNormal">[语句2](语句2)</p><p class="MsoNormal"><span lang="EN-US">`UPDATEA1Func&nbsp; SET IsSysFunc =&nbsp; 1, IsAuthorize = 0<o:p></o:p></span></p><p class="MsoNormal"><span lang="EN-US">WHERE FuncName IN ('</span>权限管理<span lang="EN-US">','</span>基础数据维护<span lang="EN-US">','</span>组织机构管理<span lang="EN-US">','</span>职责管理<span lang="EN-US">','</span>机构维护<span lang="EN-US">','</span>机构管理<span lang="EN-US">','</span>机构关系类型<span lang="EN-US">'<o:p></o:p></span></p><p class="MsoNormal"><span lang="EN-US">,'</span>机构关系<span lang="EN-US">','</span>机构重组<span lang="EN-US">','</span>用户管理<span lang="EN-US">','</span>职责业务授权<span lang="EN-US">','</span>基础数据维护<span lang="EN-US">','</span>业务类型管理<span lang="EN-US">','</span>字典管理<span lang="EN-US">','</span>功能维护<span lang="EN-US">','</span>首页通知维护<span lang="EN-US">')`<o:p></o:p></span></p><p class="MsoNormal"><span lang="EN-US"><o:p>&nbsp;</o:p></span></p><p class="MsoNormal"><span lang="EN-US">## 3, 能看见菜单, 但是无法点开菜单. 即界面出发的url地址跳转原理.</span></p><p class="MsoNormal"><br></p><p class="MsoNormal">## 问题分析, 菜单对应的功能地址url配置丢失, 系统功能, 更新后台语句去更新, <span lang="EN-US">:<o:p></o:p></span></p><p class="MsoNormal">### 如果点击菜单无反应<span lang="EN-US">, </span>即连接丢失<span lang="EN-US">, </span>修复语句, 涉及表: ** `<span style="font-size: 15px; line-height: 1.6;">A1Func</span><span style="font-size: 15px; line-height: 1.6;">` &nbsp;&amp;&amp; `</span><span style="font-size: 15px; line-height: 1.6;">A1Page</span><span style="font-size: 15px; line-height: 1.6;">` **</span></p><p class="MsoNormal"><span lang="EN-US"><o:p>&nbsp;</o:p></span></p><p class="MsoNormal"><span lang="EN-US">`UPDATE A1Func SET Url =ISNULL((SELECT
pageurl from A1Page&nbsp; where
A1Func.PageID=A1Page.PageID),'') WHERE PageID&gt;1`</span></p><p class="MsoNormal"><span lang="EN-US"><o:p>&nbsp;</o:p></span></p><p class="MsoNormal"><span lang="EN-US">## 4,&nbsp;</span><span lang="EN-US"><o:p></o:p></span><span style="font-size: 15px; line-height: 1.6;">正常的功能页面加入到系统中, 需要的配置顺序</span></p><p class="MsoNormal">使用功能维护增加相应页面地址<span lang="EN-US">. </span>注意事项<span lang="EN-US">:<o:p></o:p></span></p><p class="MsoNormal">### &nbsp;第一步: 因为: 是否系统功能<span lang="EN-US">:</span>是<span lang="EN-US">, </span>是否默认功能<span lang="EN-US">: </span>否<span lang="EN-US">, </span>是给<span lang="EN-US">admin</span>用来加载功能的<span lang="EN-US">.<o:p></o:p></span></p><p class="MsoNormal">所以<span lang="EN-US">, </span>自定义的基本配置为<span lang="EN-US">: </span>都应该为否<span lang="EN-US">. (</span>有人说<span lang="EN-US">: </span>一直选中是否系统功能为是<span lang="EN-US">,
</span>则不需要授权则可以加载<span lang="EN-US">, </span>当然要生效需要注意<span lang="EN-US">1 </span>中的生效规则<span lang="EN-US">.)<o:p></o:p></span></p><p class="MsoNormal"><br></p><p class="MsoNormal"><span lang="EN-US"><img width="554" height="381" src="[共享平台]新平台配置.md_files/clip_image010c36ea743-bf77-4d89-ade4-ccc143f30f60.jpg" v:shapes="图片_x0020_6" name=""></span></p><p class="MsoNormal"><span lang="EN-US"><br></span></p><p class="MsoNormal"><span lang="EN-US">### 第二步<span lang="EN-US">:&nbsp;职责管理(职责业务授权):&nbsp;</span>功能菜单菜单授权分为业务权限和授权<span lang="EN-US">.&nbsp;&nbsp;</span></span></p><p class="MsoNormal"><span lang="EN-US"><span lang="EN-US">- 2个名字同一个意思, 有时候职责管理会配置相应测试地址, 历史原因, 不深究.</span></span></p><p class="MsoNormal"><span lang="EN-US">- 注意下半部分公共业务的范围较大<span lang="EN-US">. 加上后就不需要针对机构再加了, 没必要...</span><br></span></p><img width="554" height="244" src="[共享平台]新平台配置.md_files/clip_image008b0724226-732e-47ab-a134-68b31f93acc6.jpg" v:shapes="图片_x0020_5" name=""><p class="MsoNormal"><span lang="EN-US"><span lang="EN-US">- 上半部分分编辑和授权</span></span></p><p class="MsoNormal"><span lang="EN-US"><span lang="EN-US">&nbsp; &nbsp; - 编辑需要设定范围, 和**[人员管理]**中, 人员所在的范围要关联, 否则,人员授权时无法看见职责.&nbsp;</span></span></p><p class="MsoNormal"><span lang="EN-US"><span lang="EN-US"><img src="[共享平台]新平台配置.md_files/f35af77a-1f49-4533-b1b6-6866d482f962.png" border="0" alt="" name="">(编辑范围)<br></span></span></p><p class="MsoNormal"><span lang="EN-US"><span lang="EN-US"><img src="[共享平台]新平台配置.md_files/91da57c8-f76f-4410-b0e5-08c0645263a6.png" border="0" alt="" name="" width="1097" height="782">(职责加功能)<br></span></span></p><p class="MsoNormal"><span lang="EN-US"><span lang="EN-US"><br></span></span></p><p class="MsoNormal"><span lang="EN-US"><span lang="EN-US"><br></span></span></p><p class="MsoNormal"><span lang="EN-US"><span lang="EN-US">举例说明: 4011是公司下-系统管理**部门**下的人员, 这个地方职责形态为部门, 人员为部门,&nbsp;</span></span></p><p class="MsoNormal">[人员管理] 中左侧机构树选部门, 然后增加这个职责. 这样 功能 -- 职责 - 人员, 就匹配上, 人就可以看见相应的菜单功能了.</p><p class="MsoNormal"><br></p><p class="MsoNormal">### 第三步<span lang="EN-US">: </span>用户职责授权管理<span lang="EN-US">:<o:p></o:p></span></p><p class="MsoNormal">相应的用户赋权<span lang="EN-US">.<o:p></o:p></span></p><p class="MsoNormal">值得注意的地方就是职责对应的机构名称问题<span lang="EN-US">.&nbsp; </span>就是操作时左侧机构树选择人员对应所在公司<span lang="EN-US">,
</span>如果选择其他<span lang="EN-US">, </span>会导致一定问题<span lang="EN-US">.(</span>和成本系统里面是一样的<span lang="EN-US">). <o:p></o:p></span></p><p class="MsoNormal"><img src="[共享平台]新平台配置.md_files/bf43e1d5-11dd-4f32-8142-dc1356b6b359.png" border="0" alt="" name="" width="1003" height="551">(范围要选对)<br></p><p class="MsoNormal"><img src="[共享平台]新平台配置.md_files/cd586704-c6ad-4438-9c69-27baed678fb1.png" border="0" alt="" name="" width="988" height="516">(同举例,和职责范围对应)<br></p><p class="MsoNormal"><br></p><p class="MsoNormal">## 4, 职责无法看见的问题 更新于2016-10-9</p><p class="MsoNormal">- 问题描述: 命名按照2中设置了系统管理员可以看的菜单之后, 为何还是无法看见菜单.</p><p class="MsoNormal">- 原因: 数据库中存储的`A1Duty` 表问题.&nbsp;</p><p class="MsoNormal">- 解决办法: 第一步: 更新语句:</p><p class="MsoNormal"><img src="[共享平台]新平台配置.md_files/6224f945-2a85-4644-bd26-47d356b95277.png" border="0" alt="" name="" width="979" height="251"><br></p><p class="MsoNormal">第二步: 给管理员增加菜单权限:</p><p class="MsoNormal"><img src="[共享平台]新平台配置.md_files/c39ff18e-334b-42c2-bcf5-7079eb4163a0.png" border="0" alt="" name="" width="900" height="667"><br></p><p class="MsoNormal"><span lang="EN-US"><br></span></p><p class="MsoNormal"><span lang="EN-US"><o:p>&nbsp;</o:p></span></p></body></html>