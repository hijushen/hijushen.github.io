<!DOCTYPE HTML><html><head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">

<title>[5.成本2.0]流程设计器使用总结 2016-09-25.md</title>
<style id="wiz_custom_css">        html, body {            font-size: 15px;        }        body {            font-family: Helvetica, 'Hiragino Sans GB', '微软雅黑', 'Microsoft YaHei UI', SimSun, SimHei, arial, sans-serif;            line-height: 1.6;            margin: 0;            padding: 20px 36px;            padding: 1.33rem 2.4rem;        }        h1, h2, h3, h4, h5, h6 {            margin: 20px 0 10px;            margin: 1.33rem 0 0.667rem;            padding: 0;            font-weight: bold;        }        h1 {            font-size: 21px;            font-size: 1.4rem;        }        h2 {            font-size: 20px;            font-size: 1.33rem;        }        h3 {            font-size: 18px;            font-size: 1.2rem;        }        h4 {            font-size: 17px;            font-size: 1.13rem;        }        h5 {            font-size: 15px;            font-size: 1rem;        }        h6 {            font-size: 15px;            font-size: 1rem;            color: #777777;            margin: 1rem 0;        }        div, p, ul, ol, dl, li {            margin: 0;        }        blockquote, table, pre, code {            margin: 8px 0;        }        ul, ol {            padding-left: 32px;            padding-left: 2.13rem;        }        blockquote {            padding: 0 12px;            padding: 0 0.8rem;        }        blockquote > :first-child {            margin-top: 0;        }        blockquote > :last-child {            margin-bottom: 0;        }        img {            border: 0;            max-width: 100%;            height: auto !important;            margin: 2px 0;        }        table {            border-collapse: collapse;            border: 1px solid #bbbbbb;        }        td {            padding: 4px 8px;            border-collapse: collapse;            border: 1px solid #bbbbbb;        }        @media screen and (max-width: 660px) {            body {                padding: 20px 18px;                padding: 1.33rem 1.2rem;            }        }        @media only screen and (-webkit-max-device-width: 1024px), only screen and (-o-max-device-width: 1024px), only screen and (max-device-width: 1024px), only screen and (-webkit-min-device-pixel-ratio: 3), only screen and (-o-min-device-pixel-ratio: 3), only screen and (min-device-pixel-ratio: 3) {            html, body {                font-size: 17px;            }            body {                line-height: 1.7;                padding: 0.75rem 0.9375rem;                color: #353c47;            }            h1 {                font-size: 2.125rem;            }            h2 {                font-size: 1.875rem;            }            h3 {                font-size: 1.625rem;            }            h4 {                font-size: 1.375rem;            }            h5 {                font-size: 1.125rem;            }            h6 {                color: inherit;            }            ul, ol {                padding-left: 2.5rem;            }            blockquote {                padding: 0 0.9375rem;            }        }</style><style type="text/css" id="wiz_todo_style_id" wiz_link_version="01.00.09">.wiz-todo, .wiz-todo-img {width: 16px; height: 16px; cursor: default; padding: 0 10px 0 2px; vertical-align: -10%;-webkit-user-select: none;} .wiz-todo-label { display: inline-block; padding-top: 7px; padding-bottom: 6px; line-height: 1.5;} .wiz-todo-label-checked {  color: #666;} .wiz-todo-label-unchecked {text-decoration: initial;} .wiz-todo-completed-info {padding-left: 44px; display: inline-block; } .wiz-todo-avatar { width:20px; height: 20px; vertical-align: -20%; margin-right:10px; border-radius: 2px;} .wiz-todo-account, .wiz-todo-dt { color: #666; }</style></head>
<body  style=""><!--WizHtmlContentBegin--><div>[toc]</div><div>&nbsp;</div><div>&gt; 概述:</div><div>&gt; 九江配合共享接口测试, 需要配合相应流程表单的测试, 预期使用相应的流程回退即可. 但是碰到从 五公司 切换到 市政部门. 首先是对流程的修改, 缩短所有合同的审批流程, 不然审死了. 哼哧哼哧的, 前前后后审批了三遍, 有木有, 会不会觉得太苦逼.... 影响心情.....</div><div>&gt; 流程主要是删, **当然** 也要总结关于**机构职责**,/**人员管理**里面**赋权限**配合使用.&lt;/br&gt;</div><div>&gt; **2016-9-25** 编写 By Coco</div><div>&nbsp;</div><div>#Ⅰ.流程设计器</div><div>## 1. 总结可能的生效原理</div><div>- `下级管理员流程` `&gt;&gt;` `上级管理员`</div><div>&nbsp;&nbsp;&nbsp; - 使用不同的账户登录会产生不同的效果, 具体是下面的部门可以看见上级机构管理员发布的,但是自己发布的时候会产生以自己部门前缀(一般比上级部门长)的新流程. 打开后关闭名称才变, 当时不变.</div><div>&nbsp;</div><div>- `高版本` `&gt;&gt;` `低版本`</div><div>&nbsp;&nbsp;&nbsp; - 动节点需要复制, 然后升级版本号再发布.</div><div>&nbsp;</div><div>## 2. 修改及拖动</div><div>- 尝试结束节点不变动是可以的, 第一个节点到第二个节点, 使用`switch`完成一进一出的选择条件, 具体看是否复杂, 节点都是`一进一出` 这很关键.</div><div>&nbsp;</div><div>#Ⅱ.人员管理</div><div>- 人员管理里面定位机构, 搜索到当前机构下及子机构下所有用户.</div><div>- 公司下项目部也是作为深度遍历, 但是譬如定位项目部 `工经部` 赋权限 和定位到公司 `XXX四局XXX公司` 附 `职责` 效果是不同的,;</div><div>&nbsp;&nbsp;&nbsp; - 简单举例: 碰到`汉水工经部`门下的人员**发起流程**,其下一个节点为`本部门财务负责人`. 定位`财务部` 和定位`汉水公司`再选赋`职责`会造成不同后果: --**前者通过, 后者不行**.</div><div>- **生效规则**: 一定要**刷新** ... 界面,调整完流程后, 一定要刷新已登录的用户界面, 不然还是旧流程. (具体的生效规则, 待看代码).</div><div>&nbsp;</div><div># Ⅲ.数据库查询</div><div>- 通过发起事件查询相应的`流程ID`.</div><div>- 根据`流程ID`-&gt;`模板ID及对应模板信息(版本号等)`-&gt;`创建人`-&gt;`登录查看流程`</div><div>- 代码部分:</div><div>&nbsp;</div><div>```</div><div>&nbsp;</div><div>USE [CostDB1041]</div><div>--1. 通过流程ID查看相应末班</div><div>SELECT TOP 100 * FROM A1WFInstance A</div><div>WHERE A.WFInstanceID = '36ed770e-3fa9-451d-9aa8-4b8b741354b4'</div><div>&nbsp;</div><div>--2. 通过模板查看相应</div><div>SELECT * FROM A1WFTemplate B</div><div>WHERE B.WFTemplateID = '4061771e-3324-4de1-b430-1e0f795e54fb';</div><div>&nbsp;</div><div>--3. 如上2语句综合 根据流程ID 查看对应 模板信息</div><div>SELECT&nbsp; TOP 100 B.*,A.* FROM A1WFInstance A, A1WFTemplate B</div><div>WHERE A.WFTemplateID = B.WFTemplateID</div><div>AND&nbsp; A.WFInstanceID = '31401e56-819a-4f75-8c0f-a308752d26b7'</div><div>&nbsp;</div><div>-- 4. 根据上面模板查询出相应的创建人员工号 和机构, 找到所谓管理员.</div><div>-- 然后用该账户登录, 完成相应的流程修改.</div><div>SELECT * FROM A1User D</div><div>WHERE D.UserID = '7ce029eb-6868-4162-852b-72884da0b38c'</div><div>&nbsp;</div><div>-- 5. 查询机构</div><div>SELECT TOP 100 *&nbsp; FROM A1Org C</div><div>WHERE C.OrgID = '71b2c31e-20d2-43ab-afdb-329944dea911'</div><div>&nbsp;</div><div>```</div><!--WizHtmlContentEnd--></body></html>